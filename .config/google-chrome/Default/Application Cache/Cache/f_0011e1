mN.prototype.Efa=u(1221,function(a){I(this,2,a)});mN.prototype.QI=u(1220,function(){return H(this,2)});Fp.prototype.rba=u(1081,function(){return Pe(this,3)});LF.prototype.rba=u(1080,function(){return Pe(this,5)});Fp.prototype.R9=u(1079,function(){return H(this,3)});LF.prototype.R9=u(1078,function(){return H(this,5)});Fp.prototype.vba=u(1077,function(){return Pe(this,2)});LF.prototype.vba=u(1076,function(){return Pe(this,4)});Fp.prototype.k$=u(1075,function(){return H(this,2)});
LF.prototype.k$=u(1074,function(){return H(this,4)});function pFf(a,b){dh(a,11,b)}function qFf(a,b,c){return"r"==c?a.s0(b):a.ON(b)}function rFf(a,b){return(a=GX(a,b))?a.rect:null}function sFf(a,b){a.D=b}var tFf=/['()]/g;function uFf(a){return"%"+a.charCodeAt(0).toString(16)}function vFf(a){a=Xd(String(a));tFf.lastIndex=0;return tFf.test(a)?a.replace(tFf,uFf):a}function wFf(a,b){this.D=a;this.C=b}function xFf(a){return a.Bn()+ee(a.C)}
function yFf(a){var b=a.title;return U('<div class="docs-native-editing-warning-title-text docs-material-gm-dialog-title-text" id="'+V(a.id)+'">'+S(b)+"</div>")}function J4(a,b,c,d){AS.call(this,void 0,a,d,!0);this.$a=c;this.ma=Aoa("warning-header-text");this.F=null;if(b.L){b=C(B(),"docs-idu");c=C(B(),"docs-sdsnfl");d=Bc(B(),"docs-sddfu");var e=Bc(B(),"docs-sdttfu");(this.F=!b&&!c||td(d)||td(e)?null:new E2d("warning-dialogs",!1,a,b?d:e))&&this.Ia(this.F)}Rx(this,!1);this.Pz(!1);this.$i=!0}x(J4,AS);
p=J4.prototype;p.Gz=n("alertdialog");p.Ca=function(){AS.prototype.Ca.call(this);Gw(Jx(this),yFf,{title:this.$a,id:this.ma});this.JWa();var a=this.Na();this.F&&this.F.render(a);var b=this.N9();this.O.setContent(b);this.O.If(this.N9());if(b=this.C?this.C.Ah():void 0){if(!this.C)throw Error("Attempted to set cancel button content when the cancel button doesnt exist");this.C.setContent(b);this.C.If(b)}dv(a,this.HRa())};p.Ja=function(){AS.prototype.Ja.call(this);Uu(this.Na(),"labelledby",this.ma)};
p.Ag=n(!1);p.N9=function(){return this.O.Ah()};function zFf(a){var b=a.Eh,c=a.qj,d=U;a=a.z4b;a=U('<div class="docs-unsupportedofficefeatureswarning-content-restorefiletext" id="'+V(c.oAa)+'">'+S(a)+"</div>");c='<div class="docs-unsupportedofficefeatureswarning-content-features-list" id="'+V(c.Mza)+'">';for(var e=b.length,f=0;f<e;f++)c+=U('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+S({feature:Tw(""+b[f])}.feature)+"</div>");b=U(c+"</div>");return d(a+b)}
function AFf(a){a=a.Rs;a='<a class="'+V("docs-unsupportedofficefeatureswarning-learn-more")+'" target="_blank" rel="noreferrer" href="'+V(Xw(a))+'">';return U(a+"Learn more</a>")}var BFf={Mza:"features-list",oAa:"restore-file-text"};function K4(a,b,c,d,e){J4.call(this,d,a,c,e);this.Va=b;this.J=Cd(BFf,function(f){return Aoa(f)});this.V=Bc(B(),"docs-deuoflmu")}x(K4,J4);K4.prototype.Ja=function(){J4.prototype.Ja.call(this);Uu(this.Na(),"describedby",[this.J.oAa,this.J.Mza])};
K4.prototype.JWa=function(){Gw(this.Ob(),zFf,{Eh:this.Va,qj:this.J,z4b:this.L()});if(this.V){var a=Iw(AFf,{Rs:this.V});Lx(this).prepend(a)}};K4.prototype.HRa=n("docs-unsupportedofficefeatureswarning");function CFf(a,b,c,d,e,f){for(var h=new MH,k=ia(b),l=k.next();!l.done;l=k.next())h.add(Z1d(l.value));K4.call(this,a,h.Pd(),c,d);this.R=!1;this.Ua=e;this.Ka=f;this.Aa=b}x(CFf,K4);CFf.prototype.N9=n("Continue editing");CFf.prototype.L=n("The original file can be restored from version history");
CFf.prototype.Ja=function(){var a=this;K4.prototype.Ja.call(this);this.getHandler().listen(this,"ld",function(){a.R=!0;a.Ua.Kb(Q4c(a.Aa));return!0})};CFf.prototype.um=function(){K4.prototype.um.call(this);this.R||this.Ka.Kb(Q4c(this.Aa))};function DFf(a,b,c){bz.call(this,void 0,void 0,c);this.$i=!0;this.setTitle("Alt Text");Zx(this,"ok");b=b||"";a='<div class="alt-text-dialog-content"><div class="alt-text-dialog-intro">Alt text is accessed by screen readers for people who might have trouble seeing your content.</div><table cellspacing="0" cellpadding="0" role="presentation"><tr class="alt-text-dialog-title-container"><td><label for="alt-text-dialog-title">Title'+('</label></td><td><input id="alt-text-dialog-title" class="jfk-textinput" type="text" maxlength="5000" value="'+
V(a||"")+'"></td></tr><tr class="alt-text-dialog-description-container"><td><label for="alt-text-dialog-description">');a=a+"Description"+('</label></td><td><textarea id="alt-text-dialog-description" class="jfk-textinput" maxlength="5000">'+a4a(b)+"</textarea></td></tr></table></div>");a=U(a);Ix(this,Dw(a));this.re(Hu(this,"alt-text"))}A(DFf,bz);DFf.prototype.F=function(){return EFf(this,"alt-text-dialog-title")};DFf.prototype.C=function(){return EFf(this,"alt-text-dialog-description")};
function EFf(a,b){return(a=a.qa().getElement(b))&&null!=a.value?a.value:null};function FFf(a){var b=a.Ddc;return U('<div class="docs-binaryupsavewarning-content-text" id="'+V(a.id)+'">'+S(b)+"</div>")};function GFf(a,b,c,d,e,f){J4.call(this,b,a,e);this.L=!1;this.V=c;this.R=d;this.Aa=f;this.J=Aoa("warning-explanation")}x(GFf,J4);p=GFf.prototype;p.HRa=n("docs-binaryupsavewarning");p.JWa=function(){Gw(this.Ob(),FFf,{id:this.J,Ddc:this.Aa})};p.Ja=function(){var a=this;J4.prototype.Ja.call(this);this.getHandler().listen(this,"ld",function(){a.L=!0;a.V.Kb();return!0});Uu(this.Na(),"describedby",this.J)};p.N9=n("Continue");p.um=function(){J4.prototype.um.call(this);this.L||this.R.Kb()};function HFf(a){a=a.link;return U('<input type="text" class="'+V("docs-copy-link")+'" value="'+V(a)+'" readonly="readonly">')};function L4(a,b,c,d){bz.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Aa="";this.F=b||null;this.ma=c||new m8c(a);this.V=null!=d?d:null;a=new Px;Ux(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.ma.C()&&Ux(a,{key:"copy-link",caption:"Copy link"});Sx(this,a);this.R=new bl;this.va(this.R)}A(L4,bz);p=L4.prototype;
p.Ca=function(){L4.Ba.Ca.call(this);dv(Mx(this),"copy-link-dialog");dv(Tx(this.D,"done"),"copy-link-done-button");this.C=Iw(HFf,{link:this.Aa},void 0,this.qa());Uu(this.C,"label","Link to this comment");this.Ob().appendChild(this.C);this.L=Tx(this.D,"copy-link");null!==this.V&&(gu(this.Dq(),"z-index",this.V),gu(Mx(this),"z-index",this.V+1));if(this.L){var a=Rs("DIV");dv(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Jx(this));this.O=new ey(a);this.J=gy("Link copied to clipboard.","info",
!1,4E3);var b=iu(Mx(this),"zIndex");gu(a,"z-index",b+1)}};p.Qm=function(){var a=this;L4.Ba.Qm.call(this);this.F&&kl(this.R,this.F.C(),function(b){b.C&&a.J&&a.O&&(a.J.isVisible()||a.O.postMessage(a.J),a.C.focus(),a.C.select())});this.C.focus();this.C.select()};p.um=function(){L4.Ba.um.call(this);this.F&&cva(this.R,this.F.C())};p.Ja=function(){L4.Ba.Ja.call(this);this.getHandler().listen(this.C,"click",this.A5b);this.L&&this.getHandler().listen(this.L,"click",this.Arb)};
p.m6b=function(a){this.Aa=a;this.C&&(this.C.value=a)};p.A5b=function(a){a.target.focus();a.target.select()};p.Arb=function(a){a.stopPropagation();this.F&&this.ma.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.F(this.C.value))};p.La=function(){L4.Ba.La.call(this);F(this.J);delete this.J;delete this.L;delete this.C};function M4(a){R.call(this);this.J=new R;this.va(this.J);this.D=new Ey("");this.va(this.D);this.O=new zx("");this.va(this.O);this.V=a;this.$d=null}A(M4,R);p=M4.prototype;
p.Ja=function(){M4.Ba.Ja.call(this);var a=Ju(this,"nfd-icwr");this.J.Xa(a);this.Ia(this.J);if(a=Ju(this,"nfd-i"))this.D.Xa(a),this.D.Xd(this.J),fv(this.D.getElement(),"jfk-textinput"),a=new hz,a.Xa(this.D.getElement()),this.va(a),this.R=a=new gz(this.D.getElement()),this.va(a),this.$d=a=new Zu(this.D.getElement()),this.va(a),a=new Fx(this.D.getElement()),this.getHandler().listen(a,"focusout",Ga(this.n0a,!1)).listen(a,"focusin",Ga(this.n0a,!0)).listen(this.R,"input",this.abc);a=Ju(this,"nfd-a");this.O.Xa(a);
this.Ia(this.O)};p.Dz=g("$d");p.getValue=function(){return this.D.getValue()};p.abc=function(){var a=this.Ra(),b=this.getValue();I(a.hK,2,b);this.o0a()};p.o0a=Xi;p.n0a=function(a){hv(this.J.getElement(),"nfd-input-focus",a)};p.yQ=function(a){this.Sb(a.clone());this.D.setValue(a.RB());try{this.D.getElement().focus()}catch(b){}};p.XGa=function(){this.D.getElement().focus()};function IFf(a,b){a=a.J.getElement();hv(a,"nfd-invalid",b)};function JFf(a){var b=a.Z3b;return U("<li class='nfd-format-pill'><div class='nfd-format-display'>"+S(a.fib)+"</div><div class='nfd-format-sample'>"+S(b)+"</div></li>")};function KFf(a,b,c){R.call(this);this.Sb(a);this.D=b;this.C=c}A(KFf,R);p=KFf.prototype;p.Ca=function(){var a=this.Ra(),b=this.C?Lea(a.RB(),30):a.RB();a=this.C?LYd(a,this.D):"";b=Iw(JFf,{fib:b,Z3b:a});this.Cb(b)};p.Ja=function(){KFf.Ba.Ja.call(this);ht(this.getElement(),!0);var a=new Zu(this.getElement());this.va(a);this.getHandler().listen(a,"key",this.gbc).listen(this.getElement(),"mousedown",this.fbc).listen(this.getElement(),"dblclick",this.utb)};
p.gbc=function(a){function b(c,d){for(;d=c(d);)if(xu(d)){d.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(ct,this.getElement());break;case 38:b(eZa,this.getElement())}};p.fbc=function(a){a.preventDefault();this.dispatchEvent("change")};p.utb=function(){this.dispatchEvent("action")};function LFf(a,b,c){R.call(this);this.D=b;this.C=c;MFf(this,a)}A(LFf,R);LFf.prototype.Ca=function(){var a=this.qa().Ca("UL","nfd-pill-container");this.Cb(a)};function MFf(a,b){Gc(b,function(c){a.Ia(new KFf(c,a.D,a.C),!0)})}LFf.prototype.filter=function(a){a=a.toLowerCase();this.hf(function(b){var c=td(ee(a)),d=b.Ra().RB().toLowerCase();c=c||vd(d,a);Q(b.getElement(),c)})};function N4(a){bz.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Eka();this.Ia(this.input,!0);this.J=new R;this.Ia(this.J,!0);a=this.s$();ed(a,void 0,xFf);this.C=new LFf(a,this.t0(),this.LYa());this.J.Ia(this.C,!0);Sx(this,null);this.$i=!0}A(N4,bz);p=N4.prototype;p.mSa=Xi;p.LYa=Wi;p.isEmpty=function(){return td(this.input.getValue())};p.wf=function(){return this.input.Ra().wf()};p.Ca=function(){N4.Ba.Ca.call(this);var a=Rs("DIV","dialog-separator");Ys(a,Jx(this))};
p.Ja=function(){N4.Ba.Ja.call(this);dv(this.J.getElement(),"nfd-dialog-content");this.getHandler().listen(this.C,"change",this.Jvb).listen(this.C,"action",this.xta).listen(this.input.O,"action",this.xta).listen(this.input,"afterhide",this.Vnb);this.input.R&&this.getHandler().listen(this.input.R,"input",this.dUb);var a=this.input.Dz();a&&this.getHandler().listen(a,"key",this.eUb);a=this.s$()[0];this.input.yQ(a)};p.Vnb=function(a){a.stopPropagation()};
p.Jvb=function(a){this.input.yQ(a.target.Ra());IFf(this.input,!1)};p.dUb=function(){this.C.filter(this.input.getValue());IFf(this.input,!this.input.Ra().wf())};p.eUb=function(a){13==a.keyCode&&this.xta()};p.xta=function(){this.wf()&&!this.isEmpty()?(hhb.Kb(new uV(this.A3(),void 0,this.mSa())),this.setVisible(!1)):(IFf(this.input,!0),this.input.XGa())};function O4(a,b,c,d,e){Nv.call(this,b,c,d,e);this.C=a}A(O4,Nv);O4.prototype.Ah=function(){var a=O4.Ba.Ah.call(this),b=this.getParent();return b&&b instanceof wv&&!b.isVisible()?this.C(a,this.Ra()):a};function NFf(a){a=a||{};var b=a.id,c=a.name,d=a.Dd,e=a.U0b,f=a.H$b,h=a.maxLength,k=a.value,l=a.dir,m=a.type,r=a.pattern;a=a.attributes;return U('<input class="'+V("jfk-textinput")+(d?" "+V(d):"")+'"'+(b?' id="'+V(b)+'"':"")+(h?' maxlength="'+V(h)+'"':"")+(Sw(e)&&Sw(f)?' label="'+V(e)+'"':"")+(c?' name="'+V(c)+'"':"")+(e?' placeholder="'+V(e)+'"':"")+' type="'+V(null!=m?m:"text")+'"'+(r?' pattern="'+V(r)+'"':"")+(k?' value="'+V(k)+'"':"")+(l?' dir="'+V(l)+'"':"")+(a?" "+h4a(a):"")+">")};function OFf(a,b,c){b=c||b;return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+V(a.a2)+"'>"+PFf(a)+"</div>"+QFf(a,b)+"</div>")}function RFf(a,b,c){b=c||b;return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+V(a.a2)+"'></div>"+QFf(a,b)+"</div>")}
function SFf(a,b,c){b=c||b;c=a.QLb;return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+V(a.a2)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+PFf(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+V(c)+"'></div></div></div></div>"+QFf(a,b)+"</div>")}
function TFf(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+UFf({label:""});a+=UFf({label:Uw("Negative:")});a+=UFf({label:Uw("Zero:")});a+=UFf({label:Uw("Text:")});return U(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function UFf(a){return U("<tr><td class='nfd-sample-label'>"+S(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function QFf(a,b){a=""+S(yx({id:a.nM,style:2,Dd:"nfd-apply",content:Tw("Apply")},b));return U(a)}function PFf(a){return U(S(NFf({id:a.fPa,U0b:a.gPa,H$b:!0})))};function VFf(a){M4.call(this,a);this.F=new R;this.C=new OP("");this.C.ld("nfd-currency-other-formats")}A(VFf,M4);p=VFf.prototype;p.Ca=function(){var a=Iw(SFf,{a2:Hu(this,"nfd-icwr"),fPa:Hu(this,"nfd-i"),gPa:this.V,QLb:Hu(this,"nfd-ic"),nM:Hu(this,"nfd-a")});this.Cb(a)};
p.Ja=function(){VFf.Ba.Ja.call(this);var a=Ju(this,"nfd-ic");this.F.Xa(a);this.F.Xd(this.J);this.F.Ia(this.C,!0);this.getHandler().listen(this.C,"aftershow",this.fUb).listen(this.C,"action",this.RLa).listen(this.R,"input",Ga(this.Q_a,null))};p.yQ=function(a){VFf.Ba.yQ.call(this,a);a.C&&this.D.setValue(zy[a.C][1]);this.Q_a(a)};
p.Q_a=function(a){a=a?a.C:void 0;var b=this.C;b.tf(null);if(a){var c=this.Ra(),d=c.C;WFf(this,c);c=J2d(d,zy[d][2]);c=new uV(XFf(c),I2d[d],d);WFf(this,c);c=J2d(d,d+" "+zy[d][1]);d=new uV(XFf(c),I2d[d],d);WFf(this,d)}else this.Ra().C=null;var e="[$"+this.getValue()+"]";d=a?I2d[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new uV(XFf(c[e]),d,a);WFf(this,f)}b.Xe(0);this.RLa();dv(b.dc().getElement(),"number-format-menu")};function WFf(a,b){var c=new O4(function(d){return Lea(d,25)},LYd(b,1E3),b);a.va(c);a.va(b);c.Ep(!0);a=a.C;for(b=0;b<a.ji();b++)if(a.jf(b).Ah()==c.Ah())return;a.Tc(c)}p.RLa=function(){for(var a=this.C,b=0;b<a.ji();b++)a.jf(b).qc(!1);a.cR()};p.fUb=function(){this.C.yf().qc(!0)};function XFf(a){var b=new Ye;I(b,2,a);b.setType(4);return b};function YFf(a){N4.call(this,a);this.setTitle("Custom currencies")}A(YFf,N4);p=YFf.prototype;p.t0=n(1000.12);p.Eka=function(){return new VFf("Custom currency")};p.s$=function(){var a=this;m0d();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=I2d[e]:sFf(d,L2d(d.Bn()))}var f=[];Ad(zy,function(k,l){k=K2d(l);a.va(k);f.push(k)});var h=jpe();hd(f,function(k,l){return h(k.RB(),l.RB())});return b.concat(f)};
p.A3=function(){var a=new Ye;a.setType(4);I(a,3,1);var b=this.input.C.yf().getValue().Bn();I(a,2,b);return a};p.mSa=function(){return this.input.Ra().C};function ZFf(a){R.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}A(ZFf,R);ZFf.prototype.Ca=function(){var a=Iw(TFf);this.F=Ns("nfd-sample-label",a);this.D=Ms("nfd-rendered-sample",a);this.Cb(a)};function P4(a,b){M4.call(this,a);this.C=new ZFf(b);this.Sb(new uV(""))}A(P4,M4);P4.prototype.Ca=function(){var a=Iw(OFf,{fPa:Hu(this,"nfd-i"),gPa:this.V,a2:Hu(this,"nfd-icwr"),nM:Hu(this,"nfd-a")});this.Cb(a)};P4.prototype.Ja=function(){P4.Ba.Ja.call(this);this.Ia(this.C,!0);$Ff(this)};P4.prototype.o0a=function(){$Ff(this)};P4.prototype.yQ=function(a){P4.Ba.yQ.call(this,a);$Ff(this)};
function $Ff(a){var b=a.Ra();if(b){var c=a.C;a=b.Bn().split(";").length-1;gt(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=LYd(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Bn()),k=d<=a;Q(gZa(e),k);gt(e,f);gu(e,"color",h||"")}d=b.wf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Bn()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Bn());c=c.D[3];Q(gZa(c),3<=a);gt(c,d);gu(c,"color",b||"")}};function aGf(a){N4.call(this,a);this.setTitle("Custom number formats")}A(aGf,N4);aGf.prototype.t0=n(1234.56);aGf.prototype.Eka=function(){return new P4("Custom number format",1234.56)};
aGf.prototype.s$=function(){var a=this.F;a.push(new uV("0"));a.push(new uV("0.00"));a.push(new uV("#,##0"));a.push(new uV("#,##0.00"));a.push(new uV("#,##0_);(#,##0)"));a.push(new uV("#,##0_);[Red](#,##0)"));a.push(new uV("#,##0.00_);(#,##0.00)"));a.push(new uV("#,##0.00_);[Red](#,##0.00)"));a.push(new uV("$#,##0_);($#,##0)"));a.push(new uV("$#,##0_);[Red]($#,##0)"));a.push(new uV("$#,##0.00_);($#,##0.00)"));a.push(new uV("$#,##0.00_);[Red]($#,##0.00)"));a.push(new uV("@"));a.push(new uV("0%"));a.push(new uV("0.00%"));
a.push(new uV("0.00E+00"));a.push(new uV("##0.0E+0"));a.push(new uV("# ?/?"));a.push(new uV("# ??/??"));a.push(new uV('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new uV('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new uV('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new uV('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};aGf.prototype.A3=function(){var a=new Ye;a.setType(2);I(a,3,1);var b=this.input.getValue();I(a,2,b);return a};function bGf(a){var b=a.description;a=a.m3b;return U('<div class="waffle-dv-rec-chip" title="'+V(b)+'"><div class="waffle-dv-rec-range">'+S(a)+'</div><div class="waffle-dv-rec-description">'+S(b)+"</div></div>")}function cGf(){return U('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function dGf(){var a=new OP(null);a.qk(!0);return a};function eGf(a,b,c){Bl.call(this);this.Hb=C(B(),"docs-egmd");this.D=a;this.vh=b;this.Tb=c;this.R=this.H=this.Ga=this.Da=this.V=this.F=null;this.wc=new Ey;this.va(this.wc);this.ge=new Ey;this.va(this.ge);this.Aa=this.O=null;this.zd=new Ey;this.va(this.zd);this.rf=new Ey;this.va(this.rf);this.Ta=this.Oa=this.Qa=this.ma=this.L=null;this.Md=new Ey;this.va(this.Md);this.Yd=new Ey;this.va(this.Yd);this.cd=new Ey;this.va(this.cd);this.Qe=new Ey;this.va(this.Qe);this.Va=this.Rc=null;this.C=new nY("");this.va(this.C);
this.$a=this.J=this.Eb=this.xb=this.Df=this.Ec=this.gc=this.Za=null;this.Jg=this.kd=!1;this.fc=this.Kf=this.Ua=this.gb=null;this.le=new Tl(this);this.va(this.le);this.Mi=new Hi;this.Cg=this.Th=this.dh=this.zg=this.Ph=this.Ka=null;this.Bv();a=this.le;a.listen(this.F,"action",this.yxb);a.listen(this.V,"action",this.Wpa);a.listen(this.Da,"action",this.Wpa);a.listen(this.Ga,"action",this.Wpa);a.listen(this.J,"focus",Ga(this.UXa,!0));a.listen(this.J,"blur",Ga(this.UXa,!1));a.listen(this.J,"change",this.Kpa);
a.listen(this.J,"keyup",this.Kpa);b=[this.O,this.Aa,this.H,this.R,this.L,this.ma,this.Oa,this.Ta];for(c=0;c<b.length;c++)this.le.listen(b[c],"change",y(this.QTb,this,b[c])),this.le.listen(b[c],"keyup",y(this.txb,this,b[c]));a.listen(this.Ua,"change",y(this.zNa,this));a.listen(this.Qa,"change",y(this.qJb,this));a.og(this.$a,xl,this.sEb)}A(eGf,Bl);var fGf="placeholder"in document.createElement("input");
function gGf(a){var b=a.Cg;b||(b=[{fk:"List from a range",type:4},{fk:"List of items",type:3},{fk:"Number",type:0},{fk:"Text",type:1},{fk:"Date",type:2},{fk:"Custom formula is",type:5},{fk:"Tick box",type:6}],a.Cg=b);return b}
function hGf(a){var b=a.Th;b||(b=[{fk:"contains",code:9,inputs:0,example:"Approved"},{fk:"does not contain",code:10,inputs:0,example:"Approved"},{fk:"equals",code:13,inputs:0,example:"Approved"},{fk:"is a valid email",code:14,inputs:-1,example:null},{fk:"is a valid URL",code:15,inputs:-1,example:null}],a.Th=b);return b}
function iGf(a){var b=a.zg;if(!b){b=a.Hb?"11/2017":"15/11/2014";var c=a.Hb?"11/2018":"15/11/2015",d=a.Hb?"11/2017":"15/11/2014";b=[{fk:"is a valid date",code:30,inputs:-1,example:null},{fk:"equal to",code:16,inputs:2,example:d},{fk:"before",code:17,inputs:2,example:d},{fk:"on or before",code:19,inputs:2,example:d},{fk:"after",code:18,inputs:2,example:d},{fk:"on or after",code:20,inputs:2,example:d},{fk:"between",code:21,inputs:3,example:b,ZS:c},{fk:"not between",code:22,inputs:3,example:b,ZS:c}];
a.zg=b}return b}function jGf(a){var b=a.dh;b||(b=[{fk:"range",code:23,inputs:6,example:null},{fk:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.dh=b);return b}
function kGf(a){var b=a.Ph;b||(b=[{fk:"between",code:7,inputs:8,example:"10",ZS:"100"},{fk:"not between",code:8,inputs:8,example:"10",ZS:"100"},{fk:"less than",code:3,inputs:7,example:"10"},{fk:"less than or equal to",code:4,inputs:7,example:"10"},{fk:"greater than",code:1,inputs:7,example:"10"},{fk:"greater than or equal to",code:2,inputs:7,example:"10"},{fk:"equal to",code:5,inputs:7,example:"10"},{fk:"not equal to",code:6,inputs:7,example:"10"}],a.Ph=b);return b}
function lGf(){return{fk:"",code:29,inputs:0,example:"=ISODD(A1)"}}function mGf(){return{fk:"",code:31,inputs:-1,example:""}}p=eGf.prototype;
p.Bv=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,t,v,w,z,K=a.qa(),T;var aa=K.Ca("TR","waffle-dv-trrules",K.Ca("TD","waffle-dv-label",K.Ca("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),K.Ca("TD",{colspan:"7"},l=K.Ca("DIV","goog-inline-block"),T=K.Ca("DIV","goog-inline-block"),h=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=K.Ca("SPAN","waffle-dv-separator","and"),k=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.cd.Xa(h);this.Qe.Xa(k);this.zd.Xa(c);this.rf.Xa(d);this.wc.Xa(e);this.ge.Xa(f);var Z=dGf();Gu(Z,l);var ma=dGf();Gu(ma,l);var ra=dGf();Gu(ra,l);var wa=dGf();Gu(wa,l);var La=nGf(a,T);(v=Z.getElement())&&Uu(v,"labelledby",
"waffle-dv-criteria");var Na;var Sa=K.Ca("TR","waffle-dv-trrules waffle-dv-trrules-showitems",K.Ca("TD"),K.Ca("TD",{colspan:"7"},Na=K.Ca("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show drop-down list in cell")));v=oGf(this);KR(v,Na);Gu(v,Na);var cb=K.Ca("TR","waffle-dv-trrules waffle-dv-trrules-showitems",K.Ca("TD"),K.Ca("TD",{colspan:"7"},m=K.Ca("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Mb=oGf(this);KR(Mb,m);Gu(Mb,m);var Hb=K.Ca("TR","waffle-dv-trrules",
K.Ca("TD"),K.Ca("TD","waffle-dv-customcheckboxlabel",K.Ca("SPAN",{id:"customCheckboxInputLabel_checked"},"Ticked:")),K.Ca("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var Lb=K.Ca("TR","waffle-dv-trrules",K.Ca("TD"),K.Ca("TD","waffle-dv-customcheckboxlabel",K.Ca("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unticked:")),K.Ca("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},t=K.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));
this.Md.Xa(r);this.Yd.Xa(t);Uu(r,"labelledby","customCheckboxInputLabel_checked");Uu(t,"labelledby","customCheckboxInputLabel_unchecked");qV(this.Md,"e.g. TRUE");qV(this.Yd,"e.g. FALSE");var Tb=K.Ca("TR","waffle-dv-trrules",K.Ca("TD","waffle-dv-label",K.Ca("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),K.Ca("TD",{colspan:"7"},K.Ca("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},K.Ca("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",
name:"onInvalidData",role:"radio"}),K.Ca("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),K.Ca("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),K.Ca("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new uwe;vwe(m,"onInvalidData",Tb);var ac=K.Ca("TR","waffle-dv-trrules waffle-dv-trrules-appearance",K.Ca("TD",null,K.Ca("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),K.Ca("TD",{colspan:"7"},w=K.Ca("SPAN",
"waffle-dv-label waffle-dv-checkbox-label","Show validation help text:")));var Ec=oGf(this);KR(Ec,w);Gu(Ec,w);w=Ec.Na();var fc=T0a(w,"labelledby");Uu(w,"labelledby","waffle-dv-appearance "+fc);w=K.Ca("TR","waffle-dv-trrules",K.Ca("TD"),K.Ca("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},z=K.Ca("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),fc=K.Ca("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));ht(fc,!0);a=a.ma.childNodes[0];
K.appendChild(a,aa);K.appendChild(a,Sa);K.appendChild(a,cb);K.appendChild(a,Hb);K.appendChild(a,Lb);K.appendChild(a,Tb);K.appendChild(a,ac);K.appendChild(a,w);this.C.render(l);K=this.C;K.Usa=this.Hb?36:29;K.resize();K=this.C;K.Fsa=200;K.resize();this.C.getElement().style.width="324px";fGf?this.C.getElement().placeholder="Enter items separated by a comma...":(K=this.C.getElement(),hw(K,"Enter items separated by a comma...","Enter items separated by a comma..."));if(K=this.C.getElement())Xu(K,"Enter items separated by a comma..."),
ev(K,["waffle-dv-list-options-textarea","jfk-textinput"]);this.J=z;Z.setVisible(!0);K=gGf(this);pGf(this,K,Z);K=kGf(this);pGf(this,K,wa);K=hGf(this);pGf(this,K,ma);K=iGf(this);pGf(this,K,ra);qGf(this,Z,wa,ma,ra,h,k,c,d,e,f,b,l,La,Sa,w,v,Na,fc,Ec,T,m,Mb,r,t,cb,Hb,Lb)};
function qGf(a,b,c,d,e,f,h,k,l,m,r,t,v,w,z,K,T,aa,Z,ma,ra,wa,La,Na,Sa,cb,Mb,Hb){a.F=b;a.F.setVisible(!0);a.Da=c;a.V=e;a.Ga=d;a.Rc=t;a.L=f;a.ma=h;a.O=k;a.Aa=l;a.H=m;a.R=r;a.Va=v;a.Ka=w;a.Za=ra;a.Qa=La;a.Oa=Na;a.Ta=Sa;a.Df=cb;a.xb=Mb;a.Eb=Hb;Q(a.Df,!1);Q(a.xb,!1);Q(a.Eb,!1);ma.qc(!1);a.Ua=ma;a.fc=wa;rGf(a,!1);a.gc=z;T.qc(!0);a.gb=T;a.Kf=aa;a.Ec=K;Q(a.Ec,!0);sGf(a);tGf(a);a.$a=Z;Q(a.$a,!1)}
function uGf(a,b){Q(a.gc,23==b||24==b);a.Kf.innerText="Show drop-down list in cell";b=31==b;Q(a.Df,b);var c=a.Qa.isChecked();Q(a.xb,b&&c);Q(a.Eb,b&&c)}function pGf(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.qa();e=new Nv(b[d].fk,null,e);c.Tc(e);Tu(e.getElement(),"menuitem")}c.Xe(0)}p.Wpa=function(){tGf(this);this.J.value=vGf(this);this.dispatchEvent("change")};p.yxb=function(){sGf(this);tGf(this);this.J.value=vGf(this);this.dispatchEvent("change")};p.UXa=da("Jg");
p.Kpa=function(a){this.kd||a&&!W0a(a)||this.J.value===wGf(this)||(this.kd=!0,Q(this.$a,!0))};p.sEb=function(){this.kd=!1;this.J.value=vGf(this);Q(this.$a,!1)};p.zNa=function(){Q(this.Ec,this.Ua.isChecked())};p.qJb=function(){var a=this.Qa.isChecked();a||xGf(this);Q(this.xb,a);Q(this.Eb,a);yGf(this)};function yGf(a){a.J.value=vGf(a)}function zGf(a){yGf(a);a.C.resize()}p.QTb=function(a){yGf(this);AGf(this,a)?(this.D.un=0,Q4(a),this.dispatchEvent("change")):(this.D.un=1,R4(a),this.dispatchEvent("error"))};
p.txb=function(){this.dispatchEvent("keyup")};function AGf(a,b){if(0!=S4(a))return!0;var c=b.value;if(null!=c&&xu(b)){if(!BGf(a.D))return!0;a=T4(a,c,CGf(a).code);return null!=a&&(Pe(a,3)||Pe(a,5)&&a.Bq().hasValue()&&3==H(a.Bq().getValue(),1))}return!0}function R4(a){a.select();dv(a,"waffle-input-error")}function Q4(a){a&&fv(a,"waffle-input-error")}function xGf(a){Q4(a.C.getElement());Q4(a.H);Q4(a.R);Q4(a.L);Q4(a.ma);Q4(a.Oa);Q4(a.O);Q4(a.Aa);Q4(a.Ka.nt());a.D.un=0;a.dispatchEvent("change")}
function DGf(a,b){return a.Hb?b:"e.g. "+b}function S4(a){return gGf(a)[a.F.Mh()].type}function sGf(a){var b=S4(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.V.setVisible(c);a.Da.setVisible(d);a.Ga.setVisible(e);Q(a.Va,f);Q(a.Za,h);Q(a.L,!1);Q(a.ma,!1);Q(a.O,!1);Q(a.Aa,!1);Q(a.H,!1);Q(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function CGf(a){var b;null!=EGf(a)?b=EGf(a):a.V.isVisible()?b=iGf(a)[a.V.Mh()]:a.Da.isVisible()?b=kGf(a)[a.Da.Mh()]:5==S4(a)?b=lGf():6==S4(a)?b=mGf():b=hGf(a)[a.Ga.Mh()];return b}function EGf(a){var b=jGf(a);return 4==S4(a)?b[0]:3==S4(a)?b[1]:null}
function tGf(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=CGf(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var t=CGf(a);if(3==S4(a))fGf?a.C.getElement().placeholder="Enter items separated by a comma...":(t=a.C.getElement(),hw(t,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(t.example)if(0==t.inputs||1==t.inputs)qV(a.zd,DGf(a,t.example)),
qV(a.rf,DGf(a,t.ZS)||"");else if(2==t.inputs||3==t.inputs)qV(a.wc,DGf(a,t.example)),qV(a.ge,DGf(a,t.ZS)||"");else if(7==t.inputs||8==t.inputs)qV(a.cd,DGf(a,t.example)),qV(a.Qe,DGf(a,t.ZS)||"");xGf(a);Q(a.L,b);Q(a.ma,c);Q(a.O,d);Q(a.Aa,e);Q(a.H,f);Q(a.R,h);Q(a.Va,l);l&&a.C.resize();Q(a.Za,m);uGf(a,r.code);Q(a.Rc,k)}
function T4(a,b,c){var d=BGf(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.Ac();e=e.Cc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C,f,e,b,c,!0))?a.Mi.Wc(mf.xa(),b):null}
function FGf(a){var b=new qf,c=CGf(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(T4(a,a.O.value,d));break;case 1:e.push(T4(a,a.O.value,d));e.push(T4(a,a.Aa.value,d));break;case 2:e.push(T4(a,a.H.value,d));break;case 3:e.push(T4(a,a.H.value,d));e.push(T4(a,a.R.value,d));break;case 7:e.push(T4(a,a.L.value,d));break;case 8:e.push(T4(a,a.L.value,d));e.push(T4(a,a.ma.value,d));break;case 5:a=a.C.getValue().split(",");for(c=0;c<a.length;c++)e.push(bqe(a[c]));break;case 6:c=N$b("="+a.Ka.getValue());e.push(T4(a,
c,d));break;case -1:a.Qa.isChecked()&&(e.push(T4(a,ud(a.Oa.value),d)),td(a.Ta.value)||e.push(T4(a,ud(a.Ta.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=uG(d,e);I(b,1,d);return b}function GGf(a){var b=ud(a.Ka.getValue());!a.Tb.D.D[ud(ee(b).toLowerCase())]&&One(a.Tb,b)&&(b=Rne(a.Tb,b,!0));return b}function vGf(a){return a.kd||a.Jg?a.J.value:wGf(a)}
function wGf(a){var b="";var c=S4(a);var d=4==c;c=3==c||4==c;if(a.V.isVisible())c=iGf(a)[a.V.Mh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Ga.isVisible())c=hGf(a)[a.Ga.Mh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid URL":b+"Enter text that ";else if(c)c=EGf(a),b+="Click and enter a value from ";else if(5==S4(a))c=lGf(),b="Enter a value that satisfies the formula:";else if(6==S4(a))if(c=mGf(),a.Qa.isChecked()&&!td(ud(a.Oa.value))){b=ud(a.Oa.value);var e=
ud(a.Ta.value);b=td(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=kGf(a)[a.Da.Mh()],b+="Enter a number ";-1!=c.inputs&&(b+=c.fk);e=GGf(a);23==c.code&&""!=e&&d&&(d=Rne(a.Tb,e,!0))&&(b+=" "+d);td(ee(a.O.value))||0!=c.inputs&&1!=c.inputs?td(ee(a.H.value))||2!=c.inputs&&3!=c.inputs?td(ee(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;td(ee(a.Aa.value))||1!=c.inputs?td(ee(a.R.value))||3!=c.inputs?td(ee(a.ma.value))||
8!=c.inputs||(b+=" and "+a.ma.value):b+=" and "+a.R.value:b+=" and "+a.Aa.value;return b}function rGf(a,b){wwe(a.fc,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function HGf(a,b){switch(b){case 0:a.F.Xe(2);break;case 1:a.F.Xe(3);break;case 2:a.F.Xe(4);break;case 3:a.F.Xe(1);break;case 4:a.F.Xe(0);break;case 5:a.F.Xe(5);break;case 6:a.F.Xe(6)}}
function IGf(a,b,c,d,e){a.F.Xe(0);a.V.Xe(0);a.Da.Xe(0);a.Ga.Xe(0);a.J.value="";a.L.value="";a.ma.value="";a.H.value="";a.R.value="";a.O.value="";a.Aa.value="";a.C.setValue("");a.Ka.setValue("");rGf(a,!1);var f=a.kd=!1,h=!1,k=!1,l=!1,m=!1,r=!1,t=!1,v=!1,w=!1,z=!1,K=!1,T=!1,aa=!1,Z=!1,ma=!1,ra=!1,wa=!1,La=!1,Na=b&&rf(b);b=Na&&of(Na);if((Na=Na&&pf(Na))&&b){for(var Sa=jGf(a),cb=iGf(a),Mb=kGf(a),Hb=hGf(a),Lb=lGf(),Tb=mGf(),ac=0,Ec=0;Ec<Sa.length;Ec++)if(b==Sa[Ec].code){ac=Sa[Ec].inputs;23==Sa[Ec].code?
(ra=!0,HGf(a,4)):(T=!0,HGf(a,3));a.gb.qc(!!e);break}for(e=0;e<cb.length;e++)if(b==cb[e].code){ac=cb[e].inputs;a.V.Xe(e);HGf(a,2);aa=v=!0;break}for(e=0;e<Mb.length;e++)if(b==Mb[e].code){ac=Mb[e].inputs;a.Da.Xe(e);HGf(a,0);Z=w=!0;break}for(e=0;e<Hb.length;e++)if(b==Hb[e].code){ac=Hb[e].inputs;a.Ga.Xe(e);HGf(a,1);ma=z=!0;break}b==Lb.code&&(ac=Lb.inputs,HGf(a,5),wa=!0);b==Tb.code&&(ac=Tb.inputs,HGf(a,6),La=!0);if(aa||ma||Z||T||ra||wa||La)if(ma=BGf(a.D),aa=ma.rect.Ac(),Z=ma.rect.Cc(),ma=ma.C,-1==ac)La&&
0<Na.length&&(K=!0,a.Qa.qc(!0),a.Md.setValue(vG(Na[0],ma,aa,Z)),1<Na.length&&a.Yd.setValue(vG(Na[1],ma,aa,Z)));else if(0==ac)m=vG(Na[0],ma,aa,Z),a.zd.setValue(m),m=!0;else if(1==ac)r=vG(Na[0],ma,aa,Z),m=vG(Na[1],ma,aa,Z),a.zd.setValue(r),a.rf.setValue(m),r=m=t=!0;else if(2==ac)f=vG(Na[0],ma,aa,Z),a.wc.setValue(f),f=!0;else if(3==ac)h=vG(Na[0],ma,aa,Z),f=vG(Na[1],ma,aa,Z),a.wc.setValue(h),a.ge.setValue(f),h=f=t=!0;else if(7==ac)k=vG(Na[0],ma,aa,Z),a.cd.setValue(k),k=!0;else if(8==ac)l=vG(Na[0],ma,
aa,Z),k=vG(Na[1],ma,aa,Z),a.cd.setValue(l),a.Qe.setValue(k),l=k=t=!0;else if(5==ac){T=!0;La=[];for(ac=0;ac<Na.length;ac++)La.push(vG(Na[ac],ma,aa,Z));a.C.setValue(La.join(","));a.C.resize()}else 6==ac&&(ra=!0,La=vG(Na[0],ma,aa,Z),null!=La&&(La=La.substring(1),Na=!!iM(La),La=(ac=kM(La,a.vh,!1,!0))?mM(ac.rect,QK(a.vh,ac.C).Be()):La,Na||(La=jM(La)),a.Ka.setValue(La)));else a.F.Xe(0),ra=!0;Q(a.Rc,t);a.V.setVisible(v);a.Da.setVisible(w);a.Ga.setVisible(z);Q(a.H,f);Q(a.R,h);Q(a.O,m);Q(a.Aa,r);Q(a.L,k);
Q(a.ma,l);Q(a.xb,K);Q(a.Eb,K);Q(a.gc,!0);Q(a.Va,T);a.C.resize();Q(a.Za,ra);null!=b&&uGf(a,b)}else qGf(a,a.F,a.Da,a.Ga,a.V,a.L,a.ma,a.O,a.Aa,a.H,a.R,a.Rc,a.Va,a.Ka,a.gc,a.Ec,a.gb,a.Kf,a.$a,a.Ua,a.Za,a.fc,a.Qa,a.Oa,a.Ta,a.Df,a.xb,a.Eb);a.zNa();c=c||"";v=c.lastIndexOf("</strong>");-1!=v&&(c=$d(ud(c.substring(v+9))));a.Ua.qc(!!c);c&&(vGf(a)!=c&&a.Kpa(),a.J.value=c,Q(a.Ec,!0));rGf(a,d)}function oGf(a){var b=a.D.qa();return a.Hb?new LR(!1,MR.getInstance(),b):new NR}
p.La=function(){this.gc=this.gb=this.$a=this.J=this.Rc=this.Ta=this.Oa=this.ma=this.L=this.Aa=this.O=this.R=this.H=null;F(this.Ka);this.Ka=null;F(this.gb);this.gb=null;F(this.Ga);this.Ga=null;F(this.Da);this.Da=null;F(this.V);this.V=null;F(this.F);this.F=null;F(this.Ua);this.Ua=null;F(this.fc);this.fc=null;eGf.Ba.La.call(this)};function JGf(a,b,c,d,e,f,h){bz.call(this);this.xb=a;this.le=b;this.$a=c;this.cd=d;this.R=e;this.Ua=f;this.Ka=h;this.V=new R(this.qa());this.Ia(this.V);this.Tb=new Jv("",new aU,this.qa());this.Ia(this.Tb);this.Va=new R(this.qa());this.Ia(this.Va);this.xe=new IT(!1,"#4285f4");this.Ia(this.xe);this.gc=new GO(c,"waffle-dv-highlight-styled-border","waffle-dv-highlight-styled-rect");this.va(this.gc);this.F=this.ma=null;this.fc=new Tl(this);this.va(this.fc);this.gb=this.L=this.J=this.C=null;this.Aa=C(B(),
"fedvs");this.Za=this.O=null;this.Eb=-1;this.Ec=[];this.wc=[];this.kd=-1;a=tJ(this.$a).Nc();this.zd=aua(a.Ac(),a.Cc(),a.Xc(),a.hd());this.Hb=!1;this.Rc=new Tl(this);this.va(this.Rc);this.L=new Px;C(B(),"docs-egmd")?(this.L.set("cancel","Cancel",!1,!0),this.L.set("clear","Remove validation"),this.L.set("save","Save")):(this.L.set("save","Save"),this.L.set("clear","Remove validation"),this.L.set("cancel","Cancel",!1,!0));Sx(this,this.L);Ox(this,!1);this.render();dv(Mx(this),"waffle-data-validation-dialog");
a=this.Ob();b=this.qa();this.setTitle("Data validation");this.J||(c=b.Ca("DIV",{"class":"waffle-input-error-butter-wrap"}),d=b.Ca("DIV",{"class":"waffle-input-error-butter-container"},c),b.appendChild(a,d),this.J=new dy(d),this.J.setType("warning"),this.J.setContent(""),this.J.render(c),D6a(this.J,!0),this.J.setVisible(!1));this.Aa&&(d=b.Ca("DIV","waffle-dv-recs-title-bar"),e=b.Ca("DIV",{id:KGf.zAa},"Suggested validations"),c=b.Ca("DIV","waffle-dv-rec-wrapper"),f=b.Ca("DIV","waffle-dv-feedback-link",
"Send feedback"),b.appendChild(a,d),b.appendChild(d,f),b.appendChild(d,e),b.appendChild(a,c),this.Tb.Xa(f),Q(f,cA),this.V.Xa(c),d=b.Ca("DIV","waffle-dv-rec-spinner-container"),b.appendChild(c,d),this.Va.Xa(d),this.xe.render(d),this.xe.setActive(!0));this.ma=b.Ca("TABLE",{cellSpacing:"0","class":"waffle-dv-table"},b.Ca("TBODY"));b.appendChild(a,this.ma);this.Aa&&dv(this.ma,"waffle-dv-table-with-suggestions");a=this.Ob();a=Gs(a);b=a.Ca("TR","waffle-dv-trrules");b.appendChild(a.Ca("TD","waffle-dv-label",
a.Ca("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Ca("TD",{colspan:"7"});this.C=nGf(this,c);LGf(this);b.appendChild(c);a.appendChild(this.ma.childNodes[0],b);(a=this.C.nt())&&Uu(a,"labelledby","waffle-dv-cell-range");this.F=new eGf(this,this.xb,this.R);Zx(this,"save");MGf(this)}A(JGf,bz);var KGf={zAa:"waffle-dv-recs-title"};p=JGf.prototype;p.un=0;function LGf(a){if(a.C){var b=a.xb.getActiveGrid();b&&(b=mM(tJ(a.$a).Nc(),b.Be(),!0),a.C.setValue(b))}}
function MGf(a){a.fc.listen(a,"dialogselect",a.PTb).listen(a.F,"error",a.sxb).listen(a.F,"change",a.OTb).listen(a.C,"change",function(){a.F&&yGf(a.F);if(a.Aa){var b=BGf(a);a.Hb||a.O&&b&&b.intersects(GX(a.R,a.Za))||NGf(a)}});a.Aa&&a.fc.listen(a.Ua,"recommender-calc-ended",a.NTb).listen(a.Tb,"action",function(){(Es(),Ar).Kb({source:"dataValidationDialogFeedback"})})}p.sxb=function(){OGf(this)};p.OTb=function(){OGf(this);Vx(this.L,"save",!0)};
function PGf(a){var b=a.qa();a=a.V.Na();var c=Iw(cGf);b.appendChild(a,c)}
p.NTb=function(a){var b=this;this.xe.setActive(!1);Q(this.Va.Na(),!1);a=a.C;if(0==a.length)PGf(this);else for(var c=this.qa(),d=this.V.Na(),e=0,f={gR:0};f.gR<a.length;f={WL:f.WL,OD:f.OD,hY:f.hY,gR:f.gR,j6:f.j6,LD:f.LD},f.gR++){var h=a[f.gR],k=H(h,13);if(3<=e||!k)break;e++;f.j6=YI(h);f.hY=mM(Uk(f.j6));f.OD=H(k,3);this.Ec.push(f.OD);this.wc.push(f.hY);h="";switch(of(f.OD)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+pf(f.OD).map(function(l){return H(l.Bq().getValue(),
2)}).join();break;case 1:h="Greater than "+H(pf(f.OD)[0].Bq().getValue(),3);break;case 7:h=pf(f.OD);h="Between "+(H(h[0].Bq().getValue(),3)+(" and "+H(h[1].Bq().getValue(),3)));break;case 5:h=pf(f.OD),h="Equal to "+H(h[0].Bq().getValue(),3)}k=KGf;f.LD=Iw(bGf,{description:h,m3b:f.hY});f.WL=new zx("",c);f.WL.nf(8,!0);f.WL.Xa(f.LD);Uu(f.LD,"describedby",k.zAa);this.V.Ia(f.WL);c.appendChild(d,f.LD);this.Rc.listen(f.WL,"action",function(l){return function(){QGf(b,l.WL,l.OD,l.hY,l.gR)}}(f)).listen(f.LD,
"mouseenter",function(l){return function(){LX(b.gc,Tk(l.j6))}}(f)).listen(f.LD,"mouseleave",function(){HO(b.gc)}).listen(f.LD,"focus",function(l){return function(){ou(l.LD,d)}}(f))}};
function QGf(a,b,c,d,e){var f=cv(b.Na(),"waffle-dv-rec-chip-selected");a.V.hf(function(h){h.Vj("waffle-dv-rec-chip-selected",!1);h.kc(!1)});b.Vj("waffle-dv-rec-chip-selected",!f);b.kc(!f);a.Hb=!0;f?(a.show(!0),a.O=null,a.Za=null,a.Eb=-1):(b=new qf,I(b,1,c),IGf(a.F,b,null,null,!0),zGf(a.F),a.C.setValue(d),a.O=c,a.Za=d,a.Eb=e);a.Hb=!1}p.PTb=function(a){if("save"==a.key){if(!RGf(this)){a.preventDefault();return}}else if("clear"==a.key&&!SGf(this)){a.preventDefault();return}this.C&&this.C.Pa(!1)};
function OGf(a){var b=TGf(a.un);b&&a.J.setContent(b);a.J.setVisible(0!=a.un);b=2==a.un||4==a.un;var c=a.qa().Ox(a.C.getElement());hv(c,"waffle-input-error",b);b&&a.C.nt().select()}
function TGf(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid ticked value.";case 9:return"Enter different values for ticked and unticked cell contents.";case 10:return"Formulas are not permitted as custom ticked/unticked values."}return null}
function UGf(a){var b=a.F,c=S4(b);if(0==c){c=b.L;var d=b.ma,e=AGf(b,c),f=AGf(b,d);e&&f?b.D.un=0:(e||R4(c),f||R4(d),b.D.un=1)}else if(1==c)c=b.O,d=b.Aa,e=!xu(c)||!td(ee(c.value)),f=!xu(d)||!td(ee(d.value)),e&&f?b.D.un=0:(e||R4(c),f||R4(d),b.D.un=6);else if(2==c)c=b.H,d=b.R,e=!xu(c)||!td(ee(c.value)),f=!xu(d)||!td(ee(d.value)),e&&f?b.D.un=0:(e||R4(c),f||R4(d),b.D.un=7);else if(3==c||4==c)c=0,4==S4(b)?(d=GGf(b),One(b.Tb,d)?(d=GGf(b),d=GX(b.Tb,d),e=BGf(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==S4(b)&&b.C.getElement()&&td(ee(b.C.getValue()))&&(c=5),d=c,c=0==d,b.D.un=d,d=b.Za&&xu(b.Za),b.Va&&xu(b.Va)?(hv(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.qa().Ox(b.Ka.getElement()),hv(d,"waffle-input-error",!c),b.Ka.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Qa.isChecked()){c=b.Oa;e=b.Ta;d=ud(ee(c.value));e=ud(ee(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==
e.toLowerCase();var h=ke(d)==ke(e);f=d==e||h||f;td(d)?(R4(c),b.D.un=8):f?b.D.un=9:pD(d)||pD(e)?b.D.un=10:b.D.un=0}}else b.D.un=0;b=a.C.getValue();b=One(a.R,b);2==a.un&&b?a.un=0:0!=a.un||b||(a.un=2);OGf(a);return 0!=a.un}
function VGf(a){switch(a){case 1:return 35283;case 2:return 35284;case 3:return 35285;case 4:return 35286;case 5:return 35282;case 6:return 35291;case 7:return 35271;case 8:return 35289;case 9:return 35272;case 10:return 35290;case 13:return 35292;case 14:return 35293;case 15:return 35294;case 16:return 35277;case 17:return 35275;case 18:return 35274;case 19:return 35280;case 20:return 35279;case 21:return 35276;case 22:return 35278;case 30:return 35281;case 23:return 35287;case 24:return 35288;case 31:return 35358;
case 29:return 35273}return null}
function RGf(a){if(UGf(a))return!1;var b=a.F,c=b.fc.isChecked("rejectInvalidData_radio"),d=vGf(b);b.Ua.isChecked()||(d="");var e=FGf(b);if(!e)return!1;var f=new $n;I(f,1,e);I(f,2,d);I(f,3,c);mne(f,xu(b.gc)&&b.gb.isChecked());b=WGf(a);if(!b)return!1;d=new yh;e=rf(e);var h=a.O&&of(a.O)==of(e);c=pf(e);if(h){var k=XGf(a,rFf(a.R,a.Za)),l=YGf(a);k=Vk(k,b);O(d,12,!l||!k);var m=new $sd;O(m,1,!k);O(m,2,!l);O(m,3,a.Eb);gh(d,17,Zla[0],m)}else{for(var r=m=k=l=!1,t=!1,v=0;v<a.wc.length;v++){var w=XGf(a,rFf(a.R,
a.wc[v]));if(w){var z=Vk(w,b);w=Eua(w,b);var K=a.Ec[v],T=of(K)==of(e);K=pf(K);K=jd(K,c,function(aa,Z){return aa.equals(Z)});t=t||K;l=l||z&&T&&K;k=k||z;m=m||z&&T;r=r||w}}v=new btd;O(v,1,l);O(v,2,k);O(v,3,m);O(v,4,r);O(v,5,t);gh(d,18,Zla[0],v)}gne(d,wte(of(e)));l=ia(a.Ec);for(k=l.next();!k.done;k=l.next())pFf(d,wte(of(k.value)));l=Ia()-a.kd;O(d,14,l);l=new sh;fh(l,58,d);d=Av(Bv(new zv,l),1).build();a.Ka.C(h?35578:35301,d);h=VGf(of(e));null!=h&&a.Ka.C(h);31==of(e)&&a.Ka.C(0<c.length?35604:35603,d);a.cd.C(new Yte(f,
b));return!0}function YGf(a){var b=FGf(a.F);if(!b||!a.O)return!1;b=pf(rf(b));a=pf(a.O);return jd(a,b,function(c,d){return c.Bq().getValue().equals(d.Bq().getValue())})}
function SGf(a){var b=WGf(a);if(!b)return!1;try{if(!FGf(a.F))return a.Ka.C(35300),!0;var c=rf(FGf(a.F)),d=a.O&&of(a.O)==of(c),e=!1,f=new yh;if(d){var h=dSb(tJ(a.$a).Qp().Ic(),rFf(a.R,a.C.getValue()));oj(h,function(r){YH(r)&&(e=!0);return e});if(!e){var k=new btd;O(k,6,!0);gh(f,18,Zla[0],k)}}var l=new sh;fh(l,58,f);var m=Av(Bv(new zv,l),1).build();a.Ka.C(35300,m);return!0}finally{a.cd.C(new Yte(new $n,b))}}function WGf(a){var b=rFf(a.R,a.C.getValue());return XGf(a,b)}
function XGf(a,b){var c=a.C.getValue();a=(a=GX(a.R,c))?a.C:null;return b&&null!=a?Pk(b,a):null}function BGf(a){var b=a.C.getValue();return GX(a.R,b)}function nGf(a,b){var c=a.xb.C.Be();a=new GT(a.$a,y(a.MTb,a),!1,"e.g. Sheet1!A2:D5",!0,c,a.qa());a.render(b);return a}p.setVisible=function(a){JGf.Ba.setVisible.call(this,a);a&&this.gb&&(this.gb.focus(),this.gb=null)};p.MTb=function(a,b,c,d){this.gb=a.nt();this.le.uf(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=XK(this.xb),e=YH(QH(d,zI(d)));d=null;var f=!1;e&&(e=e.C,d=H(e,1),b=H(e,2),c=H(e,3),f=H(e,4));IGf(this.F,d,b,c,f);(b=FGf(this.F))&&rf(b);this.setVisible(!0);this.C&&this.C.Pa(!0);LGf(this);zGf(this.F);NGf(this,a);this.kd=Ia()};
function NGf(a,b){a.Aa&&!b&&(Mme(a.Ua)?(a.xe.setActive(!0),Q(a.Va.Na(),!0),a.V.yd(!0),a.Rc.Jc(),Yne(a.Ua),b=BGf(a),null==b||zk(b.rect)||b.rect.equals(a.zd)?toe(a.Ua,!0,!1,[6]):hoe(a.Ua,!0,!1,!1,[6],[BGf(a).rect])):(a.xe.setActive(!1),Q(a.Va.Na(),!1),PGf(a)))}p.La=function(){F(this.F);this.F=null;F(this.C);this.L=this.ma=this.C=null;F(this.J);JGf.Ba.La.call(this)};function U4(a,b){Sv.call(this,b,new ZGf(a))}A(U4,Sv);p=U4.prototype;p.Lf=function(a,b,c){U4.Ba.Lf.call(this,a,b,c);a.Ib()&&this.Ib()&&a.getParent()==this&&$Gf(this)};p.Ja=function(){U4.Ba.Ja.call(this);$Gf(this)};p.Hc=function(a){U4.Ba.Hc.call(this,a);$Gf(this)};p.removeChild=function(a,b){a=U4.Ba.removeChild.call(this,a,b);$Gf(this);return a};p.Sm=function(a,b){a=U4.Ba.Sm.call(this,a,b);$Gf(this);return a};
p.kf=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=xv(this);if(c){b=39==b;this.Ie()&&(b=!b);c=c.getElement();c=Fc(c.parentNode.childNodes,c);var d=(d=(d=xv(this))?wZa(d.getElement(),aHf):null)?Fc(d.parentNode.childNodes,d):-1;var e=d==(this.getElement()?this.getElement().childNodes.length:0)-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=bHf(this,e);b?b=bHf(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.Gfa(this.Dt()+b);b=!0}else b=!1}b=!b}return b?
U4.Ba.kf.call(this,a):!0};function bHf(a,b){return 0==(a.getElement()?a.getElement().childNodes.length:0)?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function $Gf(a){var b,c=a.Kd(),d=a.Sc(),e=bd(Ls("div",aHf,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.qa().Ca("DIV",aHf),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.Sc();k++)a.Qc(k)instanceof Rv?(d.push(new cHf(b,k,!0)),b=k+1):a.Qc(k)instanceof Lv&&(0==k?h=!0:(a.Qc(k-1),d.push(new cHf(b,k-1,!1)),b=k));k=a.Sc();0<d.length&&Dc(d).end!=k-1&&d.push(new cHf(b,k-1,!1));b=h;h=a.Sc();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.Sc()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else dHf(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.Sc();f++){for(;f>c[d];)++d;b=a.Qc(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Rv?Q(h,!1):Q(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function dHf(a,b,c){function d(r){return r.end-r.start-(r.wKb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Yc(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Yc(a,l,1))}}function cHf(a,b,c){this.start=a;this.end=b;this.wKb=c}function ZGf(a){Qv.call(this);this.D=a}A(ZGf,Qv);var aHf="docs-multi-menu-col";function eHf(a){E.call(this);this.C=a}A(eHf,E);eHf.prototype.create=function(){return new U4(this.C)};function fHf(a,b){M4.call(this,a);this.ma=new R;this.H=new gHf;this.F=new R;a=(new eHf(3)).create();a.Ia(new Lv("Date"),!0);a.Ia(new Nv("Day","DAY_TOKEN"),!0);a.Ia(new Nv("Month","MONTH_TOKEN"),!0);a.Ia(new Nv("Year","YEAR_TOKEN"),!0);a.Ia(new Lv("Time:"),!0);a.Ia(new Nv("Hours","HOURS_TOKEN"),!0);a.Ia(new Nv("Minutes","MINUTES_TOKEN"),!0);a.Ia(new Nv("Seconds","SECONDS_TOKEN"),!0);a.Ia(new Nv("Milliseconds","MILLIS_TOKEN"),!0);a.Ia(new Nv("a.m./p.m.","AM_PM_TOKEN"),!0);a.Ia(new Lv("Duration"),!0);
a.Ia(new Nv("Elapsed hours","ELAPSED_HOURS_TOKEN"),!0);a.Ia(new Nv("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ia(new Nv("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new Urc(a);this.C=b}A(fHf,M4);p=fHf.prototype;p.Ca=function(){var a=Iw(RFf,{a2:Hu(this,"nfd-icwr"),nM:Hu(this,"nfd-a")});this.Cb(a)};
p.Ja=function(){fHf.Ba.Ja.call(this);dv(this.getElement(),"nfd-date-time-input");var a=Ju(this,"nfd-icwr"),b=this.ma;b.Xa(a);b.Xd(this);b.Ia(this.L,!0);dv(this.L.getElement(),"nfd-date-time-menu-button");dv(this.L.dc().getElement(),"nfd-date-time-menu");Xu(this.L.Na(),"Add a date or time format");b.Ia(this.H,!0);D.Bd||dv(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ia(a,!0);gu(a.getElement(),"display","inline");this.getHandler().listen(this,"Eh",Ga(this.p0a,"left")).listen(this,"Ih",
Ga(this.NMa,"left")).listen(this,"Jh",Ga(this.NMa,"right")).listen(this,"Kh",Ga(this.HNa,"left")).listen(this,"Lh",Ga(this.HNa,"right")).listen(this,"Hh",Ga(this.p0a,"right")).listen(this.L,"action",this.psb)};p.XGa=function(){this.ma.getElement().focus()};
p.yQ=function(a){this.Sb(a.clone());var b=this.F;b.yd(!0);gt(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Bn());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?gt(this.H.getElement(),d[2]):(e=b.Qc(b.Sc()-1),d=d[2],gt(e.gD.getElement(),jt(e.gD.getElement())+d)):hHf(this,e).setValue(d[1])}0<b.Sc()&&b.Qc(b.Sc()-1).gB.getElement().focus()};
p.getValue=function(){for(var a=this.H.toString(),b=0;b<this.F.Sc();b++)a+=this.F.Qc(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Rea(e,"["),e=Rea(e,"]")):c=!0}b+=e}return b};p.psb=function(a){a=a.target.getValue();hHf(this,a).gB.getElement().focus()};
function hHf(a,b){IFf(a,!1);switch(b){case "DAY_TOKEN":var c=iHf(a);break;case "MONTH_TOKEN":c=jHf(a);break;case "YEAR_TOKEN":c=kHf(a);break;case "HOURS_TOKEN":c=lHf();break;case "MINUTES_TOKEN":c=mHf();break;case "SECONDS_TOKEN":c=nHf();break;case "MILLIS_TOKEN":c=oHf();break;case "AM_PM_TOKEN":c=pHf(a);break;case "ELAPSED_HOURS_TOKEN":c=qHf();break;case "ELAPSED_MINUTES_TOKEN":c=rHf();break;case "ELAPSED_SECONDS_TOKEN":c=sHf()}b=c;b.Ia(new Rv,!0);b.Ia(new Nv("Delete"),!0);c=new tHf(c,"");a.F.Ia(c,
!0);return c}p.p0a=function(a,b){b=b.target;if(b instanceof gHf){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Qc(Ku(this.F,b)+1),!b))return}a=jt(b.gD.getElement());var c=b.getParent(),d=Ku(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=jt(b),gt(b,c+a),uHf(this.H,c.length)):(d--,b=c.Qc(d),c=jt(b.gD.getElement()),gt(b.gD.getElement(),jt(b.gD.getElement())+a),uHf(b.gD,c.length))};
p.HNa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Qc(Ku(this.F,b)+a))&&a.gB.getElement().focus()};p.NMa=function(a,b){var c="left"==a?-1:0;(b=this.F.Qc(Ku(this.F,b.target)+c))||"left"!=a?b&&(b=b.gD):b=this.H;c=jt(b.getElement()).length;uHf(b,"left"==a?c:0)};function tHf(a,b){R.call(this);this.gB=new OP("",a);this.Ia(this.gB,!0);this.gD=new gHf(b);this.Ia(this.gD,!0)}A(tHf,R);p=tHf.prototype;
p.Ja=function(){tHf.Ba.Ja.call(this);dv(this.getElement(),"nfd-date-time-pill");gu(this.getElement(),"display","inline-block");this.gB.Xe(0);this.$d=new Zu(this.gB.getElement());this.va(this.$d);this.getHandler().listen(this.gB,"action",this.bbc).listen(this.$d,"key",this.cbc)};p.bbc=function(){this.gB.cR();this.gB.yf().Ra()||this.dispatchEvent("Hh")};
p.cbc=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Hh"));break;case 37:a.preventDefault();this.dispatchEvent("Ih");break;case 39:a.preventDefault(),this.dispatchEvent("Jh")}};p.toString=function(){return this.gB.yf().Ra()+this.gD.toString()};p.setValue=function(a){this.gB.setValue(a)};function gHf(a){R.call(this);this.cf=a||""}A(gHf,R);p=gHf.prototype;
p.Ca=function(){var a=Rs("SPAN");Os(a,{contentEditable:!0});gt(a,this.cf);var b=a.style;D.Fb&&!D.Yc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=D.Bd?"-moz-pre-wrap":"pre-wrap";this.Cb(a)};p.Ja=function(){gHf.Ba.Ja.call(this);var a=new Zu(this.getElement());this.va(a);this.getHandler().listen(a,"key",this.dbc).listen(this.getElement(),"paste",this.ebc)};
function uHf(a,b){if(0==jt(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=EN(c,b);a.getElement().focus();b.select()}}
p.dbc=function(a){var b=it(this.getElement()),c=yN(),d=jt(this.getElement()).length,e=c?0==c.Gl()&&0==c.kp():td(ee(b));b=c?c.Gl()==d&&c.kp()==d:td(ee(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Eh"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Hh"));break;case 40:this.dispatchEvent("Fh");break;case 38:this.dispatchEvent("Gh");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("Kh"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Lh"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Dea(jt(this.getElement())).replace(/"/g,'"\\""');return 0==ee(a).length?"":'"'+a+'"'};p.ebc=function(){var a=y(function(){gt(this.getElement(),jt(this.getElement()))},this);Ql(a)};
function iHf(a){function b(f){return"Day ("+(f+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Day without leading zero ("+(e+")"),d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Day with leading zero ("+(e+")"),d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Day as abbreviation ("+(e+")"),d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,
e),"Day as full name ("+(e+")"),d));a=new Sv;for(d=0;d<c.length;d++)a.Ia(c[d],!0);return a}
function jHf(a){function b(f){return"Month ("+(f+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Month without leading zero ("+(e+")"),d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Month with leading zero ("+(e+")"),d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Month as abbreviation ("+(e+")"),d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,
e),"Month as full name ("+(e+")"),d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"First letter of the month ("+(e+")"),d));a=new Sv;for(d=0;d<c.length;d++)a.Ia(c[d],!0);return a}
function kHf(a){function b(f){return"Year ("+(f+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Two-digit year ("+(e+")"),d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Full numeric year ("+(e+")"),d));a=new Sv;for(d=0;d<c.length;d++)a.Ia(c[d],!0);return a}
function lHf(){function a(e){return"Hour ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Hour without leading zero ("+(c+")"),"h"));c="01";b.push(new O4(Ga(a,c),"Hour with leading zero ("+(c+")"),"hh"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function mHf(){function a(e){return"Minute ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Minute without leading zero ("+(c+")"),"m"));c="01";b.push(new O4(Ga(a,c),"Minute with leading zero ("+(c+")"),"mm"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function nHf(){function a(e){return"Second ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Second without leading zero ("+(c+")"),"s"));c="01";b.push(new O4(Ga(a,c),"Second with leading zero ("+(c+")"),"ss"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function oHf(){function a(e){return"Milliseconds ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Precision to 1/10 of a second ("+(c+")"),"0"));c="01";b.push(new O4(Ga(a,c),"Precision to 1/100 of a second ("+(c+")"),"00"));c="001";b.push(new O4(Ga(a,c),"Precision to 1/1000 of a second ("+(c+")"),"000"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function pHf(a){function b(f){return"a.m./p.m. ("+(f+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Full ("+(e+")"),d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Shortened lowercase ("+(e+")"),d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new O4(Ga(b,e),"Shortened uppercase ("+(e+")"),d));a=new Sv;for(d=0;d<c.length;d++)a.Ia(c[d],!0);return a}
function qHf(){function a(e){return"Elapsed hours ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Elapsed hours without leading zero ("+(c+")"),"[h]"));c="01";b.push(new O4(Ga(a,c),"Elapsed hours with leading zero ("+(c+")"),"[hh]"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function rHf(){function a(e){return"Elapsed minutes ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Elapsed minutes without leading zero ("+(c+")"),"[m]"));c="01";b.push(new O4(Ga(a,c),"Elapsed minutes with leading zero ("+(c+")"),"[mm]"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c}
function sHf(){function a(e){return"Elapsed seconds ("+(e+")")}var b=[],c="1";b.push(new O4(Ga(a,c),"Elapsed seconds without leading zero ("+(c+")"),"[s]"));c="01";b.push(new O4(Ga(a,c),"Elapsed seconds with leading zero ("+(c+")"),"[ss]"));c=new Sv;for(var d=0;d<b.length;d++)c.Ia(b[d],!0);return c};function vHf(a){N4.call(this,a);this.setTitle("Custom date and time formats")}A(vHf,N4);p=vHf.prototype;p.LYa=Vi;p.t0=n(11175.5628472222);p.isEmpty=function(){return td(Ue(this.A3(),2))};p.wf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Ue(this.A3(),2))};p.Eka=function(){return new fHf("Custom date time format",11175.5628472222)};p.A3=function(){return wHf(this.input.getValue())};
p.s$=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.t0(),c.Bn());c.D=d}b=xHf(this);ed(b);for(c=0;c<b.length;c++)a.push(new uV(wHf(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.t0(),b[c])));return a};
function xHf(a){var b=Mz,c=Jc(b.DATEFORMATS,function(h){return yHf(h)},a),d=Jc(b.TIMEFORMATS,function(h){return yHf(h)},a),e=c.concat(d);b=b.DATETIMEFORMATS;ed(b);a=Jc(b,function(h){return yHf(h)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function yHf(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return ud(a.join(""))}function wHf(a){var b=new Ye;b.setType(7);I(b,3,1);I(b,2,a);return b};function zHf(){var a='<div class="'+V("waffle-sdsd-source-container")+'"><div class="'+V("waffle-sdsd-rangepicker-container")+'"><div class="'+V("waffle-sdsd-rangepicker-label")+'">';a=a+"Data range"+('</div><div class="'+V("waffle-sdsd-range-selection")+'"></div><div style="display: none;" class="'+V("waffle-sdsd-rangepicker-error-label")+'"></div></div></div><div class="'+V("waffle-sdsd-destination-radio-container")+'"><div id="insertOptionHeader" class="'+V("waffle-sdsd-rangepicker-label")+'">');
a=a+"Insert to"+('</div><div class="'+V("waffle-sdsd-destination-selection")+'" role="radiogroup" aria-labelledby="insertOptionHeader"><div role="presentation"><label><input type="radio" name="destination" value="NEW_SHEET" checked="checked">');a=a+'New sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="EXISTING_SHEET">Existing sheet'+('</label></div></div></div><div style="display: none;" class="'+V("waffle-sdsd-destination-container")+'"><div class="'+
V("waffle-sdsd-rangepicker-container")+'"><div class="'+V("waffle-sdsd-range-selection")+'"></div><div style="display: none;" class="'+V("waffle-sdsd-rangepicker-error-label")+'"></div></div></div>');return U(a)};function AHf(a,b,c,d,e,f,h,k){AS.call(this,void 0,k,!0,C(B(),"docs-egmd"));this.ze=c;this.Aa=d;this.V=e;this.ma=h;this.R=new uwe;this.J=a;this.Ia(this.J);this.F=b;this.Ia(this.F);this.L=null;this.setTitle(f);Ox(this,!1)}x(AHf,AS);p=AHf.prototype;
p.Ca=function(){AS.prototype.Ca.call(this);dv(this.Na(),"waffle-source-destination-selection-dialog");var a=this.Ob(),b=this.qa(),c=Iw(zHf);b.appendChild(a,c);this.O.setContent("Create");c=b.Ha("waffle-sdsd-range-selection",BHf(this));CHf(this.J,c);c=b.Ha("waffle-sdsd-range-selection",DHf(this));CHf(this.F,c);vwe(this.R,"destination",a);b.Ha("waffle-sdsd-rangepicker-label",this.Ob()).id="waffle-sdsd-rangepicker-label-id"};
p.Ja=function(){AS.prototype.Ja.call(this);this.ma&&this.J.setValue(this.ma);this.getHandler().listen(this,"md",this.ZTb).listen(this.R,"Jd Kd Ld Md action select".split(" "),this.$Tb).listen(this.F,"change",this.uLa).listen(this.J,"change",this.GNa).listen(this.F,"activate",this.$La).listen(this.J,"activate",this.$La);wl(Kx(this),"click",this.V)};p.$La=function(a){this.L=a.target.Bda()};p.uLa=function(){EHf(this,DHf(this),this.F.X5("Please enter a valid destination."));this.F.focus()};
p.ZTb=function(){this.Aa();this.V()};p.GNa=function(){EHf(this,BHf(this),this.J.X5("Please enter a valid range."));this.J.focus()};function FHf(a){return"EXISTING_SHEET"===ywe(a.R)}function EHf(a,b,c){var d=!!c;a=a.qa().Ha("waffle-sdsd-rangepicker-error-label",b);Q(a,d);d&&(gt(a,c),jJ(c))}function BHf(a){return a.qa().Ha("waffle-sdsd-source-container",a.Ob())}function DHf(a){return a.qa().Ha("waffle-sdsd-destination-container",a.Ob())}
p.pJ=function(){FHf(this)&&this.uLa();this.GNa();if(!(this.J.X5("error")||FHf(this)&&this.F.X5("error"))){var a=this.J.Lna(),b=this.F.Lna();AS.prototype.pJ.call(this);this.ze(a,b?new fG(b.C,b.rect.top,b.rect.left):void 0);this.dispose();this.V()}};p.$Tb=function(){var a=FHf(this);Q(DHf(this),a);a&&(a=this.F.Bda())&&a.focus()};function CHf(a,b){a.render(b);(a=a.Bda())&&Uu(a,"labelledby","waffle-sdsd-rangepicker-label-id")}p.show=function(){this.setVisible(!0)};
p.setVisible=function(a){AS.prototype.setVisible.call(this,a);a&&this.L&&(this.L.focus(),this.L=null)};function GHf(a){R.apply(this,arguments)}x(GHf,R);function HHf(a,b,c,d,e){GHf.call(this,e);this.F=a;this.D=c;this.C=new GT(b,y(this.YTb,this),d,d?"e.g. Sheet1!F10":"eg. Sheet1!A1:D100",!0,void 0,this.qa(),$nd.getInstance());this.C.V=!1;this.Ia(this.C,!0)}x(HHf,GHf);p=HHf.prototype;p.Bda=function(){return this.C.nt()};p.getValue=function(){return this.C.getValue()};p.setValue=function(a){this.C.setValue(a)};
p.Lna=function(){return kM(this.getValue(),this.F.C,!1,!0)};p.X5=function(a){var b=this.getValue();if(!b)return a;b=J$b(b,this.F.C,!1,!0);return b instanceof Lk?null:"range-datasource-sheet"===b?"Range can't reference connected data sheets.":a};p.focus=function(){this.C.focus()};p.YTb=function(a,b,c,d){this.dispatchEvent("activate");c&&this.D.setTitle("What location?");var e=null;this.getParent()instanceof AS&&(e=this.getParent());this.D.uf(e,a,b,c,!1,!0,d)};function IHf(a,b,c){GHf.call(this,c);this.C=a;this.D=b}x(IHf,GHf);p=IHf.prototype;p.Ca=function(){GHf.prototype.Ca.call(this);this.Cb(this.qa().Ca("DIV",{style:"padding: 10px 0"},this.D))};p.Bda=function(){return this.getElement()};p.getValue=n("");p.setValue=ca();p.Lna=function(){return new Lk(this.C,null)};p.X5=n(null);p.focus=ca();function JHf(a,b,c,d,e){bz.call(this);this.Va=c;this.$a=d.C;this.Ua=d;this.gc=e;this.Za=null;this.Hb=d.Da;this.setTitle("Find and replace");Ox(this,!1);c=this.Ob();d=Gs(c);dv(this.Na(),"waffle-find-replace-dialog");this.C=d.Ca("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Ka=d.Ca("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new OP(null);this.va(this.F);this.Ec=b;this.R=new GT(this.Va,y(this.Tac,this),!1,"",!0);this.va(this.R);this.ma=null;this.O=(this.Aa=
C(B(),"docs-egmd"))?new LR(!1,MR.getInstance(),this.qa()):new NR;this.va(this.O);this.V=this.Aa?new LR(!1,MR.getInstance(),this.qa()):new NR;this.va(this.V);this.L=this.Aa?new LR(!1,MR.getInstance(),this.qa()):new NR;this.va(this.L);this.J=this.Aa?new LR(!1,MR.getInstance(),this.qa()):new NR;this.va(this.J);this.fc=this.xb=this.Eb=this.Tb=!1;this.gb=d.Ca("SPAN","waffle-find-replace-dialog-display-message");yqe(this.gb);this.wc=new gz(this.C);this.va(this.wc);d.Ca("LABEL",{"for":"waffle-find-replace-find-scope-select"},
"Search");a=d.Ca("LABEL",{"for":"find-replace-case","class":"waffle-findandreplacedialog-checkbox-label"},"Match case");b=d.Ca("LABEL",{"for":"find-replace-cell","class":"waffle-findandreplacedialog-checkbox-label"},"Match entire cell contents");e=d.Ca("LABEL",{"class":"waffle-findandreplacedialog-checkbox-label"},"Also search within formulae");var f=d.Ca("LABEL",{"for":"find-replace-regex","class":"waffle-findandreplacedialog-checkbox-label"},"Search using regular expressions "),h=d.Ca("SPAN",null,
d.Ca("A",{target:"_blank",href:"https://support.google.com/docs?p=spreadsheets_find_replace",style:this.Aa?"vertical-align: bottom;":"vertical-align: middle;"},"Help"));this.getHandler().listen(h,["keydown","keypress"],function(v){13==v.keyCode&&v.stopPropagation()});var k=Hu(this,"findLabel"),l=Hu(this,"replaceLabel"),m=Hu(this,"findScopeLabel"),r=d.Ca("DIV","goog-inline-block"),t=d.Ca("DIV","waffle-find-replace-selection-input goog-inline-block");h=d.Ca("TABLE",null,d.Ca("TBODY",null,d.Ca("TR",
null,d.Ca("TD","waffle-find-replace-dialog-label",d.Ca("LABEL",{id:k},"Find")),d.Ca("TD",null,this.C)),d.Ca("TR",null,d.Ca("TD","waffle-find-replace-dialog-label",d.Ca("LABEL",{id:l},"Replace with")),d.Ca("TD",null,this.Ka)),d.Ca("TR",null,d.Ca("TD",null,d.Ca("LABEL",{id:m},"Search")),d.Ca("TD",null,r,t)),d.Ca("TR",null,d.Ca("TD",null,""),d.Ca("TD",null,d.Ca("DIV","waffle-find-replace-option",a),d.Ca("DIV","waffle-find-replace-option",b),d.Ca("DIV","waffle-find-replace-option",f,h),d.Ca("DIV","waffle-find-replace-option",
e))),d.Ca("TR",null,d.Ca("TD",{colspan:"2"},this.gb))));this.F.render(r);dv(this.F.getElement(),"waffle-find-replace-find-scope-select");this.R.render(t);Gu(this.O,a);KR(this.O,a);dv(this.O.getElement(),"waffle-findandreplacedialog-checkbox");this.O.getElement().id="find-replace-case";Gu(this.V,b);KR(this.V,b);dv(this.V.getElement(),"waffle-findandreplacedialog-checkbox");this.V.getElement().id="find-replace-cell";Gu(this.L,f);KR(this.L,f);this.L.getElement().id="find-replace-regex";dv(this.L.getElement(),
"waffle-findandreplacedialog-checkbox");KR(this.J,e);Gu(this.J,e);dv(this.J.getElement(),"waffle-findandreplacedialog-checkbox");Uu(this.C,"labelledby",k);Uu(this.Ka,"labelledby",l);Uu(this.F.Na(),"labelledby",m);d.appendChild(c,h);c=new Px;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Sx(this,c);C(B(),"docs-egmd")?Zx(this,"done"):Zx(this,"");this.getHandler().listen(this,"dialogselect",this.Uac).listen(this.wc,"input",this.ara).listen(this.L,
"change",this.iFb).listen(this.F,"change",this.xvb).listen(this.R,"change",this.Vac).listen(this.J,"change",this.lFb);c=new hz;c.Xa(this.C);this.va(c);c=new hz;c.Xa(this.Ka);this.va(c);KHf(this);c=new Fx(this.getElement());this.va(c);this.getHandler().listen(c,"focusin",this.k0a).listen(this.getElement(),"mousedown",this.k0a)}A(JHf,bz);
function KHf(a){var b=tJ(a.Va),c=null,d=null;b&&(c=Hwc(b),d=QK(a.$a,c.C).Be());a.J.qc(a.Hb);var e=new Nv("All sheets",2),f=new Nv("This sheet",1),h=new Nv("Specific range",0);a.F.Tc(e);a.F.Tc(f);a.F.Tc(h);f=c?YK(a.$a,c.C):null;f=(f=c&&f?iI(f,c.rect.Ac(),c.rect.Cc()):null)?f.Rh():1;c&&c.rect.Rh()>f?sw(a.F,h):sw(a.F,e);b&&a.R.setValue(mM(c.rect,d))}function LHf(a){var b=a.F.yf().Ra(),c=TK(a.Va.D);return 0==b?kM(a.R.getValue(),a.$a,!1,!0):1!=b||null===c?null:new Lk(c,new sk(0,0,1,1))}p=JHf.prototype;
p.k0a=function(a){a.target==this.getElement()?this.focus():this.gc.Wb(2)};p.Vac=function(){MHf(this)};p.lFb=function(){var a=this.J.isChecked();YYd(this.Ua,a)};p.xvb=function(){MHf(this)};p.iFb=function(){this.L.isChecked()&&this.O.qc(!0);this.ara()};
p.Uac=function(a){if("findNext"==a.key)a.preventDefault(),this.Tb&&(V4(this,null),NHf(this,"findnext"));else if("replace"==a.key)a.preventDefault(),this.Eb&&(V4(this,null),NHf(this,"replace"));else if("replaceAll"==a.key&&(a.preventDefault(),this.fc)){a=y(function(){V4(this,null);NHf(this,"replaceall")},this);var b=this.F.yf().Ra();1<this.$a.D.length&&2==b&&!this.xb?(Bme("Replace on all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.xb=!0):a()}};
p.ara=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Tx(this.D,"findNext").disabled=!a;this.Tb=a;OHf(this,a);this.Eb&&!a&&PHf(this,!1);hv(this.C,"waffle-input-error",b)};p.Tac=function(a,b,c){this.Za=a.nt();this.Ec.uf(this,a,b,c,!1,!0)};
function MHf(a){var b=0==a.F.yf().Ra();a.R.setVisible(b);F(a.ma);a.ma=null;var c=LHf(a),d=tJ(a.Va);b&&d&&c&&(a.ma=IO(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.ma.setVisible(!0),a.va(a.ma))}function NHf(a,b){if(!a.isDisposed())if(0==a.F.yf().Ra()&&null==LHf(a))hv(a.R.F,"waffle-range-selection-error",!0),V4(a,"Invalid range");else{var c=a.F.yf().Ra();a.dispatchEvent(new QHf(b,a.C.value,a.Ka.value,c,a.O.isChecked(),a.V.isChecked(),a.L.isChecked(),a.J.isChecked(),LHf(a)))}}
p.setVisible=function(a){var b=this.Ua.Od();OHf(this,!b);PHf(this,!b);this.Ka.disabled=b;JHf.Ba.setVisible.call(this,a);a&&this.Za&&(this.Za.focus(),this.Za=null)};p.f6b=function(a){this.C.value=a};p.qXa=function(){this.C.select()};p.focus=function(){this.Ib()&&this.isVisible()&&(this.C.focus(),this.gc.Wb(2),Iy(this.C,this.C.value.length),this.ara())};function PHf(a,b,c){b=b&&!a.Ua.Od()&&0==!a.C.value.length;a.Eb=b;a=Tx(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function OHf(a,b){b=b&&!a.Ua.Od()&&0==!a.C.value.length;a.fc=b;Tx(a.D,"replaceAll").disabled=!b}function V4(a,b){var c=Gs(a.Ob());a=a.gb;b?(0<at(a).length&&c.appendChild(a,c.Ca("BR")),c.appendChild(a,c.Ca("B",null,qt(c,b)))):c.yd(a)}p.La=function(){JHf.Ba.La.call(this);this.xb=!1;YYd(this.Ua,this.Hb)};function QHf(a,b,c,d,e,f,h,k,l){ql.call(this,a);this.D=b;this.F=c;this.C=d;this.R=e;this.V=f;this.ma=h;this.Aa=k;this.Ka=l||null}A(QHf,ql);function RHf(a,b,c,d,e){E.call(this);this.H=null;this.C=a;this.D=b;this.J=c;this.O=d;this.F=e;this.L=new Tl(this);this.va(this.L);this.L.listen(a,"replaceall",this.mEb).listen(a,"replace",this.nEb).listen(a,"findnext",this.j0a).listen(a,"done",this.ttb)}A(RHf,E);p=RHf.prototype;p.p8b=function(){this.C.setVisible(!0);SHf(this,null)};p.j0a=function(a){if(AJ(this.D)){var b=tJ(this.D).Ra(),c=this.H;if(!c){c=zI(b);var d={};c=(d.cg=b.yc(),d.cr=b.r0(c.y),d.cc=b.LE(c.x),d)}THf(this,a,b,c)}};
function THf(a,b,c,d){var e=new Hi,f=UHf(b);VHf(f,c,d);a.F.fc.dispatchEvent(null);c=e.serialize(f);d=y(function(h){var k=e.Wc(HCb.xa(),h);h=H(f,1);var l=b.type;if(AJ(this.D))if(k)if(Pe(k,1)){l=H(k,1);var m={};k=(m.cg=l.Db(),m.cr=l.Km(),m.cc=l.getColumnIndex(),m.loop=H(k,2),m);WHf(this,h,k)}else WHf(this,h,{}),"replace"==l&&this.C.focus();else XHf(this)},a);ritz_api.RitzModelApi.findNext(c,d);I(f,14,1);a.F.Hb.dispatchEvent(new wFf("find-next-occurrence",f))}
function VHf(a,b,c){if(c){var d=c.cg,e=new gg;I(e,1,d);I(e,2,qFf(b,c.cr,"r"));I(e,3,qFf(b,c.cc,"c"));I(a,10,e)}}function UHf(a){var b=new VE;I(b,1,a.D);I(b,3,a.F);I(b,5,a.C);if(0==a.C||1==a.C){var c=a.Ka,d=new gf;I(d,1,c.C);var e=c.rect.Ac();I(d,2,e);hha(d,c.rect.Xc());hf(d,c.rect.Cc());iha(d,c.rect.hd());b.setSelection(d)}I(b,6,a.R||!1);I(b,7,a.V||!1);I(b,8,a.ma||!1);b.setType(a.Aa?1:0);I(b,11,0);return b}
function WHf(a,b,c){c?c&&null!=c.cg?(b=c.cg,c.loop&&V4(a.C,"No more results found, looping around"),a.J.ED(b,y(a.Sac,a,c))):(SHf(a,null),V4(a.C,"There are no entries matching "+b)):XHf(a)}p.Sac=function(a){var b=tJ(this.D).Ra(),c=a.cr,d=a.cc;a.cr=b.r0(c);a.cc=b.LE(d);SHf(this,a);a=new ak(d,c);b=new Lk(b.yc(),uk(a));DX(this.J,b,y(this.I5a,this,a))};
p.I5a=function(a){if(!this.isDisposed()){this.C.focus();var b=tJ(this.D).Ra();VH(b.Bh(a.y,a.x))&&!this.C.J.isChecked()&&PHf(this.C,!1,"Can't replace formula");var c=b.Gt(a.y),d=b.OB(a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=lM(a),a=WH(QH(b,a)),V4(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function XHf(a){V4(a.C,null);V4(a.C,"Error while searching spreadsheet. Please try again.")}
p.nEb=function(a){if(!this.F.Od()){var b=this.H;if(b){var c=NH(this.J,b.cg);if(c){var d=c.Ic(),e=qFf(d,b.cr,"r"),f=qFf(d,b.cc,"c");c=d.Bh(e,f);if(!VH(c)||this.C.J.isChecked()){c=WH(c);var h=new Hi,k=UHf(a);I(k,5,0);VHf(k,d,b);d=new gf;I(d,1,b.cg);I(d,2,e);hha(d,e+1);hf(d,f);iha(d,f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);YHf(this,k,c,b,!1);this.F.Hb.dispatchEvent(new wFf("replace-current-occurrence",k));this.j0a(a)}}}}};
p.mEb=function(a){if(!this.F.Od()&&AJ(this.D)){var b=UHf(a);YHf(this,b,a.D,a.F,!0)}};
function YHf(a,b,c,d,e){b=new zwe(b);mJ(b,y(function(f,h){f?(f=H(h,5),h=H(h,4),h=0==f?"No matches found":e?(new Dy(1==h?"{NUM_CHANGED,plural, =0{unused plural form}=1{Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other{Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS,plural, =0{unused plural form}=1{unused plural form}other{Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:f,NUM_SHEETS:h,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),V4(this.C,null),V4(this.C,h)):XHf(this)},a));V4(a.C,null);V4(a.C,"Working...");a.O.C(b)}p.ttb=function(){SHf(this,null)};function SHf(a,b){a.H=b;(a=a.C)&&PHf(a,null!=b)};function ZHf(a,b,c){AS.call(this);this.setTitle("Grouping rule");this.V=a;this.Aa=b;this.ma=c;this.R=new R;this.Ia(this.R,!0);this.F=new $Hf("Minimum value","e.g. 0",!0);this.R.Ia(this.F,!0);this.L=new $Hf("Maximum value","e.g. 100",!0);this.R.Ia(this.L,!0);this.J=new $Hf("Interval size","e.g. 10",!1);this.Ia(this.J,!0);(a=this.V.C.getActiveGrid())&&(a=LI(a.Ic()))&&(a=aIf(this,a))&&a.Gq()&&Pe(Ff(a),3)&&(a=H(Ff(a),3),Pe(a,1)&&(b=H(a,1),this.F.D.setValue(kZ.format(b))),Pe(a,2)&&(b=H(a,2),this.J.D.setValue(kZ.format(b))),
Pe(a,3)&&(a=H(a,3),this.L.D.setValue(kZ.format(a))))}x(ZHf,AS);
ZHf.prototype.pJ=function(){var a=bIf(this.F),b=bIf(this.J),c=bIf(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(cIf(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(cIf(this.F,"Value too large"),d=!1):d=!0;if(d){d=new Gf;d.setType(2);var e=new Cia;null!=a&&I(e,1,a);null!=b&&I(e,2,b);null!=c&&I(e,3,c);I(d,3,e);if(a=this.V.C.getActiveGrid())if(a=a.Ic(),b=LI(a))if(c=aIf(this,b))I(c,10,d),this.Aa.C(new jS(b,a)),jJ("Pivot table headings grouped.");AS.prototype.pJ.call(this)}};
function aIf(a,b){b=mQb(b,function(c){return H(c,1)==a.ma});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return b[0].Gq()?b[0]:b[1]}function $Hf(a,b,c,d){R.call(this,d);this.L=a;this.O=b;this.R=c;this.J=new R;this.Ia(this.J,!0);this.D=new lY;this.Ia(this.D,!0);this.H=null;this.C=new R;this.Ia(this.C,!0);this.F=new CU(this.qa(),!0,!0);this.va(this.F)}x($Hf,R);
$Hf.prototype.Ja=function(){R.prototype.Ja.call(this);this.Na().className="waffle-pivot-histogram-errorable-input";this.J.Na().className="waffle-pivot-histogram-dialog-caption";this.qa().He(this.J.getElement(),this.L);this.H=this.D.Kd().wP(this.D.Na());this.H.placeholder=this.O;Xu(this.H,this.L+" - "+this.O);FU(this.F,this.H);this.C.Na().className="waffle-pivot-histogram-dialog-error";Tu(this.C.Na(),"alert");Uu(this.C.Na(),"live","polite");dIf(this)};
function bIf(a){dIf(a);var b=a.D.getValue();if(td(b)){if(a.R)return null;cIf(a,"Required");return NaN}b=kZ.parse(b);isNaN(b)&&cIf(a,"Must be a number");return b}function cIf(a,b){a.C.Na().style.visibility="";a.qa().He(a.C.Na(),b);DU(a.F,b,!1)}function dIf(a){a.C.Na().style.visibility="hidden";EU(a.F)};function eIf(a,b){this.D=a;this.C=b}eIf.prototype.getUrl=g("D");eIf.prototype.getTitle=g("C");function fIf(a,b,c,d,e,f){Zab.call(this,a,b,"domain",d,e,f);this.F=c}A(fIf,Zab);fIf.prototype.eZ=function(){var a=fIf.Ba.eZ.call(this);a.domainName=this.F;return Bd(a,c5a)};abb.set("domain",function(a){return new fIf(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new fIf("","DEFAULT","",!0);function gIf(){};function W4(a,b,c,d){this.yfa=a;this.D=b;this.C=c;this.pLb=d;this.F=hIf++}var hIf=0;W4.prototype.Ui=g("F");W4.prototype.getName=g("D");W4.prototype.getLabel=g("C");function iIf(a){var b=a.P5b,c="";a=a.IXa;for(var d=a.length,e=0;e<d;e++){var f=a[e],h=b[f.Ui()],k=f.getLabel();f=f.pLb;f=U('<div id="'+V(h)+'" tabindex="0" role="link" class="'+V("ess-button")+'" aria-label="'+V(k)+'"><div class="'+V("ess-icon")+" "+V(f)+'"></div></div>');c+=f}return U(c)};function jIf(a,b){R.call(this,b);this.D=a||[];this.F=[];this.C=null}A(jIf,R);p=jIf.prototype;p.Vd=!0;p.Nia=!1;p.HS=null;p.YEa=!1;p.Pa=function(a,b){this.Vd=a;this.Nia=b;if(this.YEa){b=this.qa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.HS.qwa+"-"+d.Ui()),f=a;hv(e,"ess-button",f);hv(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();hw(e,f,d)}}};
p.Ca=function(){this.Cb(this.cb.createElement("SPAN"));var a={};a.qwa=Hu(this,"service");a.IXa=this.D;this.HS=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.Ui()]=this.HS.qwa+"-"+d.Ui();a.P5b=b;this.HS=a;Gw(this.getElement(),iIf,this.HS);this.YEa=!0};
p.f3b=function(a){if(this.Vd){if(this.C){var b={};b.externalSharingService=a.yfa;this.C.C(9,b)}if(this.Nia)this.dispatchEvent(new kIf(new lIf(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.yfa;c.C(10,d)}a={aGd:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Lu(b,a))&&a.focus()}}};
p.Ja=function(){this.Pa(this.Vd,this.Nia);for(var a=this.qa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.HS.qwa+"-"+d.Ui());b.og(e,xl,y(this.f3b,this,d))}};p.La=function(){jIf.Ba.La.call(this);delete this.F;delete this.D;this.C=null};function kIf(a,b){ql.call(this,"Mh",b);this.context=a}A(kIf,ql);function lIf(){}A(lIf,gIf);function mIf(){W4.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}A(mIf,W4);mIf.prototype.getUrl=function(a){var b=Jc(a,function(c){return c.getTitle()});a=Jc(a,function(c){return c.getUrl()});return"http://www.facebook.com/share.php?u="+Xd(a.join(","))+"&t="+Xd(b.join(","))};function nIf(){W4.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}A(nIf,W4);nIf.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Xd(a[0].getUrl())};function oIf(){W4.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}A(oIf,W4);oIf.prototype.getUrl=function(a){a=Jc(a,function(b){return b.getTitle()+" - "+b.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Xd(a.join("\n"))};function pIf(){W4.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}A(pIf,W4);pIf.prototype.getUrl=function(a){for(var b=sa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Xd(a)};function qIf(a){R.call(this,a)}A(qIf,R);function rIf(a){a.dispatchEvent(new ql("Nh"))}qIf.prototype.v0=function(){return{}};qIf.prototype.dO=Xi;qIf.prototype.jwa=va;function sIf(a){R.call(this,a)}A(sIf,R);sIf.prototype.F=Xi;sIf.prototype.H=va;sIf.prototype.J=va;function tIf(a,b,c){b=c||b;c=a.d3b;var d=a.e3b,e=a.WEa,f=a.lgb,h=a.o1b,k='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';a="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+vFf(a.locale)+'&answer=183965">Learn more</a>');
k=k+a+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';k+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';k+="Embed";k+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
V(e)+'" readonly="readonly" aria-label="';k+=Ww("Link to published document.");k+=" "+V(h)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';k+="Or share this link using:";k+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';
k+=Ww("HTML embed code of published document.");k+=" "+V(h)+'">'+a4a(f)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+S(yx({id:"pub-dialog-publish-link-button",style:2,value:d},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+S(iz({Sn:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));k+="Published content and settings";k+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
S(yx({id:"pub-dialog-publish-button",value:c},b))+'<div class="pub-dialog-checkbox-container"></div></div></div></div></div>';return U(k)};function X4(a,b,c,d,e,f,h,k,l,m){bz.call(this);this.$a=a||"";this.le=b;this.kd=c;this.cd=d;this.Rc=l||"/publishsettings";this.C=new uIf(e);this.Hb=new jIf([new nIf,new oIf,new mIf,new pIf]);this.Ia(this.Hb);this.gb=C(B(),"docs-egmd");this.Aa=new zx(null,this.qa());this.Ia(this.Aa);this.ma=new zx(null,this.qa());this.Ia(this.ma);this.L=this.gb?new IV(void 0,HV.getInstance(),this.qa()):new NR(void 0,this.qa());this.Ia(this.L);this.O=this.gb?new IV(void 0,HV.getInstance(),this.qa()):new NR(void 0,this.qa());
this.Ia(this.O);this.Va=0;this.gc=new vIf;this.Ia(this.gc);this.Eb=this.Tb=null;this.J=f||new qIf;this.Ia(this.J);this.F=h||new qIf;this.Ia(this.F);this.Ua=k||new sIf;this.Ia(this.Ua);this.V=this.R=null;this.Ka=new qz(void 0,wIf,this.qa(),2);this.va(this.Ka);this.xb=this.zd=null;this.Qe=m||new R;this.wc=this.Za=this.fc=null;this.$i=!0}A(X4,bz);var wIf="Press "+((D.Bf?"\u2318+C":"Ctrl+C")+" to copy.");p=X4.prototype;p.jd=function(){X4.Ba.jd.call(this);this.Ka.jd()};
p.show=function(){xIf(this,y(function(){this.setVisible(!0)},this))};p.setVisible=function(a){X4.Ba.setVisible.call(this,a);var b=pt(this.qa());a?this.getHandler().listen(b,"resize",this.jd):this.getHandler().Kc(b,"resize",this.jd)};
p.Ca=function(){X4.Ba.Ca.call(this);var a=this.qa(),b=Iw(tIf,{d3b:yIf(this),e3b:zIf(this,AIf(this))?"Published":"Publish",WEa:this.C.zl?BIf(this,this.J.v0()):"",lgb:this.C.zl?CIf(this,this.F.v0()):"",locale:"en-GB",o1b:wIf});a.appendChild(this.Ob(),b);this.setTitle("Publish to the web");Sx(this,null);dv(this.Ob(),"pub-dialog-content")};function DIf(a){return"Require viewers to sign in with their "+(a.C.F+" account")}
p.Ja=function(){var a=this.qa(),b=a.getElement("pub-dialog-sharing-services-links");this.Hb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.fc=a.getElement("pub-dialog-links-notice");this.Qe.render(this.fc);b=a.getElement("pub-dialog-published-content");this.Ua.render(b);X4.Ba.Ja.call(this);b=this.getHandler();var c=this.Ha("pub-dialog-checkbox-container");if(this.C.domain){this.L.re("pub-dialog-dom-signin-req");
this.L.render(c);this.L.qc(this.C.By);if(this.gb)this.L.setContent(DIf(this));else{var d=Rs("LABEL",void 0,DIf(this));Ws(c,d);KR(this.L,d);Ws(c,Ts("BR"))}b.listen(this.L,"change",this.C9b)}this.C.C&&(this.O.re("pub-dialog-auto-publish-checkbox"),this.O.render(c),this.gb?this.O.setContent("Automatically republish when changes are made"):(d=Rs("LABEL",void 0,"Automatically republish when changes are made"),Ws(c,d),KR(this.O,d)),b.listen(this.O,"change",this.y9b));this.Tb=a.getElement("pub-dialog-link-tab-content");
this.R=a.getElement("pub-dialog-document-link");this.Eb=a.getElement("pub-dialog-embed-tab-content");this.V=a.getElement("pub-dialog-embed-code");pz(this.Ka,this.R);this.gc.Xa(a.getElement("pub-dialog-links-tab-bar"));this.zd=a.getElement("pub-dialog-sharing-services");this.xb=a.getElement("pub-dialog-status-info");this.Aa.Xa(a.getElement("pub-dialog-publish-link-button"));this.ma.Xa(a.getElement("pub-dialog-publish-button"));this.wc=new kN("pub-dialog-settings-header","pub-dialog-settings-content",
this.C.zl);this.va(this.wc);b.listen(this.gc,"select",this.qFb).listen(this.R,"focus",this.tXa).listen(this.V,"focus",this.tXa).listen(this.ma,"action",this.g3b).listen(this.getElement(),"keyup",this.Qab).listen(this.J,"Nh",this.lya).listen(this.F,"Nh",this.lya).listen(this.Aa,"action",this.lDb).listen(this.Ua,"Oh",this.mDb).listen(this.wc,"toggle",this.jd);EIf(this)};
function EIf(a){if(a.Ib()){var b=a.qa(),c=a.C.zl,d=a.C.D;a.Ua.H(a.C.To);a.L.Pa(!d);a.ma.setContent(yIf(a));a.ma.Pa(a.C.zl||!a.C.To||!a.C.To.isEmpty());a.C.C&&a.O.qc(a.C.Yy);a.lya();b=b.Ti("pub-dialog-state-publishing");Gc(b,function(e){Q(e,c)});gt(a.xb,a.C.zl?"This document is published to the web.":"This document is not published to the web.");a.C.zl?dv(a.xb,"pub-dialog-state-published"):fv(a.xb,"pub-dialog-state-published");a.jd()}}p.Qab=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function FIf(a,b){var c=window.location.href,d=uj(c);c=xj(c);var e=vd(c,"/"+a.cd+"/")?"/"+a.cd:"";a.C.By&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.H||a.$a;b=JFa.test(b)?b:Wsa("/d/"+a,b);return Hsa(c,f,h,d,Wsa(e,b))}
p.lya=function(){var a=this.J.dO();if(a=zIf(this,a)){var b=this.C.zl?BIf(this,this.J.v0()):"";this.R.value=b;this.Hb.F=[new eIf(b,this.le)]}Q(this.R,a);Q(this.zd,a&&!this.C.D);a=this.F.dO();if(a=zIf(this,a))this.V.value=this.C.zl?CIf(this,this.F.v0()):"";Q(this.V,a);a=zIf(this,AIf(this));Q(this.fc,a);this.Aa.Pa(!a);this.Aa.setContent(zIf(this,AIf(this))?"Published":"Publish")};
p.qFb=function(a){a=a.target;this.qa();Kab(this.Ka);"pub-dialog-link-tab"==a.getId()?(this.Va=0,Q(this.Tb,!0),Q(this.Eb,!1),pz(this.Ka,this.R)):"pub-dialog-embed-tab"==a.getId()&&(this.Va=1,Q(this.Tb,!1),Q(this.Eb,!0),pz(this.Ka,this.V));EIf(this)};p.tXa=function(a){Ql(function(){a.target.select()},0)};p.C9b=function(){this.C.zl?GIf(this,2,!1):this.C.By=!this.C.By};p.y9b=function(){this.C.zl?GIf(this,0,!1):this.C.Yy=!this.C.Yy};function yIf(a){return a.C.zl?"Stop publishing":"Start publishing"}
function xIf(a,b){Ri(Mi(a.kd.mf(a.Rc),"id",a.$a),y(function(c){this.C.zl=!!rJ(c,"published");this.C.By=!!rJ(c,"requireSignin");this.C.D=!!rJ(c,"domainClosed");this.C.domain=sne(c,"domain");this.C.F=sne(c,"domainDisplay");this.C.Yy=!Number(rJ(c,"revision"));this.C.To=this.NIa(c.Ze());this.C.H=sne(c,"publishedDocumentId");b()},a)).bf()}p.NIa=Xi;p.qIa=Xi;function HIf(a){return{Yy:a.C.Yy,zl:a.C.zl,By:a.C.By,To:a.C.To}}
function GIf(a,b,c){c=oa(c)?c:!0;var d=HIf(a);switch(b){case 0:d.Yy=!d.Yy;break;case 1:d.zl=!d.zl;break;case 2:d.By=!d.By;break;default:throw Error("Unknown toggle op: "+b);}d.zl||(d.To=a.qIa());IIf(a,d,c)}
function IIf(a,b,c){JIf(a,!1);Qi(Ri(Pi(qn(Mi(a.kd.mf(a.Rc),"id",a.$a),KIf(a,b)),2),y(function(){this.C.Yy=b.Yy;this.C.zl=b.zl;this.C.By=b.By;this.C.To=b.To;this.C.zl&&this.C.To&&(zIf(this,this.J.dO())||this.J.jwa(this.C.To),zIf(this,this.F.dO())||this.F.jwa(this.C.To));JIf(this,!0);EIf(this);if(c&&this.C.zl)switch(this.Va){case 0:this.R.focus();this.R.select();break;case 1:this.V.focus();this.V.select();break;default:throw Error("Cannot handle selected link type "+this.Va);}},a)),y(function(){GZb("An error occurred whilst saving publishing settings.",
void 0,this.Ib()?this:void 0);JIf(this,!0);EIf(this)},a)).bf()}function KIf(a,b){var c={id:a.$a,requireSignin:b.By,published:b.zl};a.C.C&&!b.Yy&&(c.revision=a.C.C);b.To&&(a=LIf(b.To),Sd(c,a));return c}function JIf(a,b){for(var c=[a.O,a.ma,a.Aa,a.L],d=0;d<c.length;d++){var e=c[d];!b&&e.Kk()&&(a.Za=e);e.Pa(b)}b&&a.Za&&(a.isVisible()&&a.Za.isVisible()&&(c=a.Za.getElement())&&c.focus(),a.Za=null);a.Ua.J(b)}
p.g3b=function(a,b){if(b||window.confirm(this.C.zl?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ma.setContent("Saving..."),GIf(this,1)};function AIf(a){switch(a.Va){case 0:return a.J.dO();case 1:return a.F.dO();default:throw Error("Cannot handle selected link type "+a.Va);}}
p.lDb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=AIf(this),b=HIf(this);b.zl=!0;a&&(b.To&&this.C.zl?b.To=MIf(b.To,a):b.To=a);this.Aa.setContent("Publishing...");IIf(this,b,!0)}};p.mDb=function(){var a=this.Ua.F();if(this.C.zl)if(a&&a.isEmpty())GIf(this,1);else{var b=HIf(this);b.To=a;IIf(this,b)}else this.C.To=a,EIf(this)};function zIf(a,b){return a.C.zl&&(!b||!a.C.To||a.C.To.GPa(b))}
function uIf(a){this.C=a;this.D=this.By=this.zl=!1;this.Yy=!0;this.H=this.F=this.domain=""}function vIf(){VS.call(this)}A(vIf,VS);vIf.prototype.kf=function(a){return a.keyCode&&27==a.keyCode?!1:vIf.Ba.kf.call(this,a)};function NIf(a,b,c,d){this.F=a;this.Ii=b;this.C=c;this.D=d}function OIf(a,b){return new NIf(!1,null,new PIf(a,b||"interactive"),null)}function PIf(a,b){this.id=a;this.format=b};function Y4(a,b,c){this.F=a;this.D=new MH(b);this.C=c}p=Y4.prototype;p.GPa=function(a){return this.F||!a.F&&Mc(a.D.Pd(),this.oca,this)&&Mc(a.C,this.Zba,this)};p.oca=function(a){return this.F||this.D.contains(a)};function QIf(a,b){return Lc(a.C,function(c){return c.id==b.id})}p.Zba=function(a){return this.F||this.D.contains(a.Ii)||QIf(this,a)};function RIf(a,b){a.C=Ic(a.C,function(c){return c.Ii!=b})}function SIf(a,b){QIf(a,b)&&(a.C=Ic(a.C,function(c){return c.id!=b.id}))}
function MIf(a,b){var c=a.F||b.F;if(c)return new Y4(c,[],[]);var d=a.clone();Gc(b.D.Pd(),function(e){d.D.contains(e)||(d.D.add(e),RIf(d,e))});Gc(b.C,function(e){d.Zba(e)||d.C.push(e)});return d}function LIf(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Pd().join(","),charts:Jc(a.C,function(b){return b.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&Tc(this.C)};p.clone=function(){return new Y4(this.F,this.D.Pd(),bd(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&jd(this.C,a.C,function(b,c){return b.id==c.id&&b.Ii==c.Ii})};function TIf(a,b){this.id=a;this.Ii=b};function UIf(a,b,c,d){R.call(this,void 0);this.C=c||new NIf(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new OP("",VIf(a,b));this.D.qk(!0);this.Ia(this.D,!0);a=new Sv;a.Ia(new Nv("Interactive","interactive"),!0);a.Ia(new Nv("Image","image"),!0);this.H=new OP("",a);this.Ia(this.H,!0);a=new Sv;a.Ia(new Nv("Web page","html"),!0);a.Ia(new Nv("Comma-separated values (.csv)","csv"),!0);a.Ia(new Nv("Tab-separated values (.tsv)","tsv"),!0);a.Ia(new Nv("PDF document (.pdf)","pdf"),!0);a.Ia(new Nv("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ia(new Nv("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new OP("",a);this.Ia(this.F,!0);WIf(this)}A(UIf,qIf);var XIf=["xlsx","ods"],YIf=["csv","tsv"];
function VIf(a,b){var c=new Sv;c.Ia(new Nv("Entire Document",new ZIf("entireDocument",null)),!0);c.Ia(new Rv,!0);var d=yac(b);Gc(a.D,function(e){c.Ia(new Nv(e.Be(),new ZIf("sheet",e.Db())),!0);if(e=d[e.Db()])for(var f={},h=0;h<e.length;f={cY:f.cY},h++){var k=e[h];6==k.getType()&&k.isSaved()&&(f.cY=new Nv("",new ZIf("chart",HJ(k))),vM(k).then(function(l){return function(m){l.cY.Pk(m.getTitle())}}(f)),c.Ia(f.cY,!0),dv(f.cY.Ob(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=UIf.prototype;
p.Ja=function(){UIf.Ba.Ja.call(this);dv(this.getElement(),"pub-dialog-link-options-container");dv(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");dv(this.D.Ob(),"pub-dialog-link-options-document-part-menu-button-content");dv(this.D.dc().getElement(),"pub-dialog-link-options-document-part-menu");Xu(this.D.Na(),"Sheet or chart selection");Xu(this.H.Na(),"Chart format");Xu(this.F.Na(),"Sheet format");this.getHandler().listen(this.D,"change",this.ntb).listen(this.H,"change",this.Rpb).listen(this.F,
"change",this.aGb).listen(this.D,"afterhide",function(a){a.stopPropagation()}).listen(this.H,"afterhide",function(a){a.stopPropagation()}).listen(this.F,"afterhide",function(a){a.stopPropagation()})};
p.ntb=function(){var a=this.D.yf().Ra();switch(a.type){case "entireDocument":this.C=new NIf(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!$If(this,a,b)&&(b=null);this.C=new NIf(!1,a,null,b||"html");break;case "chart":this.C=OIf(a.id,this.C.C?this.C.C.format:null)}WIf(this);rIf(this)};p.Rpb=function(){var a=this.H.yf().Ra();this.C.C&&(this.C.C.format=a,rIf(this))};p.aGb=function(){var a=this.F.yf().Ra();this.C.D=a;rIf(this)};
function WIf(a){var b=bd(a.D.Yj.C);b=Nc(b,function(c){c=c.Ra();if(!c)return!1;switch(c.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Ii&&c.id==this.C.Ii;case "chart":return null!=this.C.C&&c.id==this.C.C.id;default:return!1}},a);sw(a.D,b);b=!!a.C.C;Q(a.H.getElement(),b);null!=a.C.C&&a.H.setValue(a.C.C.format);Q(a.F.getElement(),a.J&&!b);b||(aJf(a),a.F.setValue(a.C.D))}
function aJf(a){for(var b=a.F.dc(),c=0;c<b.ji();c++){var d=b.jf(c),e=d.getValue();d.Pa(null==a.C.Ii||$If(a,a.C.Ii,e))}}function $If(a,b,c){if(Qc(XIf,c))return!1;a=QK(a.O,b);return null!=a&&1==a.getSheetType()&&Qc(YIf,c)?!1:!0}p.v0=g("C");p.dO=function(){if(this.C.F)return new Y4(!0,[],[]);if(null!=this.C.Ii)return new Y4(!1,[this.C.Ii],[]);var a=this.L.C(this.C.C.id);a=new TIf(this.C.C.id,a.Db());return new Y4(!1,[],[a])};
p.jwa=function(a){if(!a.F){var b=a.D.Pd();0<b.length?this.C=new NIf(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=OIf(a[0].id)));WIf(this)}};function ZIf(a,b){this.type=a;this.id=b};function bJf(a,b){OP.call(this,void 0,void 0);this.R=a;this.O=b;this.C=new Y4(!0,[],[]);this.L=!1;this.H=new GU("Entire Document");this.Tc(this.H);this.Tc(new Rv);cJf(this);this.qk(!0);dJf(this)}A(bJf,OP);function cJf(a){var b=yac(a.O);Gc(a.R.D,function(c){var d=new GU(c.Be(),c);a.Tc(d);(c=b[c.Db()])&&Gc(c,function(e){if(6==e.getType()&&e.isSaved()){var f=new GU("",e);vM(e).then(function(h){f.Pk(h.getTitle())});a.Tc(f);dv(f.Ob(),"pub-dialog-published-content-chart-menu-item")}})})}
bJf.prototype.Ja=function(){bJf.Ba.Ja.call(this);dv(this.getElement(),"pub-dialog-published-content-menu-button");dv(this.Ob(),"pub-dialog-published-content-menu-button-content");dv(this.dc().getElement(),"pub-dialog-published-content-menu");this.getHandler().listen(this,"afterhide",function(a){a.stopPropagation()})};
bJf.prototype.Vx=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.C;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Ra(),b instanceof ZF?(b=b.Db(),a?(a=this.C,a.D.contains(b)||(a.D.add(b),RIf(a,b))):(a=this.C,a.D.contains(b)&&(a.D.remove(b),RIf(a,b)))):(b=new TIf(HJ(b),b.Db()),a?(a=this.C,a.Zba(b)||a.C.push(b)):SIf(this.C,b));this.L=!0;dJf(this)};bJf.prototype.Nd=function(a,b){bJf.Ba.Nd.call(this,a,b);!a&&this.L&&(this.L=!1,this.dispatchEvent(new ql("Oh")))};
function dJf(a){var b=a.C.F;a.H.qc(b);Gc(k2a(a.dc()),function(c){var d=c.Ra();d&&(d instanceof ZF?(c.qc(a.C.oca(d.Db())),c.Pa(!b)):(d=new TIf(HJ(d),d.Db()),c.qc(a.C.Zba(d)),c.Pa(!a.C.oca(d.Ii))))});eJf(a)}
function eJf(a){if(a.C.F)a.setContent("Entire Document");else{var b=Ic(a.R.D,y(function(h){return this.C.oca(h.Db())},a)),c=Jc(b,function(h){return h.Be()});b=[];for(var d=a.C.C,e=0;e<d.length;e++){var f=a.O.C(d[e].id);f&&b.push(vM(f))}Oxa(b).then(function(h){for(var k=[],l=0;l<h.length;l++){var m=h[l];m.iT&&k.push(m.value.getTitle())}h=ad(c,k);h=0<h.length?h.join(", "):"None";a.setContent(h)})}};function fJf(a,b){R.call(this,void 0);this.C=new bJf(a,b);this.Ia(this.C,!0);this.D=!1}A(fJf,sIf);fJf.prototype.Ja=function(){fJf.Ba.Ja.call(this);dv(this.getElement(),"pub-dialog-published-content-container")};fJf.prototype.F=function(){return this.C.C};fJf.prototype.H=function(a){var b=this.C;b.C=a.clone();dJf(b)};fJf.prototype.J=function(a){!a&&this.C.Kk()&&(this.D=!0);this.C.Pa(a);a&&this.D&&(this.Ib()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function gJf(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+vFf(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return U(b+a+"</div>")};function hJf(a,b,c,d,e,f,h){var k=null!=h?OIf(h):null;h=new UIf(c,d,k,!0);k=new UIf(c,d,k,!1);X4.call(this,a,b,e,"spreadsheets",f,h,k,new fJf(c,d),"/publishingsettings",new iJf);this.rf=c;this.Ec=d}A(hJf,X4);
hJf.prototype.NIa=function(a){if(a.entireDocument)return new Y4(!0,[],[]);var b=a.charts||"";a=Ic((a.sheets||"").split(","),function(c){return null!=QK(this.rf,c)},this);b=Ic(b.split(","),y(function(c){return!!this.Ec.C(c)},this));b=Jc(b,function(c){var d=this.Ec.C(c);return new TIf(c,d.Db())},this);return new Y4(!1,a,b)};hJf.prototype.qIa=function(){return new Y4(!0,[],[])};
function BIf(a,b){if(b.F||null!=b.Ii){var c="html"==b.D;a=FIf(a,c?"/pubhtml":"/pub");null!=b.Ii&&(a=Aj(a,"gid",b.Ii,"single","true"));c||(a=Aj(a,"output",b.D))}else a=Aj(FIf(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function CIf(a,b){var c=BIf(a,b);if(b.F||null!=b.Ii)c=Aj(c,"widget","true","headers","false");a=b.C?(a=a.Ec.C(b.C.id))?a.$c():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Zd(c)+'"></iframe>'}function iJf(){}A(iJf,R);iJf.prototype.Ca=function(){this.Cb(Iw(gJf,{locale:"en-GB"}))};function jJf(a,b,c){pQ.call(this,134,a,b);this.C=c}x(jJf,pQ);jJf.prototype.Qd=function(){var a=this.Ra().yc(),b=Pk(this.getRect(),a);a=new UF;I(a,1,b);b=ia(this.C);for(var c=b.next();!c.done;c=b.next())Re(a,2,c.value);return a};jJf.prototype.eO=function(){return VFb.xa()};function kJf(a,b,c){b=c||b;c=a.B5b;var d=a.Ygb;Aa(a.hS);a=a.hS;var e=Tw("waffle-rd-title-data"),f=Tw("waffle-rd-title-cta");c='<div class="'+V("waffle-rd-section")+'" role="group" tabindex="0" aria-labelledby="'+V(e)+'"><div id="'+V(e)+'" class="'+V("waffle-rd-selection-description")+'" tabindex="0">'+S(c)+'</div><div class="'+V("waffle-rd-expand-to-range")+'"'+(d?"":' style="display: none;"')+' tabindex="0" role="button">'+S(d)+'</div><div class="'+V("waffle-rd-ignore-headers")+'"><span class="'+
V("waffle-rd-checkbox")+'"></span><div class="'+V("waffle-rd-checkbox-label")+'">';c=c+"Ignore headers"+('</div></div></div><div class="'+V("waffle-rd-section")+'" role="group" tabindex="0" aria-labelledby="'+V(f)+'"><div id="'+V(f)+'" class="'+V("waffle-rd-section-title")+'">');c=c+"Columns to analyse"+("</div>"+lJf({hS:a},b)+"</div>");return U(c)}
function lJf(a){Aa(a.hS);a=a.hS;for(var b='<div class="'+V("waffle-rd-columns-container")+'">',c=a.length,d=0;d<c;d++){var e=a[d];b+='<div class="'+V("waffle-rd-columns-checkbox")+'"><span class="'+V("waffle-rd-checkbox")+'"></span><div class="'+V("waffle-rd-checkbox-label")+'">'+S(e.label)+"</div></div>"}return U(b+"</div>")};function mJf(a,b,c,d,e){bz.call(this,void 0,!1);this.C=a;this.Ua=b;this.Ka=c;this.ma=d;this.R=e;this.O=Av(new zv,1).build();this.V=this.Aa=null;this.F={};this.L=null;this.J=new LR(!1,MR.getInstance(),this.qa())}x(mJf,bz);p=mJf.prototype;p.La=function(){bz.prototype.La.call(this);F(this.Aa);F(this.V);F(this.F);F(this.L)};
p.Ca=function(){bz.prototype.Ca.call(this);this.setTitle("Remove duplicates");dv(Mx(this),"waffle-rd-dialog-gm");if(!nJf){var a=new Px;a.set("cancel","Cancel",!1,!0);a.set("save","Remove duplicates");nJf=a}Sx(this,nJf);Zx(this,"save");var b=this.C.Nc();a=b.height+(" rows and "+(b.width+" columns selected"));var c=qne(this);c&&Xu(c,"Remove duplicates "+a);c=null;oJf(this)&&(c="Expand to "+mM(this.ma));b=pJf(this,b);b=Jc(b,function(d){return qJf(d)});a=Iw(kJf,{B5b:a,Ygb:c,hS:b});c=this.Ob();this.qa().appendChild(c,
a)};p.Ja=function(){bz.prototype.Ja.call(this);this.V=Ns("waffle-rd-expand-to-range",void 0);this.Aa=Ns("waffle-rd-selection-description",void 0);this.L=Ns("waffle-rd-columns-container",void 0);this.getHandler().listen(this,"dialogselect",this.RTb).listen(this,"change",this.oqb).listen(this.J,"change",this.Xwb).og(this.V,xl,this.KLa);var a=this.C.Nc(),b=Ns("waffle-rd-ignore-headers",void 0);b=bt(b);var c=ct(b),d=this.J;d.Xa(b);KR(d,c);d.Pa(1<a.height);rJf(this,a)};
p.RTb=function(a){var b=this;if("save"==a.key){a=sJf(this);var c=tJf(this,a);a=new jJf(this.C,a,c);mJ(a,function(d,e){d?(e&&(d=H(e,1),d=(new Dy("{ROWS,plural, =0{No duplicate rows were found.}=1{1 duplicate row found and removed.}other{{ROWS} duplicate rows found and removed.}}")).format({ROWS:d}),e=H(e,2),e=(new Dy("{ROWS,plural, =1{1 unique row remains.}other{{ROWS} unique rows remain.}}")).format({ROWS:e}),e=Km(d+"\n\n"+e),iJ(e,"Remove duplicates")),b.R.C(35997,b.O)):b.R.C(35996,b.O)});this.Ka.C(a);
this.R.C(this.J.Jm()?35993:35994,this.O)}else"cancel"==a.key&&this.R.C(35995,this.O)};p.KLa=function(){if(oJf(this)){var a=this.ma,b=this.Ua;DI(this.C,a);MM(b.J);fQ(b,!0);b=a.height+(" rows and "+(a.width+" columns selected"));this.Aa&&gt(this.Aa,b);var c=qne(this);c&&Xu(c,"Remove duplicates "+b);uJf(this);this.L&&(b=pJf(this,a),b=Jc(b,function(d){return qJf(d)}),b=Iw(lJf,{hS:b}),Xs(this.L),Ws(this.L,b.childNodes),rJf(this,a));this.J.Pa(1<a.height);this.R.C(35998,this.O);this.focus()}};
p.oqb=function(a){var b=Bd(this.F,function(e,f){return-1!=f});b=Fd(b);var c=this.F[-1];if(a.target==c){var d=c.Jm();Gc(b,function(e){e.qc(d)})}a=Kc(b,function(e,f){return e+(f.Jm()?1:0)},0);c.qc(a==b.length);Vx(this.D,"save",0<a)};p.Xwb=function(){var a=this,b=this.C.Nc();b=pJf(this,b);Gc(b,function(c){var d=c.getColumn();d=a.F[d].getElement();d=ct(d);c=c.getLabel();gt(d,c)})};function sJf(a){var b=a.C.Nc(),c=Ik(b,"r");a.J.Jm()&&1<c&&(b=oua(b,-1));return b}function uJf(a){(a=a.V)&&Q(a,!1)}
p.I6a=function(){BI(this.C)&&this.KLa()};function oJf(a){var b=a.C.Nc();return!!a.ma&&a.ma.Rh()>b.Rh()}p.N6b=function(){return BI(this.C)&&!oJf(this)};function rJf(a,b){var c=a.Ti("waffle-rd-columns-checkbox");b=pJf(a,b);for(var d=0;d<c.length;d++){var e=b[d],f=bt(c[d]),h=ct(f),k=a.F[e.getColumn()],l=a,m=new LR(!1,MR.getInstance(),l.qa());m.Xd(l);var r=e.getColumn();l=l.F[r]=m;l.Xa(f);KR(l,h);e=k?k.Jm():e.Jm();l.qc(e)}}
function pJf(a,b){var c=[];c.push(new vJf(-1,"Select all"));var d=b.Cc(),e=b.hd(),f=a.J.Jm();for(b=b.Ac();d<e;d++){var h=hM(d),k=ae(WH(a.C.Bh(b,d)),25);c.push(new vJf(d,td(k)||!f?"Column "+h:"Column "+(h+(" - "+k))))}return c}function tJf(a,b){var c=b.Cc();b=b.hd();for(var d=[],e=null;c<b;c++)a.F[c].Jm()?e?(e=Ue(e,1),e=tua(e,c+1)):e=tua(c,c+1):e&&(d.push(e),e=null);e&&d.push(e);return d}var nJf=null;function vJf(a,b){this.C=a;this.D=b}vJf.prototype.getColumn=g("C");vJf.prototype.getLabel=g("D");
vJf.prototype.Jm=n(!0);function qJf(a){return{column:a.C,label:a.D,checked:!0}};function wJf(a){a=""+xJf({id:"waffle-resize-selection-custom",St:a.hla,ol:Uw("<br/>"+S(NFf({id:"waffle-resize-input",Dd:"waffle-resize-inset-input"})))});a+=xJf({id:"waffle-resize-selection-auto",St:Tw("Fit to data"),ol:Uw("")});return U(a)}function xJf(a){var b=a.id,c=a.St;a=a.ol;return U('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+V(b)+'"><label for="'+V(b)+'" class="waffle-resize-label">'+S(c)+"</label>"+S(a)+"</div>")}
function yJf(a){a=a.hla;a='<div id="waffle-resize-input-error-butter-container" class="waffle-input-error-butter-container"><div id="waffle-resize-butter-bar-wrap" class="waffle-input-error-butter-wrap"></div></div>'+xJf({id:"waffle-resize-selection-custom",St:Tw("Specify row height"),ol:Uw('<div class="waffle-resize-row-input-container">'+S(NFf({id:"waffle-resize-input",Dd:"waffle-resize-row-input"}))+'<label for="waffle-resize-input" class="waffle-resize-row-input-label">'+S(a)+"</label></div>")});
a+=xJf({id:"waffle-resize-selection-auto",St:Tw("Fit to data"),ol:Uw("")});return U(a)};function zJf(a,b,c,d,e){bz.call(this);this.O=a;this.V=b;var f=Dk(this.O.Nc());this.J=f;this.F=Ic(vI(this.O),function(h){return Dk(h)==f});this.R=new Ey;this.L=new uwe;this.Ka=c;this.Ua=d;this.Aa=e;this.ma=this.D;this.C=null}A(zJf,bz);p=zJf.prototype;p.Ca=function(){zJf.Ba.Ca.call(this);this.setTitle(AJf(this));"r"==this.J?this.Ob().appendChild(Iw(yJf,{hla:BJf(this)})):this.Ob().appendChild(Iw(wJf,{hla:BJf(this)}));Zx(this,"ok")};
p.Ja=function(){zJf.Ba.Ja.call(this);var a=this.qa(),b="r"==this.J;this.R.Xa(a.getElement("waffle-resize-input"));var c=this.O.Nc(),d=Dk(c);c=SGb(cSb(this.O,d,Bk(c,d)));this.R.setValue(String(c));vwe(this.L,"waffle-resize-selection");if(b){a:{b=null;for(c=0;c<this.F.length;c++){d=this.F[c];for(var e=d.top,f=0;f<d.height;f++){var h=ritz_api.RitzModelApi.isDimensionForcedSize(this.O.Ua,!0,e+f);if(null==b)b=h;else if(b!=h){b=null;break a}}}b=b?"waffle-resize-selection-custom":"waffle-resize-selection-auto"}null!=
b?wwe(this.L,b):Vx(this.ma,"ok",!1);this.C=new dy(a.getElement("waffle-resize-input-error-butter-container"));this.C.setType("warning");this.C.setContent("");this.C.render(a.getElement("waffle-resize-butter-bar-wrap"));D6a(this.C,!0);this.C.setVisible(!1)}else wwe(this.L,"waffle-resize-selection-custom");this.getHandler().listen(this,"dialogselect",this.TTb).listen(this.R.getElement(),"focus",this.sJb).listen(this.R.getElement(),"change",this.STb).listen(this.L,"change",this.yEb)};
p.sJb=function(){wwe(this.L,"waffle-resize-selection-custom");Vx(this.ma,"ok",!0)};p.yEb=function(){"r"==this.J&&(Vx(this.ma,"ok",!0),this.C.setVisible(!1))};p.STb=function(){"r"==this.J&&this.C.setVisible(!1)};p.focus=function(){this.Ib()&&"waffle-resize-selection-custom"==xwe(this.L)&&Hy(this.R)};
function AJf(a){var b=a.F[0];if("r"==a.J){var c=b.Ac();b=b.Xc()-1;var d=String(fM(c+1)),e=String(fM(b+1));return 1<a.F.length?"Resize selected rows":c==b?"Resize row "+d:"Resize rows "+(d+(" - "+e))}c=b.Cc();b=b.hd()-1;d=hM(c);return 1<a.F.length?"Resize selected columns":c==b?"Resize column "+d:"Resize columns "+(d+(" - "+hM(b)))}function BJf(a){return"c"==a.J?"Enter new column width in pixels. (Default: "+(UGb+")"):"pixels (Default: "+(eI+")")}
p.TTb=function(a){if("ok"==a.key){var b="r"==this.J;if("waffle-resize-selection-custom"==xwe(this.L)){var c=je(this.R.getValue()),d=isNaN(c)?"Entered value is not a number.":2>c||2E3<c?"Size must be between 2 and 2000 pixels.":null;null!=d?("r"==this.J?(this.C.setContent(d),this.C.setVisible(!0)):iJ(d),a.preventDefault()):(this.Aa.C(b?35979:35308),a=new zcd(this.O,this.F[0],c,this.F.slice(1)),b&&(a.O=!0),this.V.C(a))}else"waffle-resize-selection-auto"==xwe(this.L)&&(b?(this.Aa.C(35980),this.V.C(new zcd(this.O,
this.F[0],null,this.F.slice(1)))):(tJ(this.Ka),this.Aa.C(35307),Ccd(this.F,this.Ua,this.V)))}};function CJf(a){L(this,a,0,-1,null,null)}A(CJf,J);p=CJf.prototype;p.ea=function(a){var b,c={QHd:null==(b=M(this,1))?void 0:b,frequency:null==(b=M(this,2))?void 0:b,type:null==(b=M(this,3))?void 0:b};a&&(c.Fa=this);return c};p.QI=function(){return M(this,2)};p.Efa=function(a){O(this,2,a)};p.getType=function(){return M(this,3)};p.setType=function(a){O(this,3,a)};p.ke=function(){return null!=M(this,3)};function DJf(a){a=a.wMb;return U('<div><div class="'+V("waffle-notification-helplink-container")+'" align="right"></div><div class="'+V("waffle-notification-rulearea-container")+" "+V("waffle-dialog-notifications-bounds")+'"><div class="'+V("waffle-notification-editrule-container")+'"></div><div class="'+V("waffle-notification-listrule-container")+'"></div></div>'+(a?"":'<div class="'+V("waffle-notification-addbutton-container")+'"></div>')+"</div>")}
function EJf(a){var b=a.k9;a='<div class="'+V("waffle-dialog-notifications")+'"><div class="'+V("waffle-notification-rule-area")+'"><div class="'+V("waffle-dialog-notifications-toplabel")+'">';b="Notify me at "+(S(b)+" when...");a=a+b+('</div><div class="'+V("waffle-notification-top-group")+'" role="radiogroup"><div class="'+V("waffle-notification-any-change-container")+" "+V("waffle-dialog-notifications-input")+'" role="presentation"></div><div class="'+V("waffle-notification-form-submit-container")+
" "+V("waffle-dialog-notifications-input")+'" role="presentation"></div></div><div class="'+V("waffle-notification-rule-area-separator")+'"></div><div class="'+V("waffle-dialog-notifications-label")+'">');a=a+"Notify me with..."+('</div><div class="'+V("waffle-notification-bottom-group")+'" role="radiogroup"><div class="'+V("waffle-notification-daily-digest-container")+" "+V("waffle-dialog-notifications-input")+'" role="presentation"></div><div class="'+V("waffle-notification-right-away-container")+
" "+V("waffle-dialog-notifications-input")+'" role="presentation"></div></div></div><div class="'+V("waffle-notification-buttons-container")+'"></div></div>');return U(a)}
function FJf(a){a=a.S4b;return U('<div class="'+V("waffle-notification-rule-row")+'"><div class="'+V("waffle-notification-rule-description")+'"><span class="'+V("waffle-notification-rule-text")+'">'+S(a)+'</span></div><div class="'+V("waffle-notification-rulerow-buttons-container")+'"><div class="'+V("waffle-notification-rulerow-edit-container")+'"></div><div class="'+V("waffle-notification-rulerow-delete-container")+'" width="50px"></div></div><div class="'+V("waffle-notification-rule-separator")+
'"></div></div>')};function GJf(a){R.call(this,a);a=aA.getInstance();this.ma=C(B(),"docs-egmd");this.R=this.O=this.H=this.L=this.J=this.F=null;this.V=a.C.email;this.C=this.D=null}x(GJf,R);p=GJf.prototype;
p.Ca=function(){R.prototype.Ca.call(this);var a=this.qa(),b=Iw(EJf,{k9:this.V});this.Cb(b);this.C=new fY;this.va(this.C);this.F=new eY;this.F.VJ(a.Ca("LABEL",null,"Any changes are made"));this.F.render(this.Ha("waffle-notification-any-change-container"));this.C.UJ(this.F);this.J=new eY;this.J.VJ(a.Ca("LABEL",null,"A user submits a form"));this.J.render(this.Ha("waffle-notification-form-submit-container"));this.C.UJ(this.J);this.D=new fY;this.va(this.D);this.H=new eY;this.H.VJ(a.Ca("LABEL",null,"Email - daily digest"));
this.H.render(this.Ha("waffle-notification-daily-digest-container"));this.D.UJ(this.H);this.L=new eY;this.L.VJ(a.Ca("LABEL",null,"Email - straight away"));this.L.render(this.Ha("waffle-notification-right-away-container"));this.D.UJ(this.L);b=this.Ha("waffle-notification-buttons-container");this.R=new zx("Cancel",a);this.Ia(this.R,!1);this.R.render(b);this.O=Ax("Save",a);this.Ia(this.O,!1);this.O.render(b);this.ma&&dv(this.O.getElement(),"waffle-notification-end-button")};
p.Ja=function(){R.prototype.Ja.call(this);this.getHandler().listen(this.O,"action",this.d5b,!0).listen(this.R,"action",y(this.dispatchEvent,this,new ql("cancelRuleEdit"))).listen(this.C,"change",this.wta).listen(this.D,"change",this.wta)};p.Sb=function(a){R.prototype.Sb.call(this,a);a?1==a.getType()?gY(this.C,this.F):2==a.getType()&&gY(this.C,this.J):gY(this.C,null);a?2==a.QI()?gY(this.D,this.H):1==a.QI()&&gY(this.D,this.L):gY(this.D,null);this.wta()};
p.focus=function(){var a=hY(this.C),b=this.C.C.jf(0);(a||b).getElement().focus()};p.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};p.d5b=function(){this.dispatchEvent(new ql("saveRule",HJf(this)))};function HJf(a){var b=new CJf,c=a.Ra();c&&(c=M(c,1),O(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?b.Efa(1):a.H.isChecked()&&b.Efa(2);return b}
p.wta=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Pa(a)};function IJf(a){var b=a.Gxa;return U("<div><div>"+S(a.q9a)+"</div>"+S(f_c({id:"waffle-confirm-suppress-checkbox",Dd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+S(b)+"</span></div>")};function JJf(a,b,c,d,e,f,h){var k=C(B(),"docs-egmd");if(Da(c)){var l=new Px;k&&l.set("cancel",c.cancel,!1,!0);l.set("ok",c.ok,!0);k||l.set("cancel",c.cancel,!1,!0)}else l=k?A$a():T5a();return KJf(d||"Heads up!",a,b,l,e,f,h)}
function KJf(a,b,c,d,e,f,h){b=Km(b);if(f){b=Dw(IJf({q9a:b,Gxa:f}));var k=new NR;var l=c;c=function(){l(k.isChecked())}}a=i6a(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ia(k),k.Xa(mt(a.qa(),"waffle-confirm-suppress-checkbox")),c=mt(a.qa(),"waffle-confirm-suppress-label"),KR(k,c),k.qc(!1));return a};function LJf(a,b){R.call(this,b);this.Sb(a)}x(LJf,R);
LJf.prototype.Ca=function(){R.prototype.Ca.call(this);var a=this.Ra(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==a.QI()?c+="send digest email":1==a.QI()&&(c+="send email");a=Iw(FJf,{S4b:"If "+(b+(" then "+c))});this.Cb(a);a=nv(Hv,"waffle-notifications-add");this.D=new Jv("Edit",a,this.qa());this.D.ld("goog-link-button");this.D.ld("menuMainLink");this.Ia(this.D,!1);this.D.render(this.Ha("waffle-notification-rulerow-edit-container"));this.C=new Jv("Delete",
a,this.qa());this.C.ld("goog-link-button");this.C.ld("menuMainLink");this.Ia(this.C,!1);this.C.render(this.Ha("waffle-notification-rulerow-delete-container"))};LJf.prototype.Ja=function(){R.prototype.Ja.call(this);this.getHandler().listen(this.D,"action",this.H);this.getHandler().listen(this.C,"action",this.F)};LJf.prototype.H=function(){this.dispatchEvent(new ql("edit",this.Ra()))};
LJf.prototype.F=function(){var a=y(function(){this.dispatchEvent(new ql("del",this.Ra()))},this),b=y(function(){this.C.getElement().focus()},this);JJf("Are you sure that you want to delete this notification rule?",a,void 0,void 0,b)};function MJf(a){R.call(this,a)}x(MJf,R);MJf.prototype.Ca=function(){var a=this.qa().Ca("DIV",{className:"waffle-dialog-notifications-list",width:"100%"});this.Cb(a)};MJf.prototype.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};function NJf(a,b,c){bz.call(this,void 0,!1,c);this.V=b;this.L=a;this.setTitle("Set notification rules");Ox(this,!1);a=new Px;a.set("cancel","Done",!1,!0);Sx(this,a);this.C=new GJf(c);this.Ia(this.C,!1);this.J=new MJf;this.Ia(this.J,!1);this.F=new Jv("Add another notification rule",RM.getInstance(),this.qa());this.Ia(this.F,!1);this.O=new Jv("Help",RM.getInstance(),this.qa());this.Ia(this.F,!1);this.R=C(B(),"docs-egmd")}x(NJf,bz);p=NJf.prototype;
p.Ca=function(){bz.prototype.Ca.call(this);var a=this.qa();dv(Mx(this),"waffle-notifications-dialog");a.appendChild(this.Ob(),Iw(DJf,{wMb:this.R}));if(this.R){var b=a.Ca("DIV","waffle-notification-helpbutton-container");this.O.render(b);a.appendChild(Jx(this),b);b=a.Ca("DIV","waffle-notification-addbutton-container");this.F.render(b);a.Fw(Lx(this),b,0)}else b=a.Ca("A",{target:"_blank"},"Help"),Rm(b,"https://support.google.com/docs/answer/91588"),a.appendChild(this.Ha("waffle-notification-helplink-container"),
b),this.F.render(this.Ha("waffle-notification-addbutton-container"));this.J.render(this.Ha("waffle-notification-listrule-container"));this.C.render(this.Ha("waffle-notification-editrule-container"));Zx(this,"")};p.Ja=function(){bz.prototype.Ja.call(this);this.getHandler().listen(this,"edit",this.WTb).listen(this,"del",this.VTb).listen(this.F,"action",this.UTb).listen(this,"saveRule",this.c5b).listen(this,"cancelRuleEdit",this.i8a).listen(this.O,"action",function(){return Lu("https://support.google.com/docs/answer/91588")})};
p.V2=function(a){this.isDisposed()||(this.C.setVisible(!1),OJf(this,!1),isa(this.L,"/notifications/list",y(this.k$b,this,a)).bf())};
p.k$b=function(a,b,c){if(!this.isDisposed()){b=c.Ze();c=[];for(var d=0;d<b.length;d++)c[d]=new CJf(b[d]);this.Sb(c);if(a&&0==c.length)PJf(this,null,!1);else{if(a=this.Ra())if(b=this.J,b.yd(!0),b.qa().yd(b.Ob()),b.Sb(a),c=b.qa(),0==a.length)c.appendChild(b.Ob(),c.Ca("DIV",null,c.Ca("DIV",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ia(new LJf(a[d],c),!0);OJf(this,!0);this.focus()}}};
p.c5b=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();M(a,1)?qn(isa(this.L,"/notifications/set",y(this.V2,this,!1)),{rule:b}).bf():qn(isa(this.L,"/notifications/create",y(this.V2,this,!1)),{rule:b}).bf();if(1==a.getType())a=1==a.QI()?36011:36010;else if(2==a.getType())a=1==a.QI()?36013:36012;else throw Error("Unexpected rule type: "+a.getType());b=Av(new zv,1).build();this.V.C(a,b)};p.i8a=function(){this.C.setVisible(!1);this.V2(!1)};p.WTb=function(a){PJf(this,a?a.target:null,!0)};
p.UTb=function(){PJf(this,null,!0)};function PJf(a,b,c){OJf(a,!1);var d=a.C;d.Sb(b);d.setVisible(!0);c&&a.C.focus()}p.VTb=function(a){this.J.setVisible(!1);a=a.target;qn(isa(this.L,"/notifications/delete",y(this.V2,this,!1)),{rule_id:M(a,1)}).bf()};function OJf(a,b){a.J.setVisible(b);var c=Lx(a);Q(c,b);a.F.setVisible(b)}p.show=function(){this.setVisible(!0);this.V2(!0)};function QJf(a,b,c,d,e){lJ.call(this,68);this.R=a;this.O=b;this.D=c;this.J=d;this.C=e}A(QJf,lJ);QJf.prototype.Qd=function(){var a=new LF;this.R&&I(a,1,this.R);oa(this.O)&&I(a,2,this.O);oa(this.D)&&I(a,3,this.D);this.J&&I(a,4,this.J);oa(this.C)&&I(a,5,this.C);return a};QJf.prototype.g2=function(a,b){(oa(this.D)||oa(this.J)||oa(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);QJf.Ba.g2.call(this,a,b)};function RJf(a,b,c){b=c||b;c=a.h7b;var d='<tr class="dialog-settings-general-settings-div"><div class="dialog-settings-display-language">';a='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(S(a.O$a)+"</a>");d=d+a+"</div>";c&&(d+='<div class="dialog-settings-english-name-div">'+S(f_c({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
d+="Always use English function names</label></div>");return U(d+"</tr>")}function SJf(){return U('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function TJf(a,b,c,d){bz.call(this);this.Hb=a;this.Ec=b;this.L=c;this.gc=d;this.C={};this.xb=this.Za=!1;this.fc=this.Eb=this.gb="";this.wc=new Hi;this.J=[];this.F=this.wc.Wc(sNa.xa(),ritz_api.RitzModelApi.getWorkbookProperties());this.setTitle("Settings for this spreadsheet");this.Va=!1;this.Ka=new NR;this.Ia(this.Ka);this.R=new CU;this.Ia(this.R);this.O=new CU;this.Ia(this.O);this.$a=new VS;this.Ia(this.$a);this.Aa=this.Ua=null;this.Tb=new Ay(1);this.V=this.ma="";UJf(this,0);UJf(this,1);UJf(this,
2);UJf(this,3);this.C[4]=new Ey;this.C[5]=new Ey}A(TJf,bz);var VJf=null,WJf=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],XJf=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];function UJf(a,b){a.C[b]=dGf();a.C[b].dX=!0}p=TJf.prototype;
p.Ca=function(){TJf.Ba.Ca.call(this);var a=this.Ob();dv(this.getElement(),"dialog-settings");var b=this.qa(),c=[YJf(b,"Locale","waffle-settings-label-locale"),ZJf(this,b,"This affects formatting details such as functions, dates and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),$Jf(this),YJf(b,"Time zone","waffle-settings-label-timezone"),ZJf(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",1,"waffle-settings-label-timezone",
"waffle-settings-description-timezone"),$Jf(this)],d=[];d.push(YJf(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(ZJf(this,b,"This affects how often NOW, TODAY, RAND and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push($Jf(this));d.push(YJf(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=b.Ca("A",{target:"_blank",href:"https://support.google.com/docs/answer/58515"}," Learn more about iterative calculation.");
d.push(ZJf(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=YJf(b,"Max. number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=ZJf(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");aKf(e);d.push(e);this.J.push(e);
e=YJf(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=ZJf(this,b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");aKf(e);d.push(e);this.J.push(e);"OFF"==this.C[3].yf().getValue()&&bKf(this);d.push($Jf(this));c=ad(c,d);c.push(Iw(RJf,{O$a:this.Eb,h7b:this.Va}));this.Ua=b.Ca("TABLE","dialog-settings",b.Ca("TBODY",null,
c));this.Aa=b.Ca("table","dialog-settings",b.Ca("tbody",null,d));c=Iw(SJf);b.appendChild(a,c);this.$a.Xa(c);b.appendChild(a,this.Ua);b.appendChild(a,this.Aa);Q(this.Aa,!1);VJf||(a=new Px(b),C(B(),"docs-egmd")?(a.set("cancel","Cancel",!1,!0),a.set("save","Save settings",!0)):(a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0)),VJf=a);Sx(this,VJf);cKf(this,4,Pe(this.F,3)&&H(this.F,3).vba()?H(this.F,3).k$().toString():"50");cKf(this,5,Pe(this.F,3)&&H(this.F,3).rba()?H(this.F,3).R9().toString():
"0.05");Zx(this,"save")};function aKf(a){a=a.firstChild.firstChild;dv(a,"jfk-textinput");gu(a,"width","7em")}function bKf(a){for(var b=0;b<a.J.length;b++)Q(a.J[b],!1)}function YJf(a,b,c){return a.Ca("TR",null,a.Ca("TD",{id:c,"class":"dialog-settings-label"},b))}function ZJf(a,b,c,d,e,f,h){b=b.Ca("TR",null,b.Ca("TD","dialog-settings-input"),b.Ca("TD",{id:f,"class":"dialog-settings-text"},c,h||null));a=a.C[d];a.render(b.firstChild);a=a.Na();Uu(a,"labelledby",e);Uu(a,"describedby",f);return b}
function $Jf(a){a=a.qa();return a.Ca("TR",null,a.Ca("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Ca("HR",{"class":"dialog-settings-sep"})))}
p.Ja=function(){TJf.Ba.Ja.call(this);vl(this,"dialogselect",y(this.XTb,this));this.getHandler().listen(this.C[3],"action",this.x7b);this.getHandler().listen(this.$a,"select",this.XHb);var a=this.C[4].getElement();this.R.dk(a);FU(this.R,a,a);this.R.render();EU(this.R);this.getHandler().listen(a,"change",y(this.U$b,this));a=this.C[5].getElement();this.O.dk(a);FU(this.O,a);this.O.render();EU(this.O);this.getHandler().listen(a,"change",y(this.T$b,this));if(this.Va){a=this.qa().getElement("waffle-settings-dialog-english-name-checkbox");
var b=this.qa().getElement("waffle-settings-dialog-english-name-checkbox-label");this.Ka.Xa(a);KR(this.Ka,b);this.Ka.qc(Yac(this.L.F))}};
p.setVisible=function(a){if(a){if(!this.Za){dKf(this);return}var b=this.L.L;cKf(this,0,b.C);b=b.H||WGc().name();cKf(this,1,b);cKf(this,2,Pe(this.F,3)&&H(this.F,3).lqa()?H(this.F,3).Oma().toString():"");cKf(this,3,Pe(this.F,3)&&Pe(H(this.F,3),1)?H(H(this.F,3),1)?"ON":"OFF":"OFF")}TJf.Ba.setVisible.call(this,a);this.Za&&!this.xb&&((a=Js("ds-settings-link"))&&Rm(a,this.gb),this.xb=!0)};
function dKf(a){Ri(un(a.Ec.mf("/info/settings"),eKf(a)),y(function(b){b=b.Ze();(b={locale:b.l?fKf(b.l):null,c_a:b.tz?fKf(b.tz):null,U$a:b.dls,XNb:b.dln,P$b:b.hl},b.locale)&&b.c_a&&(gKf(this,0,b.locale),gKf(this,1,b.c_a),gKf(this,2,WJf),gKf(this,3,XJf),this.gb=b.U$a,this.Eb=b.XNb,this.fc=b.P$b,this.Va=ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.fc),this.Za=!0);this.setVisible(!0)},a)).bf()}
function eKf(a){var b=Tj(pt(a.qa()).location.href);a=Rj(b,"hl");b=Rj(b,"forcehl");return["hl",a,"forcehl",b]}function gKf(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Nv(e.caption,e.value);a.Tc(e);Tu(e.getElement(),"menuitem")}a.dc().getElement().style.overflow="auto";a.qk(!0)}function fKf(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b}function cKf(a,b,c){(a=a.C[b])&&a.setValue(c)}
p.XTb=function(a){if("save"==a.key)if("ON"!=this.C[3].yf().getValue()||""==this.ma&&""==this.V){hKf(this);a=this.L.L.C;var b=this.L.L.H;this.Hb.C(iKf(this));this.Hb.C(jKf(this));if(this.Va){var c=Yac(this.L.F);var d=this.Ka.isChecked();c!=d?(zbc(this.L,d),c=Av(new zv,1).build(),this.gc.C(d?2433:2434,c),d=!0):d=!1}else d=!1;(d||kKf(this,0,a)||kKf(this,1,b))&&lKf(this)}else a.preventDefault(),hKf(this),""!=this.ma&&DU(this.R,this.ma,!0),""!=this.V&&DU(this.O,this.V,!0)};
p.x7b=function(a){if("ON"==a.target.getValue())for(a=0;a<this.J.length;a++)Q(this.J[a],!0);else bKf(this);hKf(this)};function hKf(a){EU(a.R);EU(a.O)}p.U$b=function(){this.ma="";var a=this.C[4].getValue()||"";a=this.Tb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.ma="Please enter an integer value.";else if(0>=a||1E4<a)this.ma="Please enter a value between 1 and 10000."};
p.T$b=function(){this.V="";var a=this.C[5].getValue()||"";a=this.Tb.parse(a);isNaN(a)?this.V="Please enter a numeric value.":0>a&&(this.V="Please enter a non-negative value.")};p.XHb=function(a){switch(a.target.getId()){case "general-settings-tab":Q(this.Ua,!0);Q(this.Aa,!1);break;case "calculation-settings-tab":Q(this.Ua,!1),Q(this.Aa,!0)}};
function iKf(a){var b=a.C,c=b[2].yf().getValue(),d=b[3].yf().getValue();a=b[4].getValue()||"";b=b[5].getValue()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new QJf(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}function jKf(a){var b=a.C;a=a.L.L;var c=b[0].yf();c=null==c?a.C:c.getValue();b=b[1].yf();b=null==b?a.H||WGc().name():b.getValue();return new TGc(c,b)}function kKf(a,b,c){a=a.C[b].yf();return null!=a&&a.getValue()!=c}
function lKf(a){el(a.L.D.C,function(){pt(a.qa()).location.reload()})}p.La=function(){Ad(this.C,F);delete this.C;TJf.Ba.La.call(this)};function mKf(a,b,c,d,e,f,h,k){bz.call(this,void 0,!1,k);this.R=this.J=this.O=this.ma=this.V=null;this.Ua=a;this.C=b;this.Aa=h;this.F=[];this.Ka=new P2d(a,d,e,f);this.L=C(B(),"docs-egmd")}x(mKf,bz);p=mKf.prototype;
p.Ca=function(){bz.prototype.Ca.call(this);var a=this.qa();if(this.L){var b=Mx(this);dv(b,"waffle-sort-dialog-gm");dv(b,"docs-material")}var c=this.C.Nc();b=lM(Jk(c));var d=lM(new ak(c.left+c.width-1,c.top+c.height-1));this.setTitle("Sort range from "+(b+(" to "+d)));nKf||(b=new Px,this.L?(b.set("cancel","Cancel",!1,!0),b.set("save","Sort")):(b.set("save","Sort"),b.set("cancel","Cancel",!1,!0)),nKf=b);Sx(this,nKf);Zx(this,"save");var e;b=a.Ca("DIV","waffle-sort-dialog-data-header",d=a.Ca("SPAN",this.L?
void 0:"jfk-checkbox"),e=a.Ca("SPAN","waffle-sort-dialog-data-header-checkbox-label","Data has header row"));var f=this.R=this.L?new LR(!1,MR.getInstance(),a):new NR(void 0,a);f.Xa(d);KR(f,e);1==c.height&&f.Pa(!1);JM(this.Ua,this.C.yc(),c,!1)||(f.qc(!0),f.Pa(!1));C(B(),"fetdrisd")&&ritz_api.TablesApi.getTables((new Hi).serialize(Pk(c,this.C.yc())),y(function(h){if(0<h.length){var k=h[0];h=Rk(k.getDimensionTableAccessor().getHeaderRange());if(k=ritz_api.TablesApi.isRowBased(k)&&1==zua(Nk(h)))k=Pk(c,
this.C.yc()),k=h.Db()==k.Db()&&uua(Nk(h),Nk(k))&&uua(Ok(h),Ok(k));k&&f.qc(!0)}},this));d=this.Ob();a.appendChild(d,b);this.V=a.Ca("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ca("TABLE",{cellSpacing:"0",width:"100%"},this.ma=a.Ca("TBODY")));a.appendChild(d,this.V);b=oKf(this);this.F.push(b);this.L?(this.J=new Jv("Add another sort column",Iv.getInstance(),a),this.Ia(this.J,!0),ht(this.J.getElement(),!0)):(b=a.Ca("SPAN","menuMainLink waffle-sd-add","+ Add another sort column"),
a.appendChild(d,b),ht(b,!0),Tu(b,"button"),this.O=b)};p.Ja=function(){bz.prototype.Ja.call(this);var a=this.getHandler();a.listen(this,"dialogselect",this.cUb).listen(this.R,"change",this.Awb);this.L?a.listen(this.J,"action",this.QKa):a.og(this.O,xl,this.QKa)};
function oKf(a){var b=a.qa(),c=0==a.F.length,d=new pKf(a,c,a.C,a.F.length,b),e=b.Ca("TR",null,b.Ca("TD",{colspan:a.L?"5":"4"},b.Ca("DIV","waffle-sd-row-separator")));d.render(a.ma);b.appendChild(a.ma,e);c||(b=a.getHandler(),d.C&&b.og(d.C,xl,y(a.j$a,a,d)));a=qKf(a);rKf(d,a);return d}p.j$a=function(a){var b=this.F;if(1<b.length){var c=Fc(b,a);-1!=c&&($c(b,c),b=a.getElement(),b=ct(b),a.dispose(),Zs(b),this.O&&(Q(this.O,!0),this.O.focus()),this.J&&this.J.setVisible(!0),jJ("Sort criteria removed."))}};
function qKf(a){var b=a.C.Nc(),c=b.Cc();b=b.hd();var d=Jc(a.F,function(k){return sKf(k)},a);if(d)for(var e=a.C.ON(d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.LE(f);if(!Qc(d,h))return h}return null}p.Awb=function(){for(var a=this.F,b=0;b<a.length;b++)rKf(a[b])};
p.QKa=function(){var a=Ik(this.C.Nc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(oKf(this)),jJ("Sort criteria added."));ou(Dc(this.F).getElement(),this.V,!0);this.V.scrollLeft=0;this.F.length>=a&&(this.L&&this.J?this.J.setVisible(!1):Q(this.O,!1))};
p.cUb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(sKf(e));e=e.F.isChecked();b.push(e?1:0)}c=this.C.Nc();d=Ik(c,"r");this.R.isChecked()&&1<d&&(c=oua(c,-1));d=Av(new zv,1).build();this.Aa.C(this.R.isChecked()?35697:35698,d);a=new M2d(a,b,this.C,c,this.R.isChecked());Q2d(this.Ka,this.C,a)}};p.La=function(){bz.prototype.La.call(this);ue(this.F)};var nKf=null;
function pKf(a,b,c,d,e){R.call(this,e);this.L=this.O=this.F=this.D=this.C=null;this.R=-1;this.ma=a;this.H=b;this.J=c;this.V=C(B(),"docs-egmd")}x(pKf,R);function sKf(a){return(a=a.D.yf())?a.getValue():-1}
pKf.prototype.Ca=function(){var a=this.qa(),b=this.H?"Sort by":"then by",c,d;var e=zt("delete-grey600-24");this.H||(this.C=this.V?Iw(iz,{icon:e}):a.Ca("SPAN",{title:"Remove sort criteria."},"x"));var f=a.Ca("TD","waffle-sd-delete",this.H?"":this.C),h=a.Ca("TD","waffle-sd-td-rules",a.Ca("LABEL",{id:Hu(this,"csl")},b)),k=b=a.Ca("TD","waffle-sd-column-selector"),l=a.Ca("TD","waffle-sd-td-ascending",d=a.Ca("DIV",null,c=a.Ca("DIV",{"class":"waffle-sort-dialog-radio-option",title:"Ascending"}),e=a.Ca("DIV",
{"class":"waffle-sort-dialog-radio-option",title:"Descending"})));f=this.V?a.Ca("TR","waffle-sd-tr-rules",h,k,l,f):a.Ca("TR","waffle-sd-tr-rules",f,h,k,l);Tu(d,"radiogroup");d=this.F=new eY(a,rt(a,QE(rD(!0,this.Ie()))),"ascending");d.render(c);a=this.O=new eY(a,rt(a,QE(rD(!1,this.Ie()))),"descending");a.render(e);this.L=new fY([d,a]);gY(this.L,d);a=this.D=dGf();a.render(b);Uu(a.getElement(),"label",this.H?"Select first column to sort by:":"Select next column to sort by:");this.C&&(ht(this.C,!0),Tu(this.C,
"button"),Xu(this.C,"Remove sort criteria."));this.Cb(f)};function rKf(a,b){var c=a.qa(),d=a.ma.R.isChecked(),e=a.J.Nc(),f=e.Ac(),h=e.Cc();e=e.hd();a.R=b||sKf(a);for(b=a.D.ji();0<b;b--)a.D.ym(0);for(;h<e;h++)b=ae(WH(a.J.Bh(f,h)),25),b=new Nv(td(b)||!d?"Column "+hM(h):b,a.J.LE(h),c),b.ld("waffle-sd-menu-item"),a.D.Tc(b);a.D.Xe(0);0<=a.R&&a.D.setValue(a.R)}pKf.prototype.La=function(){R.prototype.La.call(this);this.D=this.C=this.J=this.ma=null;F(this.F);F(this.O);F(this.L);this.L=this.O=this.F=null};function tKf(a,b,c,d){K4.call(this,a,b,c,d,!1)}x(tKf,K4);tKf.prototype.L=n("The original file can be restored from version history");function uKf(a,b,c){return h6a(a||"There was a problem",Km(b),void 0,void 0,void 0,void 0,c)};function vKf(){E.call(this)}A(vKf,$I);p=vKf.prototype;p.rib=function(){return uKf};p.Sib=function(){return JJf};p.zXb=function(a,b,c,d){var e=new hz;a=new Yx(a,b,c,d,void 0,!0,void 0);Zx(a,"ok");b=y(e.Xa,e);a.Zqa=b;a.va(e);a.$i=!0;a.haa=qsa(td);return a};p.Dkb=function(){return zJf};p.S9a=function(a,b,c,d,e,f,h){return new mKf(a,b,c,d,e,f,h,void 0)};p.Q9a=function(a,b,c,d,e){return new mJf(a,b,c,d,e)};p.bjb=function(){return JGf};p.XIa=function(){return AHf};p.Mna=function(){return HHf};p.WIa=function(){return IHf};
p.gIa=function(){return JHf};p.rjb=function(){return RHf};p.Ikb=function(){return TJf};p.Hkb=function(){return hJf};p.okb=function(){return ZHf};p.Gkb=function(){return NJf};p.Wib=function(){return aGf};p.Ekb=function(){return YFf};p.Fkb=function(){return vHf};p.Vib=function(){return L4};p.ljb=function(){return CFf};p.hlb=function(){return tKf};p.Dib=function(){return GFf};p.tib=function(){return DFf};fJ("dialogs",vKf);
