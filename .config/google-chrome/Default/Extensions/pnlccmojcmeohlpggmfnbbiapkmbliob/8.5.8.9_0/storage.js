// Copyright (C) 1999-2019 Siber Systems Inc. All Rights Reserved.
var nPageIndex=Math.floor(100001*Math.random()),g_default_settings={"nm-settings":{toolbar:g_isfirefox,"popup-windows-toolbar":!0,popup:!0,horizontal:!1,focus:!0,"open-startpage-on-empty-tabs":!1},"sa-generator":{rf_pwd_generate_number_symbols:16,rf_pwd_generate_number_digits:1,rf_pwd_generate_upper_chk:1,rf_pwd_generate_lower_chk:1,rf_pwd_generate_digits_chk:1,rf_pwd_generate_copycliboardp_chk:0,rf_pwd_generate_special_chars:"!@#$%^&",rf_pwd_generate_specialsymb_chk:1,rf_pwd_generate_excludesimilar_chk:1,rf_pwd_generate_onlyhexvalues_chk:0,rf_pwd_generate_avdsection_open:!0},"sa-search":{rf_search_yahoo_chk:0,rf_search_google_chk:0,rf_search_roboform_chk:1,rf_search_bing_chk:1,rf_search_ebay_chk:1,rf_search_amazon_chk:0},"sa-settings":{rf_fill_empty_fields_chk:!1,rf_highlight_filledflds_chk:!1,rf_match_fillsubmitaction:!0,rf_identity_fillsubmitaction:!1,rf_cachemp_onbrowser_close_chk:!1,MruMaxNumber:8,"sa-turnoff-browser-pwdmanager-chk":!0},recent:{items:[]},"sa-auto-save":{rf_show_autosavebar:!0,rf_alt_click_forces_autosave:!0,rf_shift_enter_forces_autosave:!0,rf_show_auto_save_blocking_confirm:!0,rf_show_auto_save_unblocking_confirm:!0,rf_show_folder_field_in_dialog:!0,rf_current_selected_folder:"",blocking:[]},"sa-user":{rf_username:"",rf_accpwd:"",rf_masterpwd:"",rf_timeout_select:1440},keyboard:{"allow-shortcuts":!0,"ctrl-key":!1,"alt-key":!0,"shift-key":!1,"right-alt":!1,shortcuts:[{name:"show-options",code:79,checked:!0},{name:"reset-fields",code:189,checked:!0},{name:"set-fields",code:187,checked:!0},{name:"clear-fields",code:48,checked:!0}]},internal:{"first-start":!1,"is-nm":!1,"is-sa":!1,"need-repair":!1,"active-server":"https://online.roboform.com","icon-server":"https://online.roboform.com"}},bExtApi=browser&&browser.storage,aSections=["nm-settings","sa-generator","sa-search","sa-settings","recent","sa-auto-save","sa-user","internal","keyboard"],g_storage_settings=void 0;if(bExtApi){function BrowserStorageOnChange(e,t){if(t&&"local"==t)for(key in e){var r=e[key];null==r.newValue?delete g_storage_settings[key]:g_storage_settings[key]=r.newValue}}browser.storage.onChanged.addListener(BrowserStorageOnChange)}else{var storageHandler=function(e){e.key};window.addEventListener("storage",storageHandler,!1)}function InitStorageAsync(e){bExtApi?g_storage_settings?e():GetAllSettingsAsync(e):e()}function GetAllSettingsAsync(e){g_storage_settings={},browser.storage.local.get(aSections,function(t){if(browser.runtime.lastError)return browser.runtime.lastError,void e();for(var r=!0,o=0;o<aSections.length;o++)void 0!==t[aSections[o]]&&(r=!1,g_storage_settings[aSections[o]]=t[aSections[o]]);if(r){for(o=0;o<aSections.length;o++)try{void 0!==localStorage[aSections[o]]&&(g_storage_settings[aSections[o]]=localStorage[aSections[o]])}catch(e){}browser.storage.local.set(g_storage_settings,function(){browser.runtime.lastError&&browser.runtime.lastError}),e()}else e()})}function ClearSensitiveSettingsAsync(){PutSettingsforSectionAsync("sa-user",[{rf_masterpwd:""},{rf_accpwd:""}])}function ClearNmSettingsAsync(){browser.storage.local.remove("nm-settings",function(e){browser.runtime.lastError&&browser.runtime.lastError})}function ClearSaSettingsAsync(){browser.storage.local.remove(["sa-generator","sa-search","sa-settings","recent","sa-user","keyboard"],function(e){browser.runtime.lastError&&browser.runtime.lastError})}function PutSettingsforSectionAsync(e,t){if(e){for(var r=GetSection2(e),o=0;o<t.length;o++){var s=t[o];for(var a in s)r[a]=s[a]}var n=JSON.stringify(r),i={};i[e]=n,g_storage_settings[e]=n,browser.storage.local.set(i,function(){browser.runtime.lastError&&browser.runtime.lastError})}}function PutSettingAsync(e,t,r){if(e){var o=GetSection2(e);o[t]=r;var s=JSON.stringify(o),a={};a[e]=s,g_storage_settings[e]=s,browser.storage.local.set(a,function(){browser.runtime.lastError&&browser.runtime.lastError})}}function GetSetting2(e,t,r){var o=GetSection2(e)[t];if(void 0===o)if(void 0===r){var s=g_default_settings[e];s&&(o=s[t])}else o=r;if("string"==typeof o)switch(o.toLowerCase()){case"true":return!0;case"false":return!1}return o}function GetSection2(e){var t={};if(!e)return t;var r=g_storage_settings[e];if(!r)return format("Section %1 was not found",e),t;try{t=JSON.parse(r)}catch(t){format("Invalid value for section %1. Not a valid JSON value: %2",e,r)}return t}function ClearSensitiveSettings(){bExtApi?ClearSensitiveSettingsAsync():PutSettingsforSection("sa-user",[{rf_masterpwd:""},{rf_accpwd:""}])}function ClearNmSettings(){if(bExtApi)ClearNmSettingsAsync();else try{localStorage.removeItem("nm-settings")}catch(e){}}function ClearSaSettings(){if(bExtApi)ClearSaSettingsAsync();else try{localStorage.removeItem("sa-generator"),localStorage.removeItem("sa-search"),localStorage.removeItem("sa-settings"),localStorage.removeItem("recent"),localStorage.removeItem("sa-user"),localStorage.removeItem("keyboard")}catch(e){}}function GetSection(e){var t,r={};if(!e)return r;try{t=localStorage[e]}catch(e){return r}if(!t)return format("Section %1 was not found",e),r;try{r=JSON.parse(t)}catch(r){format("Invalid value for section %1. Not a valid JSON value: %2",e,t)}return r}function PutSettingsforSection(e,t){if(bExtApi)PutSettingsforSectionAsync(e,t);else if(e){for(var r=GetSection(e),o=0;o<t.length;o++){var s=t[o];for(var a in s)r[a]=s[a]}try{localStorage[e]=JSON.stringify(r)}catch(e){}}}function PutSetting(e,t,r){if(bExtApi)PutSettingAsync(e,t,r);else if(e){var o=GetSection(e);o[t]=r;try{localStorage[e]=JSON.stringify(o)}catch(e){}}}function GetSetting(e,t,r){if(bExtApi)return GetSetting2(e,t,r);var o=GetSection(e)[t];if(void 0===o)if(void 0===r){var s=g_default_settings[e];s&&(o=s[t])}else o=r;if("string"==typeof o)switch(o.toLowerCase()){case"true":return!0;case"false":return!1}return o}var aes_IV="101112131415161718191a1b1c1d1e1f";function decryptAccountPwd(e,t){var r=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(e)}),o=CryptoJS.enc.Latin1.parse(CryptoJS.enc.Latin1.stringify(CryptoJS.SHA256(t))),s=CryptoJS.enc.Hex.parse(aes_IV),a=CryptoJS.AES.decrypt(r,o,{iv:s}).toString(CryptoJS.enc.Utf8),n=RfapiJS.utils.base64ToBytes(a),i=RfapiJS.UTF8.bytesToString(n);return i}function encryptAccountPwd(e,t){var r=RfapiJS.UTF8.stringToBytes(e),o=RfapiJS.utils.bytesToBase64(r),s=CryptoJS.enc.Latin1.parse(CryptoJS.enc.Latin1.stringify(CryptoJS.SHA256(t))),a=CryptoJS.enc.Hex.parse(aes_IV),n=CryptoJS.AES.encrypt(o,s,{iv:a}).toString(),i=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(n)});CryptoJS.AES.decrypt(i,s,{iv:a}).toString(CryptoJS.enc.Utf8);return n}
//# sourceMappingURL=storage.js.map