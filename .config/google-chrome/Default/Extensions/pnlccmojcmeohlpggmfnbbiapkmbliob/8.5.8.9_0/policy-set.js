// Copyright (C) 1999-2019 Siber Systems Inc. All Rights Reserved.
var RfUTF8=RfapiJS.UTF8;function PolicySet(){this.Init()}PolicySet.prototype.Init=function(){this.g_passwordExpired=!1,this.g_forcePasswordChange=!1,this.g_passwordAgeDays=-1,this.g_passwordDaysLeft=1e4,this.have_values=!1,this.m_blob="",this.m_sections={},this.m_domain_equiv={},this.m_white_list_domains=[],this.m_black_list_domains=[],this.m_default_sections={},this.m_default_sections.CONFIG={},this.m_default_sections.CONFIG[ConfigMasterPasswordMinLength]=6,this.m_default_sections.CONFIG[ConfigMasterPasswordMaxLength]=80,this.m_default_sections.CONFIG[ConfigMasterPasswordMinNonNumChars]=0,this.m_default_sections.CONFIG[ConfigMasterPasswordMinDigitChars]=0,this.m_default_sections.CONFIG[ConfigMPRotationTimeDays]=0,this.m_default_sections.CONFIG[ConfigDisableChangeMasterPassword]=!1,this.m_default_sections.CONFIG[ConfigMasterPasswordMinUpperCaseChars]=0,this.m_default_sections.CONFIG[ConfigMasterPasswordMinLowerCaseChars]=0,this.m_default_sections.CONFIG[ConfigDisableLogoff]=!1,this.m_default_sections.CONFIG[ConfigDisableCreateLogins]=!1,this.m_default_sections.CONFIG[ConfigDisableCreateIdentities]=!1,this.m_default_sections.CONFIG[ConfigDisableCreateBookmarks]=!1,this.m_default_sections.CONFIG[ConfigDisableCreateContacts]=!1,this.m_default_sections.CONFIG[ConfigDisableCreateAppLogins]=!1,this.m_default_sections.CONFIG[ConfigDisableCreateSafenotes]=!1,this.m_default_sections.CONFIG[ConfigShowPasswordsAsStarsInEditor]=!1,this.m_default_sections.CONFIG[ConfigDisableSharing]=!1,this.m_default_sections.CONFIG[ConfigDisableSharingOutsideCompany]=!1,this.m_default_sections.CONFIG[ConfigDisableEmergencyAccess]=!1,this.m_default_sections.CONFIG[ConfigAllowedEmergencyAccessUsers]=0,this.m_default_sections.CONFIG[ConfigWhiteListURLs]="",this.m_default_sections.CONFIG[ConfigBlackListURLs]="",this.m_default_sections.CONFIG[ConfigEnrollNewDevice]=-1,this.m_default_sections.CONFIG[ConfigDisableNonGroupData]=!1,this.m_default_sections.OPTIONS={},this.m_default_sections.OPTIONS[OptionsStoreMPInSystemProtectedStorage]=!0,this.m_default_sections.OPTIONS[OptionsAutoSaveEnable]=-1,this.m_default_sections.OPTIONS[OptionsConfirmAutoFillEnable]=!1,this.m_default_sections.OPTIONS[OptionsAutoLogoffTimeMins]=-1,this.m_default_sections.OPTIONS[OptionsEnforceOTP]=!1,this.m_default_sections.OPTIONS[OptionsDisableOTPViaSMS]=!1,this.m_default_sections.OPTIONS[OptionsDisableMobileDevices]=!1,this.m_default_sections.OPTIONS[OptionsEnrollDevicesForDays]=0,this.m_default_sections.OPTIONS[OptionsAllowedIPRanges]="",this.m_default_sections["DOMAINS EQUIV"]={},this.m_default_sections["DOMAINS EQUIV"][DomainsDomEqCount]=0,this.m_default_sections["DOMAINS EQUIV"][DomainsDomEqVer]=1},PolicySet.prototype.ParseBlob=function(i){if(this.have_values=!1,this.Init(),!i)return!0;var t=RfUtils.base64ToBytes(i);if(t=RfUTF8.bytesToString(t))if("{"==t[0]){var s=JSON.parse(t),e=s&&s.policies;if(e){var o=this;forEachOwnProp(e,function(i,t){void 0===o.m_sections.CONFIG&&(o.m_sections.CONFIG={}),void 0===o.m_sections.CONFIG[_[0]]&&(o.m_sections.CONFIG[_[0]]={}),o.m_sections.CONFIG[t]=i,o.have_values=!0})}}else{for(var n="",a=t.split("\r\n"),l=0;l<a.length;l++){var r=a[l];if(r.length>2&&"["==r[0]&&"]"==r[r.length-1])n=r.substr(1,r.length-2);else{var _=r.split("=");if(Array.isArray(_)&&_.length>1&&_[0]&&n){var h=_.shift(),f=_.join("=");f&&(void 0===this.m_sections[n]&&(this.m_sections[n]={}),void 0===this.m_sections[n][h]&&(this.m_sections[n][h]={}),this.m_sections[n][h]=f)}}}this.have_values=!0}else;return this.have_values&&(this.m_blob=i),this.RfInitDomainEquivalence(this.RfGetDomainEquivalenceLines()),this.LoadDomainListsPolicies(),!0},PolicySet.prototype.GetValue=function(i,t,s){if(s=this.GetDefaultValue(i,t,s),void 0===i||void 0===t)return s;if(void 0===this.m_sections[i]||void 0===this.m_sections[i][t])return this.GetDefaultValue(i,t,s);var e=this.m_sections[i][t];if(void 0===s)return e;switch(typeof s){case"boolean":return"1"==e;case"number":var o=parseInt(e);return isNaN(o)?this.GetDefaultValue(i,t,s):o;case"string":default:return e}},PolicySet.prototype.GetConfigValue=function(i,t){return this.GetValue("CONFIG",i,t)},PolicySet.prototype.GetOptionsValue=function(i,t){return this.GetValue("OPTIONS",i,t)},PolicySet.prototype.GetDomainsEquivValue=function(i,t){return this.GetValue("DOMAINS EQUIV",i,t)},PolicySet.prototype.GetDefaultValue=function(i,t,s){return void 0!==s?s:void 0===this.m_default_sections[i]||void 0===this.m_default_sections[i][t]?s:this.m_default_sections[i][t]},PolicySet.prototype.RfGetDomainEquivalenceLines=function(){var i=[],t=this.GetDomainsEquivValue(DomainsDomEqCount);if(1==this.GetDomainsEquivValue(DomainsDomEqVer))for(var s=0;s<t;s++){var e=this.GetDomainsEquivValue(s);e&&i.push(e)}return i},PolicySet.prototype.RfInitDomainEquivalence=function(i){if(this.m_domain_equiv=[],Array.isArray(i))for(var t=0;t<i.length;t++){var s=i[t].split("=");this.m_domain_equiv.push([]);for(var e=0;e<s.length;e++){var o=s[e].trim();o&&(o=RfUtils.DomainFromUrl(o,!0))&&this.m_domain_equiv[t].push(o)}}},PolicySet.prototype.GetEqualDomains=function(i){var t=[];if(i=i.trim()){var s=RfUtils.DomainFromUrl(i,!0);if(s)for(var e=0;e<this.m_domain_equiv.length;e++){var o=this.m_domain_equiv[e];if(-1!=o.indexOf(s))for(var n=0;n<o.length;n++)-1==t.indexOf(o[n])&&t.push(o[n])}}return 0==t.length&&t.push(i),t},PolicySet.prototype.LoadDomainPolicy=function(i,t){if(i)for(var s=i.split("\\n"),e=0;e<s.length;e++){var o=s[e];o&&((o=RfUtils.DomainFromUrl(o,!0))&&t.push(o))}},PolicySet.prototype.LoadDomainListsPolicies=function(){this.m_white_list_domains=[],this.m_black_list_domains=[],this.LoadDomainPolicy(this.GetConfigValue(ConfigWhiteListURLs),this.m_white_list_domains),this.LoadDomainPolicy(this.GetConfigValue(ConfigBlackListURLs),this.m_black_list_domains)},PolicySet.prototype.IsRoboFormEnabledOnUrl=function(i){if(!i)return!1;var t=RfUtils.DomainFromUrl(i,!0);if(!t)return!1;var s=this.m_white_list_domains&&this.m_white_list_domains.length,e=this.m_black_list_domains&&this.m_black_list_domains.length,o=!1,n=!1;if(this.m_white_list_domains&&0!=this.m_white_list_domains.length&&(o=-1!=this.m_white_list_domains.indexOf(t)),this.m_black_list_domains&&0!=this.m_black_list_domains.length&&(n=-1!=this.m_black_list_domains.indexOf(t)),!s&&!e)return!0;if(!s&&e)return!n;if(s&&!e)return!!o;if(s&&e){if(o&&n)return!1;if(o&&!n)return!0;if(!o&&n)return!1;if(!o&&!n)return!1}return!0};
//# sourceMappingURL=policy-set.js.map