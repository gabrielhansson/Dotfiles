// Copyright (C) 1999-2019 Siber Systems Inc. All Rights Reserved.
if(void 0===filler_js_loaded)var filler_js_loaded=1,RFNAME_USERID="User ID$",RFNAME_PASSWORD="Password$",RFNAME_NONAME="-no-name-",RF_DEFAULT_VALUE_HERE="$DefaultValue$",RF_ANY_VALUE_HERE="$AnyValueHere$",RFNAME_SUBMIT="Submit$",RFNAME_LOGINTIP="LoginTip$",RFNAME_BASICAUTH="Basic Auth$",RFNAME_NEWACCOUNT="New Account$",RFNAME_NOTE="Note$",RFNAME_NOTEOLD="$Note$",RFNAME_NOAUTOFILL="-NoAutoFill-",RFNAME_NOAUTOFILLFROMIDENTITY="-NoAutoFillFromIdentity-",RFNAME_NOAUTOFILLFROMPASSCARD="-NoAutoFillFromPasscard-",RFNAME_NOAUTOSAVE="-NoAutoSave-",RF_MIN_BUTTON_DISTANCE=5,user_pass_diff_dist=200,RF_MIN_HORIZ_DIST=20,RF_MAX_NODES_VISITED=30,RF_SAME_LINE_DIST=10,RF_BAD_OFFSET=-1,RF_LEVEL_START=100,MATCH_STAR=9733,RF_DEFAULT_HEIGHT=10,RF_DEFAULT_WIDTH=50,RF_FAR_UPPER_DIST=200,RF_VERT_LINE_DIST=15,ASCII_CENT_SIGN_CHAR=162,ASCII_POUND_STERLING_CHAR=163,ASCII_YEN_SIGN_CHAR=165,RF_LOWER_LINE_DIST=30,eBC_SIZE_DW=4,DEF_INSTANCE="Main",CRLF="\r\n",RF_BLOCK_FILL_PASSCARD=1,RF_BLOCK_FILL_IDENTITY=2,RF_BLOCK_SAVE=4,RF_BLOCKING_PASSCARD=16,RF_SET_FIELDS_VALUE="set fields value",RF_SAVE_BUTTON_ID="rf_save_button_id",RF_DIV_TBAR_SAVE="rf_div_tbar_save",RF_DIV_TBAR_CLOSE="rf_div_tbar_close",RF_CLOSE_BUTTON_ID="rf_close_button_id",RF_PASSCARD_INPUT_ID="rf_passcard_input_id",RF_FOLDERS_SELECT_ID="rf_folders_select_id",RF_PROTECT_BOX_ID="rf_protect_chkbox_id",RF_DIV_TBAR_TEXT="rf_div_tbar_text",RF_DIV_TBAR_PASSWORD="rf_div_tbar_password",RF_MP_SAVEBTN_ID="rf_mp_savebtn",RF_MP_CHECKBTN_ID="rf_mp_checkbtn",RF_MASTERPASSCONFIRM_ID="rf_masterpassconfirm_input",RF_MASTERPASS_INPUT_ID="rf_masterpass_input",RF_MP_CANCELBTN="rf_mp_cancelbtn",RfFieldType={RfField_None:0,RfFieldText:1,RfFieldPassword:2,RfFieldCheckbox:3,RfFieldRadioCheck:4,RfFieldRadio:5,RfFieldTextArea:6,RfFieldSelect:7,RfField_Last:8},EnNodeType={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},FillRetCode={FillCodeUndefined:0,FillCodeTryAgain:1,FillCodeNoFormsFound:2,FillCodeBlockingPasscard:3,FillCodeNoMatchingFields:4,FillCodeNoDifferentFields:5,FillCodeFieldNonEmpty:6,FillCodeFieldFilled:7},RfObjectType={RFTYPE_NONE:0,RFTYPE_IDENTITY:1,RFTYPE_PASSCARD:2,RFTYPE_SAFENOTE:3,RFTYPE_PSEUDE_FIRST:1024,RFTYPE_SEARCH_QUERY:1025,RFTYPE_FOLDER:1026,RFTYPE_INSTANCE:1027,RFTYPE_PSEUDE_LAST:1028},EnResultCode={enSuccess:0,enFoundNoButtons:1,enFilledNoForms:2,enFilledTwoOrMoreForms:3},RfObjectMode={RF_OBJ_MODE__FIRST:256,RF_OBJ_MODE_DEF:256,RF_OBJ_MODE_BOOKMARK:257,RF_OBJ_MODE_QUERY:272,RF_OBJ_MODE_CONTACT:512,RF_OBJ_MODE_USERDATA:1535,RF_OBJ_MODE_BLOCK_PC_OLD:1536,RF_OBJ_MODE_BLOCK_PC:1537,RF_OBJ_MODE__LAST:1537,RF_OBJ_MODE_ALL:32678,RF_OBJ_MODE_ALL_NONPARAMETRIC:36864},rfjs_EnRfSetClearFields={RF_CLEAR_FIELDS:0,RF_SET_FIELDS:1,RF_RESET_FIELDS:2},rfjs_PageStatus={RfPageInitial:0,RfPageLoading:1,RfPageInteractive:2,RfPageComplete:3},CPrecision={precisionSubstring:0,precisionExact:1},CSectionType={Literal:0,Variable:1},CPartType={Number:0,Variable:1},CFieldType={Basic:0,Partition:1,Computed:2,Unknown:3,Memorized:4},rfRangeOptions={START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3};function pad_str(e,t){var i=t>e.length?t-e.length:0;return e+" ".repeat(i)}function cloneObject(e){var t={};for(var i in e)t[i]=e[i].clone();return t}function copyArray(e){return e.map(function(e){return e})}function trimLeft(e){return e.replace(new RegExp("^\\s+"),"")}function trimRight(e){return e.replace(new RegExp("\\s+$"),"")}function extend(e,t){try{var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.superclass=t.prototype}catch(e){logStringMessage("extend function Error: "+e,!0)}}function RfSelectionInfo(){this.m_nMozSmthSelected=!0,this.m_pRange=null,this.m_pTestingRange=null,this.m_pMozBridge=null,this.m_nMozSmthSelected=0}function getSelectionHtml(e,t){var i="";if(e.rangeCount){for(var n=t.createElement("div"),r=0,s=e.rangeCount;r<s;++r)n.appendChild(e.getRangeAt(r).cloneContents());i=n.innerHTML}return i}function RfPrepareSelectionRanges(e,t){try{logStringMessage("+++ RfPrepareSelectionRanges  selection_info = "+t);var i=e,n=null,r="undefined"!=typeof window?window:i.defaultView;if(!r)return logStringMessage("--- window is null!"),!1;if(n=r.getSelection(),logStringMessage("Filling with SELECTION: pSelection='"+n+"' typeof='"+typeof n+"'"),!n)return logStringMessage("--- Selection is empty!  pSelection="+n),!1;if(0==n.rangeCount)return logStringMessage("--- rangeCount of the selection is 0!"),!1;var s=n.rangeCount;logStringMessage("Filling with SELECTION: rangeCount="+s);for(var a=0;a<s;a++){var o=n.getRangeAt(a);t.m_pRange=o,logStringMessage("Filling with SELECTION: range="+o+" INDEX:"+a)}var l=getSelectionHtml(n,i);if(!l)return logStringMessage("--- cannot get HTML text\n"),!1;if(l.indexOf("<input")<0&&l.indexOf("<select")<0&&l.indexOf("<textarea")<0)return logStringMessage("--- no form elements in selection\n"),!1;if(logStringMessage("Filling with SELECTION: html="+l),!i.body)return logStringMessage("--- no body for selection 2\n"),!1;if(t.m_pTestingRange=i.createRange(),!t.m_pTestingRange)return logStringMessage("--- cannot create text range 2"),!1}catch(e){logStringMessage("RfPrepareSelectionRanges error: "+e)}}function RfSetClearFieldsDoc(e,t,i,n,r){try{logStringMessage("+++RfSetClearFieldsDoc: pDoc="+e+" nSet="+t+"  bSetValue="+n+" selection="+i+" sSetValue="+r);var s=new CRfHtmlInputIterator;s.Build2(e);var a=s.GetSizeofArray();if(0==a)return logStringMessage("---RfSetClearFieldsDoc: empty collection\n"),!0;for(var o=a,l=0;l<o;++l){var m=s.GetNext();if(!m)break;var _=new CRfHtmlObjectProperties;if(RfIsElemVisible(m,_)){if(logStringMessage("---RfSetClearFieldsDoc: iterate via elements nIndex="+l+"  TAG:"+_.sTagName+" NAME:"+_.sName),i&&i.m_pTestingRange){var d=i.m_pRange;i.m_pTestingRange.selectNodeContents(m);var u=d.compareBoundaryPoints(rfRangeOptions.START_TO_END,i.m_pTestingRange);if(logStringMessage("---RfSetClearFieldsDoc: RANGE:"+u),u<=0){logStringMessage("The selection is before the element... CONTINUE..");continue}if(d.compareBoundaryPoints(rfRangeOptions.END_TO_START,i.m_pTestingRange)>=0){logStringMessage("The selection is after the element...  CONTINUE..");continue}var f=d.compareBoundaryPoints(rfRangeOptions.START_TO_START,i.m_pTestingRange),p=d.compareBoundaryPoints(rfRangeOptions.END_TO_END,i.m_pTestingRange);f<0?p<0?logStringMessage("The selection is before the element but intersects it"):logStringMessage("The selection contains the element"):p>0?logStringMessage("The selection is after the element but intersects it"):0==f&&0==p?logStringMessage("The selected text and the element are the same"):logStringMessage("The selection is inside the element")}if(-1!=_.sTagName.indexOf("input"))if("text"==_.sType||"password"==_.sType){if(m.disabled)continue;if(logStringMessage("SetClearFields TEXT/PASSWORD: act="+t),t==rfjs_EnRfSetClearFields.RF_RESET_FIELDS){var h=m.defaultValue;logStringMessage("SetClearFields TEXT/PASSWORD: set defaultValue="+h),m.value=h}else t==rfjs_EnRfSetClearFields.RF_SET_FIELDS&&n?m.value=r:t==rfjs_EnRfSetClearFields.RF_CLEAR_FIELDS&&(m.value="")}else{if("radio"!=_.sType&&"checkbox"!=_.sType)continue;if(m.disabled)continue;if(logStringMessage("SetClearFields radio/check: act="+t),t==rfjs_EnRfSetClearFields.RF_RESET_FIELDS){var g=m.defaultChecked;g&&(g=!0),m.checked=g}else{var c=t==rfjs_EnRfSetClearFields.RF_CLEAR_FIELDS?0:1;m.checked=c}}else if(-1!=_.sTagName.indexOf("textarea")){var C=m;if(C.disabled)continue;if(logStringMessage("SetClearFields textarea: act="+t),t==rfjs_EnRfSetClearFields.RF_RESET_FIELDS){h=C.defaultValue;C.value=h}else t==rfjs_EnRfSetClearFields.RF_SET_FIELDS&&n?C.value=r:t==rfjs_EnRfSetClearFields.RF_CLEAR_FIELDS&&(C.value="")}else{if(-1==_.sTagName.indexOf("select"))continue;var F=m;if(F.disabled)continue;logStringMessage("##### SetClearFields <SELECT>: act="+t);var S=!1,b=F.multiple;if(logStringMessage("SetClearFields <SELECT>: bMultiple="+b),b||t!=rfjs_EnRfSetClearFields.RF_CLEAR_FIELDS)for(var R=F.length,T=0;T<R;T++){var N=F.item(T);if(t==rfjs_EnRfSetClearFields.RF_RESET_FIELDS){var y=N.defaultSelected;if(b)N.selected=y;else if(y){N.selected=!0,S=!0;break}}else if(t==rfjs_EnRfSetClearFields.RF_SET_FIELDS)if(b);else{var I=N.value;I=I.toString().toLowerCase();var E=N.text;E=E.toString().toLowerCase();var v=r;if(v=v.toString().toLowerCase(),n&&(I==r||E==v)){N.selected=!0;break}}else N.selected=!1}else logStringMessage("SetClearFields <SELECT>  CLear select set empty string"),F.value="",F.selectedIndex=-1;b||t!=rfjs_EnRfSetClearFields.RF_RESET_FIELDS||S||(logStringMessage("SetClearFields <SELECT> No default value found -- use the 1st value"),F.selectedIndex=0)}}else logStringMessage("---RfSetClearFieldsDoc: SKIP element:"+m)}}catch(e){logStringMessage("RfSetClearFieldsDoc error: "+e)}}function RfOnBeforeAction(e,t,i,n,r,s,a){if(a.m_bChecking)return!1;if(s&&s.m_pRange&&s.m_pTestingRange){var o=e,l=s.m_pRange;s.m_pTestingRange.selectNodeContents(o);var m=l.compareBoundaryPoints(rfRangeOptions.START_TO_END,s.m_pTestingRange);if(logStringMessage("---RfSetClearFieldsDoc: RANGE:"+m),m<=0)return logStringMessage("OnBeforeAction: elem is not in selection range "+e),!1;if(l.compareBoundaryPoints(rfRangeOptions.END_TO_START,s.m_pTestingRange)>=0)return logStringMessage("OnBeforeAction: elem is not in selection range "+e),!1;var _=l.compareBoundaryPoints(rfRangeOptions.START_TO_START,s.m_pTestingRange),d=l.compareBoundaryPoints(rfRangeOptions.END_TO_END,s.m_pTestingRange);return _<0?d<0?logStringMessage("The selection is before the element but intersects it"):logStringMessage("The selection contains the element"):d>0?logStringMessage("The selection is after the element but intersects it"):0==_&&0==d?logStringMessage("The selected text and the element are the same"):logStringMessage("The selection is inside the element"),!0}return!0}function CFormFiller(e){this.m_pIdentity=null,this.m_pPasscard=null,this.m_pPasswordElem=null,this.m_bCountFields=!1,this.m_NamesIndexes={},this.curDoc=null,this.m_bFillingStopped=!1,this.m_nFillAttempts=0,this.m_prev_field_name="",this.m_prev_part_no=0,this.m_bActuallyChanged=!1,this.m_bUseEnglishSelectValues=!1,this.m_bFillNonemptyFields=!0,this.m_nFieldsFilled_namenotvalue=0,this.m_nFieldsCounted_visible_fillable=0,this.m_nFieldsFilled_passwords=0,this.m_nFieldsFilled_unfilled=0,this.m_nFieldsFilled_unused=0,this.m_nFieldsCounted_text=0,this.m_nFieldsCounted_fillable=0,this.m_nFieldsCounted_passwords=0,this.m_nFieldsCounted_textarea=0,this.m_frc=FillRetCode.FillCodeUndefined,this.m_nFieldsFilled_name=0,this.m_FilledForms=[],this.m_pSelection=null,this.m_bEmptyValuesCauseFilling=!1,this.m_bAlwaysThrowEvents=!0,this.m_sLanguage="",this.bHighLightTextInput=!1,this.m_bSendEvents=!0,this.m_pfnFillFieldFromExternalCode=null,this.m_FieldsForExtenalFilling=[]}function while_async(e,t){return new Promise(function(i,n){!function r(){Promise.resolve().then(e).then(function(e){e?Promise.resolve().then(t).then(r).catch(function(e){n(e)}):i()}).catch(function(e){n(e)})}()})}function CallExternalFilling(e,t){var i=0;while_async(function(){return i<e.length},function(){var n=e[i];return i++,FillFieldFromExternalCode(n.elem,n.value,t)}).then(function(){t(void 0,void 0,void 0)}).catch(function(e){})}function FillFieldFromExternalCode(e,t,i){return new Promise(function(n,r){e.focus(),i(e,t,function(e){e?r(e):n()})})}function RfInitEventSender(e,t){if(RfUseModernWayEvents())e.SendKeyboardEvent=function(e,t,i,n){try{if(0===t.length)return;logStringMessage("Send keyboard-event '"+e+"' by constructor");var r=t.substr(-1),s={bubbles:!0,location:0,key:r,keyIdentifier:r,charCode:r,char:r,keyCode:r.charCodeAt(0)};g_isedge||(s.view=i.defaultView);var a=new KeyboardEvent(e,s);g_issafari&&(a.createdByRoboForm=!0),n.dispatchEvent(a)}catch(e){logStringMessage("*FILLER.JS* Exception in SendKeyboardEvent:"+e)}};else{var i=t.createEvent("KeyboardEvent");void 0!==i.initKeyEvent?e.SendKeyboardEvent=function(e,t,i,n){try{if(0===t.length)return;logStringMessage("Send keyboard-event '"+e+"' by initKeyEvent");var r=i.createEvent("KeyboardEvent");r.initKeyEvent(e,!0,!0,null,!1,!1,!1,!1,"a".charCodeAt(0),0),n.dispatchEvent(r)}catch(e){logStringMessage("*FILLER.JS* Exception in SendKeyboardEvent:"+e)}}:void 0!==i.initKeyboardEvent&&(e.SendKeyboardEvent=function(e,t,i,n){try{if(0===t.length)return;logStringMessage("Send keyboard-event '"+e+"' by initKeyboardEvent");var r=i.createEvent("KeyboardEvent");r.initKeyboardEvent(e,!0,!0,i.defaultView,t.substr(-1),0,"",!1,!1,!1,"en-US"),n.dispatchEvent(r)}catch(e){logStringMessage("*FILLER.JS* Exception in SendKeyboardEvent:"+e)}})}}function RfUseModernWayEvents(){if(void 0===RfUseModernWayEvents.bUseDOM3){var e=null;try{e=new KeyboardEvent("keypress",null),e=null,e=new MouseEvent("mousedown",null)}catch(e){}RfUseModernWayEvents.bUseDOM3=null!==e}return RfUseModernWayEvents.bUseDOM3}function RfSendMouseEvent(e,t,i){var n=null;if(RfUseModernWayEvents()){var r={bubbles:!0,cancelable:!0,button:0};g_isedge||(r.view=i.defaultView),n=new MouseEvent(e,r)}else(n=i.createEvent("MouseEvents")).initEvent(e,!0,!0);t.dispatchEvent(n)}function GetElemPlaceholder(e){if(e&&e.placeholder){var t=RfTrimCaption(e.placeholder);if(t)return new RegExp("\\S+@\\S+\\.\\S+").test(t)&&(t="email"),t}}function RfJoinCaptions(e,t){return e||t?e?t?e.indexOf(t)>=0?e:t.indexOf(e)>=0?t:e+" "+t:e:t:""}function ChooseSelectOption(e,t,i,n,r,s,a){try{null==a&&(a=!0),logStringMessage("+++ChooseSelectOption: bValueMatch="+s+" bIsName="+r+" sMainValue="+e+" sAltValue="+t),logStringMessage("+++ChooseSelectOption: plsValues="+i),logStringMessage("+++ChooseSelectOption: asOptions="+n);for(var o=[],l=n.length,m=0;m<l;m++)RfNormalizeSelectValue(n[m],o,null,a);logStringMessage("+++ChooseSelectOption asOptionsReduced.length="+o.length);var _=[];RfNormalizeSelectValue(e,_,null,a),""!=t&&RfNormalizeSelectValue(t,_,null,a);for(var d=i.length,u=0;u<d;u++)RfNormalizeSelectValue(i[u],_,null,a);var f,p,h=-1,g=-1,c=0,C=-1,F=0,S=0,b=0,R=0,T=!1,N=!1,y={nResult:0,nLength:0},I=RfReadNumber(e,y);p=y.nLength,f=y.nResult;var E=I&&p==e.length;logStringMessage("+++ChooseSelectOption bIsNumber="+E+" res="+I+" nLength="+p+" nMainValue="+f);for(m=0;m<o.length;m++){for(var v=o[m],M=new Set,A=0;A<_.length;A++){var x=_[A],O=x.m_bBracketsEncountered,P=x.m_sWhole,L=v.m_sWhole,k=O?P:x.m_sNormalized,D=O?L:v.m_sNormalized;if(s){if(!M.has(k))if(M.add(k),(B=D.indexOf(k))>=0){var w=k.length,V=D.length;if((w>=3||w==V)&&(RfIsStringHieroglyph(D)||r||(0==B||!RfIsCharAlphaNum(D[B-1]))&&(B+w>=V||!RfIsCharAlphaNum(D[B+w])))&&(w==V?++b:++R,logStringMessage("      value match: sOption='"+D+"' exact='"+b+"' inexact='"+R+"'"),(b>=2||b+R>=3)&&5*(b+R)>=o.length))return m}}else{if(""==L&&L==P){T=!0,C=m,F=0,S=0,N=!0,logStringMessage("   exact match: "+L+" == "+P);break}var B;if((B=D.indexOf(k))>=0){w=k.length,V=D.length;""==k||!RfIsStringHieroglyph(D)&&!r&&(0!=B&&RfIsCharAlphaNum(D[B-1])||!(B+w>=V)&&RfIsCharAlphaNum(D[B+w]))||(C<0||F>B||F==B&&V-w<S)&&(D==k&&(T=!0),C=m,F=B,S=V-w,logStringMessage("      fill match: index="+m+" pos="+B+" nLenDiff="+S+" sValue='"+k+"' sOption="+D+" bBestMatchExact="+T+" nBestMatchIndex="+C))}}}if(N)break;if(E){for(var G=0,U=[],H=D=n[m],Y=0;;){if(++Y>100)break;var W=H.indexOf("0"),j=H.indexOf("1"),z=H.indexOf("2"),K=H.indexOf("3"),X=H.indexOf("4"),J=H.indexOf("5"),Z=H.indexOf("6"),$=H.indexOf("7"),q=H.indexOf("8"),Q=H.indexOf("9");if(-1==W&&-1==j&&-1==z&&-1==K&&-1==X&&-1==J&&-1==Z&&-1==$&&-1==q&&-1==Q)break;-1==W&&(W=1e4),-1==j&&(j=1e4),-1==z&&(z=1e4),-1==K&&(K=1e4),-1==X&&(X=1e4),-1==J&&(J=1e4),-1==Z&&(Z=1e4),-1==$&&($=1e4),-1==q&&(q=1e4),-1==Q&&(Q=1e4);var ee=Math.min(W,j,z,K,X,J,Z,$,q,Q);H=H.substr(ee);var te=0,ie=0,ne={nResult:0,nLength:0};RfReadNumber(H,ne)&&(te=ne.nResult,ie=ne.nLength,G<10&&(U[G++]=te)),H=H.substr(ie)}var re=0;if(0==G)continue;1==G?(0==m&&f<=U[0]||m>=o.length-2&&f>=U[0])&&(re=1):2==G&&U[0]<=f&&f<=U[1]&&(re=2);for(var se=-1,ae=0;ae<G;ae++){var oe=U[ae];(se<0||Math.abs(oe-f)<se)&&(se=Math.abs(oe-f),Math.abs(oe-f)<2&&0==re&&(re=1))}(re>c||re==c&&(g<0||se<g))&&(h=m,c=re,g=se,logStringMessage("      found NUMBER match index="+h+" noNumbers="+G+" bestrange="+c+" nBestNumberMatchDifference="+g))}}var le=0;return le=E&&!T&&h>=0?h:C,logStringMessage("    ---ChooseSelectOption: rc="+le),le}catch(e){return logStringMessage("ChooseSelectOption error: "+e),0}}function checkForChangedElement(e,t,i,n,r){try{var s=e.getElementsByTagName(i.m_sTagName);if(!s)return!1;for(var a=s.length,o=0,l=0,m=0;m<a;m++){var _=s[m],d=_.getAttribute("id"),u=_.getAttribute("name");if(d&&d==t.id){var f=new RfPosition,p=new RfPosition;rf_GetNodePosn(t,f),rf_GetNodePosn(_,p);var h=Math.abs(p.m_x-f.m_x),g=Math.abs(p.m_y-f.m_y);if(logStringMessage("checkForChangedElement1 - the SAME ID attribute:  ID='"+t.id+"'  pElemTested.name='"+u+"'  diffTop1='"+h+"' diffLeft1='"+g+"' bVisible="+n+"\n INFO_OLD:"+i),h<10&&g<10){var c=RfIsElemVisible(_,R=new CRfHtmlObjectProperties);if(R.sName!=i.m_sHtmlName||R.sType!=i.m_sType||c!=i.m_bVisible)return logStringMessage("checkForChangedElement#Check_1.1: HTML elt #CHANGED#: sName='"+R.sName+"' sTagName='"+R.sTagName+"' sType='"+R.sType+"' bVisible="+c),!0}o++}else if(u&&u==t.getAttribute("name")){f=new RfPosition,p=new RfPosition;var C=t.getAttribute("type"),F=_.getAttribute("type");rf_GetNodePosn(t,f),rf_GetNodePosn(_,p);h=Math.abs(p.m_x-f.m_x),g=Math.abs(p.m_y-f.m_y);logStringMessage("checkForChangedElement2 - the SAME NAME attribute  Name='"+u+"'  inputsWithThisName="+l);var S=RfIsElemVisible(t,new CRfHtmlObjectProperties);logStringMessage("  Type, ID, VIS of the OUR Element:  bVisible='"+S+"' Type='"+C+"' our_el.m_x="+f.m_x+" our_el.m_y="+f.m_y+" ID='"+t.id+"' \n INFO_OLD:"+i);var b=RfIsElemVisible(_,new CRfHtmlObjectProperties);if(logStringMessage("  Type, ID, VIS of the FOR Element:  bVisible='"+b+"' Type='"+F+"' ID='"+_.id+"'   for_el.m_x="+p.m_x+" for_el.m_y:"+p.m_y),h<10&&g<10){var R;c=RfIsElemVisible(_,R=new CRfHtmlObjectProperties);if(R.sName!=i.m_sHtmlName||R.sType!=i.m_sType||c!=i.m_bVisible)return logStringMessage("checkForChangedElement#Check_1.2: HTML elt #CHANGED# : sName='"+R.sName+"' sTagName='"+R.sTagName+"' sType='"+R.sType+"' bVisible="+c),!0}l++}}if(1==o){for(m=0;m<a;m++){var T=s[m];if((d=T.getAttribute("id"))&&d==t.id){var N=T;if(!N)return logStringMessage("checkForChangedElement: Cannot GET element by ID"),!1;var y=new CRfHtmlObjectProperties,I=RfIsElemVisible(N,y);if(y.sName!=i.m_sHtmlName||y.sType!=i.m_sType||I!=i.m_bVisible)return logStringMessage("checkForChangedElement#Check_2: HTML elt #CHANGED# : sName='"+y.sName+"' sTagName='"+y.sTagName+"' sType='"+y.sType+"' bVisible="+I),!0}}logStringMessage("checkForChangedElement: inputsWithThisId=1. RETURN false. element was not changed! >>>")}if(0==o&&1==l){if(-1!=e.URL.indexOf("currencyfair.com")&&t.id&&""!=t.id)return logStringMessage("checkForChangedElement: inputsWithThisId=0 AND inputsWithThisName=1. ON THIS SITE definitly changed!"),!0;if(-1!=e.URL.indexOf("ewealthmanager.com")&&t.name&&"Password"==t.name)return logStringMessage("checkForChangedElement: inputsWithThisId=0 AND inputsWithThisName=1. ON THIS SITE definitly changed!"),!0}return!1}catch(e){return logStringMessage("checkForChangedElement error: "+e),!1}}function CRfHtmlObjectProperties(){this.sTagName="",this.sName="",this.sId="",this.sType="",this.sValue="",this.bVisible=!1,this.bInvisibleButCanChange=!1}function CRadioGroup(){this.sTitle="",this.lElements=[],this.fieldName=""}function CRadioOption(e,t){if(this.m_pElement=null,this.m_sTitle="",2==arguments.length)return this.m_pElement=e,void(this.m_sTitle=t)}function RfFieldCaption(){this.m_sCaption="",this.m_Position=new RfPosition,this.m_nNodeSI=-1,this.m_nElement=null}function CInputFieldInfo(e,t,i,n,r){try{this.m_sTagName=e,this.m_sHtmlName=t,this.m_sType=i,this.m_bVisible=n,this.m_fieldType="",this.m_bNameComputed=!1,this.m_bSelectOptionsComputed=!1,this.m_asSelectOptions=[],this.m_pInputTextElem=null,this.m_pTextAreaElem=null,this.m_pSelectElem=null,this.m_pCheckBoxElem=null,this.m_pElem=null,this.m_eType=null,this.m_sName="",this.m_sTitle="",this.m_position=new RfPosition,this.m_left_caption=new RfFieldCaption,this.m_upper_caption=new RfFieldCaption,this.m_right_caption=new RfFieldCaption,this.m_lower_caption=new RfFieldCaption,this.m_inside_before_caption=new RfFieldCaption,this.m_inside_after_caption=new RfFieldCaption,this.m_lRadioOptions=[],this.m_bRadioValuesComputed=!1,this.m_asRadioValues=[]}catch(e){logStringMessage("CInputFieldInfo error:"+e)}}function CRfHtmlInputIterator(){try{this.m_nInputCount=0,this.m_nTextAreaCount=0,this.m_nSelectCount=0,this.m_nVeryLargeSrcIndex=1e5,this.m_nInputSrcIndex=this.m_nVeryLargeSrcIndex,this.m_nTextAreaSrcIndex=this.m_nVeryLargeSrcIndex,this.m_nSelectSrcIndex=this.m_nVeryLargeSrcIndex,this.pInputsArr=[],this.pSelectsArr=[],this.pTextAreaArr=[],this.m_pInputElement=null,this.m_pSelectElement=null,this.m_pTextAreaElement=null,this.m_pForm=null,this.m_nSize=-1,this.m_nInputIndex=0,this.m_nSelectIndex=0,this.m_nTextAreaIndex=0}catch(e){logStringMessage("ERROR in CRfHtmlInputIterator.ctor: "+e)}}function RfPosition(){this.m_nOffsetParentSI=-1,this.m_x=-1,this.m_y=-1,this.m_width=-1,this.m_height=-1,this.m_pOffsetParent=null}String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return t<this.length?t|=0:t=this.length,this.substr(t-e.length,e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(new RegExp("\\s+$"),"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(new RegExp("^\\s+"),"")}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(new RegExp("^\\s*?(\\S*?)\\s*$"),"$1")}),String.prototype.repeat||(String.prototype.repeat=function(e){for(var t="",i=0;i<e;i++)t+=this;return t}),Array.prototype.some||(Array.prototype.some=function(e){var t=this.length;if("function"!=typeof e)throw new TypeError;for(var i=arguments[1],n=0;n<t;n++)if(n in this&&e.call(i,this[n],n,this))return!0;return!1}),Array.prototype.every||(Array.prototype.every=function(e){var t=this.length;if("function"!=typeof e)throw new TypeError;for(var i=arguments[1],n=0;n<t;n++)if(n in this&&!e.call(i,this[n],n,this))return!1;return!0}),Array.prototype.map||(Array.prototype.map=function(e){var t=this.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=new Array(t),n=arguments[1],r=0;r<t;r++)r in this&&(i[r]=e.call(n,this[r],r,this));return i}),CFormFiller.prototype.FillForms=function(e,t,i){try{logStringMessage("+++CFormFiller::FillForms. bActuallyFill="+t),this.curDoc=e,RfInitEventSender(this,this.curDoc);var n=!1,r=new CRfHtmlInputIterator;r.Build2(e);var s=r.GetSizeofArray();if(0==s)return void logStringMessage("---CFormFiller::FillForms: empty collection\n");for(var a=new CIdentity(i.m_mOptionValues),o=0;o<i.m_lGroups.length;++o)for(var l=i.m_lGroups[o],m="custom"==l.m_sType.toLowerCase(),_=0;_<l.m_lFields.length;++_){var d=l.m_lFields[_];m?a.AddCustomFieldValue(d.m_sName,d.m_sMatches,d.m_sValue,!0):a.AddStandardFieldValue(d.m_sName,d.m_sValue,l.m_sName,l.m_sType)}a.m_bLoaded=!0,this.m_pIdentity=a;var u=[],f=[],p=[];this.m_frc=parseInt(this.m_frc),s>0&&this.m_frc<FillRetCode.FillCodeNoMatchingFields&&(this.m_frc=FillRetCode.FillCodeNoMatchingFields),this.m_prev_field_name="",this.m_prev_part_no=0,this.m_bActuallyChanged=!1;for(var h=[],g=[],c=[],C=[],F=s,S=0;S<F;++S){var b=r.GetNext();if(!b)break;var R=new CRfHtmlObjectProperties,T=RfIsElemVisible(b,R);if(T){var N=new CInputFieldInfo(R.sTagName,R.sName,R.sType,T);if(-1!=R.sTagName.indexOf("input")){var y=b;if("text"==R.sType||"password"==R.sType)N.InitText(y,RfFieldType.RfFieldText,b),N.placeholder=GetElemPlaceholder(b),"text"==R.sType&&b.defaultValue&&(N.defaultValue=b.defaultValue.trim());else if("radio"==R.sType)N.InitRadio(),N.AddRadioOption(new CRadioOption(y,""));else{if("checkbox"!=R.sType)continue;N.InitCheckbox(y,b)}}else if(-1!=R.sTagName.indexOf("textarea")){var I=b;N.InitTextarea(I,b),N.placeholder=GetElemPlaceholder(b),I=null}else{if(-1==R.sTagName.indexOf("select"))continue;var E=b;N.InitSelect(E,b),E=null,b.length&&b.length>0&&b.options&&(L=b.options[0])&&!0===L.disabled&&!0===L.defaultSelected&&""===L.value&&"string"==typeof L.text&&""!==L.text.trim()&&(N.placeholder=L.text.trim())}if(-1!=R.sTagName.indexOf("input")&&"checkbox"==R.sType&&0==this.m_pIdentity.GetNumberOfCustomValues())logStringMessage("  checkbox with no custom fields in id, skip\n"),rf_GetNodePosn(b,new RfPosition);else this.RfFindElemCaptions(b,N.GetType(),R.sName,e,N,!1,N.GetType()==RfFieldType.RfFieldCheckbox);if(RfCountCaption(N.m_left_caption,N.GetType(),!1,"<",h),RfCountCaption(N.m_upper_caption,N.GetType(),!1,"^",c),RfCountCaption(N.m_right_caption,N.GetType(),!0,">",g),RfCountCaption(N.m_lower_caption,N.GetType(),!1,"v",C),N.GetType()==RfFieldType.RfFieldRadio){for(var v=N.GetName().toString(),M=!1,A=null,x=0;x<f.length;x++){var O=f[x];if(O&&O.fieldName==v){M=!0;break}}if(M){0==(A=f[x]).lElements.length&&""==A.sTitle&&(A.sTitle=N.m_left_caption.m_sCaption,""==A.sTitle&&(A.sTitle=N.m_upper_caption.m_sCaption));var P=new CRadioOption(b,N.m_right_caption.m_sCaption);A.lElements.push(P),f[x]=A}else{(A=new CRadioGroup).sTitle=N.m_left_caption.m_sCaption,""==A.sTitle&&(A.sTitle=N.m_upper_caption.m_sCaption);var L=new CRadioOption(b,N.m_right_caption.m_sCaption);A.lElements.push(L),A.fieldName=v,f.push(A)}logStringMessage("group.lElements="+A.lElements.length+" TITLE="+A.sTitle+" group="+f.length)}else N.GetType()==RfFieldType.RfFieldCheckbox&&N.SetTitle(N.m_right_caption.m_sCaption);u.push(N)}else R.toString()}var k=h.length,D=c.length,w=g.length,V=C.length;null==k&&(k=0),null==D&&(D=0),null==w&&(w=0),null==V&&(V=0);var B={RfNoDir:0,RfLeft:1,RfUpper:2,RfRight:3,RfLower:4},G=B.RfNoDir;if(logStringMessage("===============================DIRECTION========================================="),logStringMessage(">>>Captions: left="+k+" upper= "+D+" right= "+w+" lower="+V),D>k&&D>=w&&D>=V?(logStringMessage("Preferred dir: upper"),G=B.RfUpper):w>k&&w>V&&w>D?(logStringMessage("Preferred dir: right"),G=B.RfRight):V>k&&V>w&&V>D?(logStringMessage("Preferred dir: lower"),G=B.RfLower):(logStringMessage(">>>Preferred dir: left"),G=B.RfLeft),(G==B.RfUpper||G==B.RfLower)&&5*Math.abs(D-V)<Math.max(D,V)){for(var U=0,H=0,Y=0,W=0,j=0;j<u.length;++j){if((N=u[j]).GetType()!=RfFieldType.RfFieldCheckbox&&N.GetType()!=RfFieldType.RfFieldRadio){var z=RfMaxIntersect(N.GetName(),N.m_upper_caption.m_sCaption);z>0&&(U+=z,H++);var K=RfMaxIntersect(N.GetName(),N.m_lower_caption.m_sCaption);K>0&&(Y+=K,W++)}}(H>=3||W>=3)&&Y>U?(G=B.RfLower,logStringMessage("Preferred dir: change to LOWER\n")):(G=B.RfUpper,logStringMessage("Preferred dir: change to UPPER\n"))}logStringMessage("PREF_DIR:"+G);for(j=0;j<u.length;++j){if(0!==(N=u[j]).m_inside_before_caption.m_sCaption.length||0!==N.m_inside_after_caption.m_sCaption.length){var X=N.placeholder;RfMakeCaptionUsed(N.m_inside_before_caption,p)&&(X=RfJoinCaptions(N.m_inside_before_caption.m_sCaption,X)),RfMakeCaptionUsed(N.m_inside_after_caption,p)&&(X=RfJoinCaptions(X,N.m_inside_after_caption.m_sCaption)),N.placeholder=X}}for(j=0;j<u.length;++j){if((N=u[j]).GetType()!=RfFieldType.RfFieldCheckbox&&N.GetType()!=RfFieldType.RfFieldRadio){if(logStringMessage("SetCaptionsField1: name='"+N.GetName()+"' left='"+N.m_left_caption.m_sCaption+"' upper='"+N.m_upper_caption.m_sCaption+"' right='"+N.m_right_caption.m_sCaption+"' lower='"+N.m_lower_caption.m_sCaption+"'"),G==B.RfLeft){RfMakeCaptionUsed(N.m_left_caption,p)&&N.SetTitle(N.m_left_caption.m_sCaption);var J=RfMakeCaptionUsed(N.m_upper_caption,p);""==N.GetTitle()&&J?N.SetTitle(N.m_upper_caption.m_sCaption):""!=N.GetTitle()&&J&&RfIsGenericCaption(N.m_upper_caption.m_sCaption)&&N.SetTitle(N.GetTitle()+" "+N.m_upper_caption.m_sCaption)}else if(G==B.RfUpper){RfMakeCaptionUsed(N.m_upper_caption,p)?N.SetTitle(N.m_upper_caption.m_sCaption):N.m_upper_caption=new RfFieldCaption;var Z=RfMakeCaptionUsed(N.m_left_caption,p);""==N.GetTitle()&&Z?N.SetTitle(N.m_left_caption.m_sCaption):""!=N.GetTitle()&&Z&&RfIsGenericCaption(N.m_left_caption.m_sCaption)&&N.SetTitle(N.GetTitle()+" "+N.m_left_caption.m_sCaption)}else G==B.RfRight?(RfMakeCaptionUsed(N.m_right_caption,p)&&N.SetTitle(N.m_right_caption.m_sCaption),N.m_lower_caption=new RfFieldCaption,N.m_upper_caption=new RfFieldCaption):G==B.RfLower&&(RfMakeCaptionUsed(N.m_lower_caption,p)&&N.SetTitle(N.m_lower_caption.m_sCaption),N.m_upper_caption=new RfFieldCaption,RfMakeCaptionUsed(N.m_left_caption,p)&&(""==N.GetTitle()?N.SetTitle(N.m_left_caption.m_sCaption):N.SetTitle(N.m_left_caption.m_sCaption+" ( "+N.GetTitle()+" )")),""==N.GetTitle()&&RfMakeCaptionUsed(N.m_right_caption,p)&&N.SetTitle(N.m_right_caption.m_sCaption));logStringMessage("  title='"+N.GetTitle()+"' left='"+N.m_left_caption.m_sCaption+"' upper='"+N.m_upper_caption.m_sCaption+"' right='"+N.m_right_caption.m_sCaption+"' lower='"+N.m_lower_caption.m_sCaption+"'")}}for(var $=0;$<u.length;++$){if((le=u[$]).GetType()!=RfFieldType.RfFieldRadio&&le.GetType()!=RfFieldType.RfFieldCheckbox&&le.GetType()!=RfFieldType.RfFieldTextArea){var q=le.m_position;logStringMessage("Adjust LR captions: 1st field: name='"+le.GetName()+"' left='"+le.m_left_caption.m_sCaption+"' upper='"+le.m_upper_caption.m_sCaption+"' right='"+le.m_right_caption.m_sCaption+"' lower='"+le.m_lower_caption.m_sCaption+"'");for(var Q=0,ee=!0,te=null,ie=$;ie<u.length;Q++){if((fe=u[ie]).GetType()==RfFieldType.RfFieldRadio||fe.GetType()==RfFieldType.RfFieldCheckbox||fe.GetType()==RfFieldType.RfFieldTextArea)break;if(logStringMessage("  2nd field: name='"+fe.GetName()+"' left='"+fe.m_left_caption.m_sCaption+"' upper='"+fe.m_upper_caption.m_sCaption+"' right='"+fe.m_right_caption.m_sCaption+"' lower='"+fe.m_lower_caption.m_sCaption+"'"),(ge=new RfPosition).Clone(fe.m_position),!RfNormalizePosns1(q,ge)||q.m_y<0||ge.m_y<0||Math.abs(q.m_y-ge.m_y)>=10){logStringMessage("  break+ by Y coord. DIFF="+Math.abs(q.m_y-ge.m_y));break}if(te&&te!=fe.m_left_caption.m_nElement){logStringMessage("  break+ by nNodeSI_right\n");break}if(""==fe.m_left_caption.m_sCaption||""==fe.m_right_caption.m_sCaption){logStringMessage("  break- by captions\n"),ee=!1;break}if(RfIsStringHieroglyph(fe.m_left_caption.m_sCaption)){var ne="",re=0;if(ne=(re=fe.m_left_caption.m_sCaption.indexOf(" "))>=0&&"("!=fe.m_left_caption.m_sCaption[0]?fe.m_left_caption.m_sCaption.substr(0,re):fe.m_left_caption.m_sCaption,te&&ne.length>=3){logStringMessage("  break- by long left hier caption\n"),ee=!1;break}}else if(te&&fe.m_left_caption.m_sCaption.length>=6){logStringMessage("  break- by long left caption"),ee=!1;break}if(te)if(RfIsStringHieroglyph(fe.m_right_caption.m_sCaption)){var se="";if("("==fe.m_right_caption.m_sCaption[0])se=new CTitleStringData(fe.m_right_caption.m_sCaption).GetInsideBrackets();else se=fe.m_right_caption.m_sCaption;ne="",re=0;if(ne=(re=se.indexOf(" "))>=0?se.substr(0,re):se,te&&ne.length>=2){logStringMessage("  break- by long right hier caption"),ee=!1;break}}else if(fe.m_right_caption.m_sCaption.length>=8){logStringMessage("  break- by long right caption\n"),ee=!1;break}fe.m_right_caption.m_nNodeSI,te=fe.m_right_caption.m_nElement,ie++}if(logStringMessage("Adjust LR captions: bQualifies="+ee+" nSeqFields="+Q),ee&&Q>0)for(var ae=$,oe=0;ae&&oe<Q;oe++){var le=u[ae];if(ae++,0==oe){var me=le.m_right_caption.m_sCaption.length;if(Q<=2&&(1==me&&"@"==le.m_right_caption.m_sCaption||1==le.m_left_caption.m_sCaption.length&&"@"==le.m_left_caption.m_sCaption)){le.m_right_caption.m_sCaption="";break}"("==le.m_right_caption.m_sCaption[0]&&me>=2&&")"==le.m_right_caption.m_sCaption[me-1]?le.m_left_caption.m_sCaption+=" "+le.m_right_caption.m_sCaption:le.m_left_caption.m_sCaption+=" ( "+le.m_right_caption.m_sCaption+" )"}else le.m_left_caption.m_sCaption=le.m_right_caption.m_sCaption;""!=le.m_right_caption.m_sCaption&&(RfMakeCaptionUsed(le.m_right_caption,p),le.m_right_caption.m_sCaption=""),le.SetTitle(le.m_left_caption.m_sCaption)}}}for(j=0;j<u.length;j++){(N=u[j]).GetType()!=RfFieldType.RfFieldCheckbox&&N.GetType()!=RfFieldType.RfFieldRadio&&(logStringMessage("SetCaptionsField2: name='"+N.GetName()+"' left='"+N.m_left_caption.m_sCaption+"' upper='"+N.m_upper_caption.m_sCaption+"' right='"+N.m_right_caption.m_sCaption+"' lower='"+N.m_lower_caption.m_sCaption+"'"),G==B.RfLeft?(RfMakeCaptionUsed(N.m_lower_caption,p)&&(""==N.GetTitle()?N.SetTitle(N.m_lower_caption.m_sCaption):N.SetTitle(N.GetTitle()+" ( "+N.m_lower_caption.m_sCaption+" )")),N.m_right_caption=new RfFieldCaption):G==B.RfUpper?(RfMakeCaptionUsed(N.m_right_caption,p)&&(""==N.GetTitle()?N.SetTitle(N.m_right_caption.m_sCaption):N.SetTitle(N.GetTitle()+" ( "+N.m_right_caption.m_sCaption+" )")),N.m_lower_caption=new RfFieldCaption):G==B.RfRight&&(N.m_left_caption=new RfFieldCaption),logStringMessage(" title='"+N.GetTitle()+"' left='"+N.m_left_caption.m_sCaption+"' upper='"+N.m_upper_caption.m_sCaption+"' right='"+N.m_right_caption.m_sCaption+"' lower='"+N.m_lower_caption.m_sCaption+"'"))}var _e=0,de=0;for(j=0;j<u.length;j++){"text"==(N=u[j]).m_sType&&(_e++,!N.defaultValue||N.placeholder||N.GetTitle()||de++)}if(2*de>_e){logStringMessage("Filling: default value only fields: "+de);for(j=0;j<u.length;j++){"text"==(N=u[j]).m_sType&&N.defaultValue&&!N.placeholder&&(N.placeholder=N.defaultValue,N.defaultValue="")}}if(u.length)do{var ue=[];q=(le=u.shift()).m_position;if(le.GetType()!=RfFieldType.RfFieldRadio){logStringMessage("GroupFields F1: name='"+le.GetName()+"' left='"+le.m_left_caption.m_sCaption+"' upper='"+le.m_upper_caption.m_sCaption+"' right='"+le.m_right_caption.m_sCaption+"' lower='"+le.m_lower_caption.m_sCaption+"'"),ue.push(le);do{var fe;if(null==(fe=u[0]))break;if(fe.placeholder)break;if(!RfNormalizePosns1(q,ge=fe.m_position))break;if(le.GetType()==RfFieldType.RfFieldCheckbox||fe.GetType()==RfFieldType.RfFieldCheckbox||le.GetType()==RfFieldType.RfFieldRadio||fe.GetType()==RfFieldType.RfFieldRadio||le.GetType()==RfFieldType.RfFieldTextArea||fe.GetType()==RfFieldType.RfFieldTextArea)break;if(logStringMessage("GroupFields F2: name='"+fe.GetName()+"' left='"+fe.m_left_caption.m_sCaption+"' upper='"+fe.m_upper_caption.m_sCaption+"' right= '"+fe.m_right_caption.m_sCaption+"' lower='"+fe.m_lower_caption.m_sCaption+"'"),q.m_y>=0&&ge.m_y>=0&&Math.abs(q.m_y-ge.m_y)<10&&""==fe.m_left_caption.m_sCaption&&""==fe.m_upper_caption.m_sCaption&&""==fe.m_lower_caption.m_sCaption&&""==fe.m_right_caption.m_sCaption&&!(fe.GetType()!=RfFieldType.RfFieldText&&ue.length>=3))ue.push(u.shift());else{if(""==le.m_right_caption.m_sCaption&&""==le.m_lower_caption.m_sCaption&&q.m_y>=0&&ge.m_y>=0&&Math.abs(q.m_y-ge.m_y)<10&&""==fe.m_left_caption.m_sCaption&&""==fe.m_upper_caption.m_sCaption&&(""!=fe.m_lower_caption.m_sCaption||""!=fe.m_right_caption.m_sCaption)){logStringMessage("GroupFields: ADDED field '"+fe.GetName()+"' to HORIZONTAL RIGHT field group, move caption\n"+le.GetName());var pe=ue[0];""==pe.GetTitle()?""!=fe.m_right_caption.m_sCaption?pe.SetTitle(fe.m_right_caption.m_sCaption):""!=fe.m_lower_caption.m_sCaption&&pe.SetTitle(fe.m_lower_caption.m_sCaption):""!=fe.m_right_caption.m_sCaption?pe.SetTitle(pe.GetTitle()+" ( "+fe.m_right_caption.m_sCaption+" )"):""!=fe.m_lower_caption.m_sCaption&&pe.SetTitle(pe.GetTitle()+" ( "+fe.m_lower_caption.m_sCaption+" )"),(he=u.shift()).SetTitle(""),he.m_right_caption.m_sCaption="",ue.push(he);break}if(!((G==B.RfLeft||G==B.RfUpper)&&(""!=le.m_left_caption.m_sCaption||""!=le.m_upper_caption.m_sCaption)&&q.m_y>=0&&ge.m_y>=0&&Math.abs(q.m_y-ge.m_y)>12&&q.m_x>=0&&ge.m_x>=0&&Math.abs(q.m_x-ge.m_x)<12&&""==fe.m_left_caption.m_sCaption&&""==fe.m_upper_caption.m_sCaption))break;var he;logStringMessage("GroupFields: ADDED field='"+fe.GetName()+"' to VERTICAL field group='"+le.GetName()+"'"),(he=u.shift()).SetTitle(""),he.m_right_caption.m_sCaption="",ue.push(he)}}while(u.length);n=!1;this.FillFieldList(ue,t,n)}}while(u.length);for(var ge=0;ge<f.length;ge++){A=f[ge];if(logStringMessage(":1 Radio group: "+A.sTitle),0!=A.lElements.length){var ce=!1;if(""!=A.sTitle&&A.lElements.length>=2)for(j=0;j<A.lElements.length;j++){var Ce=A.lElements[j].m_sTitle;if(j<A.lElements.length-1){if(""==Ce)break}else if(""==Ce){ce=!0;break}}if(ce){var Fe={sentence:A.sTitle},Se=RfLastWord(Fe);A.sTitle=Fe.sentence;for(j=0;j<A.lElements.length;j++){var be=Ce=A.lElements[j].m_sTitle;A.lElements[j].m_sTitle=Se,Se=be}}(N=new CInputFieldInfo).InitRadio(),N.SetTitle(A.sTitle),N.SetRadioOptions(A.lElements),this.FillFieldList([N],t,n)}}p.length=0}catch(e){return void logStringMessage("CFormFiller.FillForms error: "+e)}logStringMessage("---CFormFiller::FillForms")},CFormFiller.prototype.FillFieldList=function(e,t,i){if(0!=e.length){var n=e[0],r={sFieldName:"",pResult:null},s=this.m_pIdentity.Filling(n,e,r),a=r.pResult,o=s&&a;o||(this.m_prev_field_name=""),e.length,pad_str(r.pResult?r.sFieldName:"NOT_FOUND",15),n.toString(),a||(a=new CIdentityField);var l=parseInt(a.GetFieldFormat().GetType());if(!o||l!=CValueType.valueMultiline&&l!=CValueType.valueSectional){if(o&&(logStringMessage(":3 FillFieldList: not multiline/sectional filling found"),this.DoFillFieldList([n],a,r.sFieldName,t,i)),e.length>1)for(var m=1;m<e.length;m++)this.FillFieldList([e[m]],t,i)}else this.DoFillFieldList(e,a,r.sFieldName,t,i)}},CFormFiller.prototype.DoFillFieldList=function(e,t,i,n,r){try{logStringMessage("###4  FOUND DoFillFieldList ENTRY: sFieldName='"+i+"' pFilling="+t+" bActuallyFill="+n);var s={sFieldName:i,pFilling:t,bComputed:!1,sMainValue:"",sAltValue:"",info:null,pbEmpty:null,plsValues:[]};this.GetValueWithAlts(s);var a=t.GetFieldFormat().GetType(),o="";switch(o=0==a?"NORMAL":1==a?"SELECT":2==a?"MULTILINE":3==a?"SECTIONAL":"UNKNOWN",logStringMessage("###4.1  DoFillFieldList FieldName='"+i+"'  MainValue='"+s.sMainValue+"'  AltValue='"+s.sAltValue+"'  count="+e.length+"  FIELD_TYPE="+o),a){case 0:case 1:this.FillField(e[0],s.sMainValue,s.sAltValue,s.plsValues,s.bComputed?CFieldType.Computed:CFieldType.Basic,i,0,0,n,r);break;case 2:for(var l=0,m=0,_=0;_<e.length;_++){var d=e[_];m++;var u=l,f="";(l=e[_+1]?s.sMainValue.indexOf(CRLF,u):-1)>=0?(f=s.sMainValue.substring(u,l),l+=2):(f=s.sMainValue.substr(u,s.sMainValue.length),l=s.sMainValue.length),this.FillField(d,f,"",[],CFieldType.Computed,i,m-1,0,n,r)}break;case 3:logStringMessage("CValueType.valueSectional!!! ");var p=t.GetFieldFormat().GetBestPartitioning(e.length);if(logStringMessage(" BestPartitioning:"+p),p)for(var h=s.sMainValue,g=(m=0,0);g<p.length;g++){d=e[g];var c=p[g];switch(c.m_eType){case 0:if(f=(f=h.substr(0,c.m_nSize)).trimRight(),0==m){F={pFilling:t,sFieldName:i,sNewValue:f};this.AddPhonePrefix(F),f=F.sNewValue}this.FillField(d,f,"",[],1,i,m,e.length,n,r),h=h.length>=c.m_nSize?h.substring(c.m_nSize):"",m++;break;case 1:var C=this.m_pIdentity.getFields().LookupStandard(c.m_sValueName);C&&this.DoFillFieldList([d],C,c.m_sValueName,n,r)}}else{var d=e[0];s.sMainValue=t.GetFieldFormat().FormatValue(s.sMainValue,e[0]);var F={pFilling:t,sFieldName:i,sNewValue:s.sMainValue};this.AddPhonePrefix(F),s.sMainValue=F.sNewValue,logStringMessage(" aList[0]:"+e[0]+" objRef.sMainValue:"+s.sMainValue+s.sAltValue),this.FillField(e[0],s.sMainValue,s.sAltValue,s.plsValues,s.bComputed?CFieldType.Computed:CFieldType.Basic,i,0,0,n,r)}}}catch(e){logStringMessage("#ERROR# CFormFiller.DoFillFieldList error: "+e)}},CFormFiller.prototype.GetValueWithAlts=function(e){try{var t=e.pFilling;logStringMessage("    +++GetValueWithAlts: sFieldName='"+e.sFieldName+"' pFilling="+t);var i=this.m_pIdentity.getFields(),n=t.GetCurrentInstanceName(i);if(e.sMainValue=t.GetValue(this.m_pIdentity.getFields(),n,e.info),logStringMessage("    +++GetValueWithAlts: objRef.sMainValue="+e.sMainValue),this.m_bUseEnglishSelectValues||(e.sAltValue=e.sMainValue,t.GetFieldFormat().GetType()==CValueType.valueSelect&&(e.sMainValue=RfStringIdToLocalized("lang-ignored",e.sFieldName,e.sMainValue,null)),e.sAltValue==e.sMainValue&&(e.sAltValue="")),t.GetFieldFormat().GetType()==CValueType.valueSelect){var r=t.GetSelectedOption(n);if(r)for(var s=0;s<r.m_lsValues.length;s++)e.plsValues[e.plsValues.length]=r.m_lsValues[s]}}catch(e){logStringMessage("CFormFiller.GetValueWithAlts error: "+e)}},CFormFiller.prototype.FillField=function(e,t,i,n,r,s,a,o,l,m){try{if(logStringMessage("###5 FillField FieldName='"+s+"' m_prev_field_name='"+this.m_prev_field_name+"'  m_prev_part_no='"+this.m_prev_part_no+"' sMainValue='"+t+"' info="+e+" nPartitionNumber="+a+" nTotalPartNumber="+o+" bActuallyFill="+l),e.m_bBreaker)logStringMessage("   breaker: this field cannot be a 2nd part of a dependent field\n"),this.m_prev_field_name="",this.m_prev_part_no=0,this.m_bActuallyChanged=!1;else if(!(this.m_pPasscard||r==CFieldType.Partition&&o>=2||""==this.m_prev_field_name)){logStringMessage(":5 FillField look for dependent fields\n");var _=s,d=[{prev_fr_name:"Address Lines",this_fr_name:"Address Lines",prev_to_name:"Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"Address Lines",this_fr_name:"Address Line 2",prev_to_name:"Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"Address Line 1",this_fr_name:"Generic Number",prev_to_name:"Street Name",m_nCountrySpecifc:0},{prev_fr_name:"Address Line 1",this_fr_name:"House Number",prev_to_name:"Street Name",m_nCountrySpecifc:0},{prev_fr_name:"Line 1",this_fr_name:"City",prev_to_name:"Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"Line 2",this_fr_name:"City",prev_to_name:"Address Line 2",m_nCountrySpecifc:0},{prev_fr_name:"Line 1",this_fr_name:"Address Line 2",prev_to_name:"Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"Address Lines",this_fr_name:"House Number",prev_to_name:"Street Name",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Street Name",prev_to_name:"House Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Address Line 1",prev_to_name:"House Number",m_nCountrySpecifc:0},{prev_fr_name:"Address City State Zip",this_fr_name:"City",prev_to_name:"Address Lines",m_nCountrySpecifc:0},{prev_fr_name:"Address City State Zip",this_fr_name:"State Or Province",prev_to_name:"Address Lines",m_nCountrySpecifc:0},{prev_fr_name:"Address City State Zip",this_fr_name:"Address Line 2",prev_to_name:"Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"Address City State Zip",this_fr_name:"Address Lines",prev_to_name:"Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"Address Lines",this_fr_name:"Generic Number",prev_to_name:"Street Name",m_nCountrySpecifc:0},{prev_fr_name:"Address Line 4",this_fr_name:"State Or Province",prev_to_name:"City",m_nCountrySpecifc:0},{prev_fr_name:"Address Line 4",this_fr_name:"Zip Or PostCode",prev_to_name:"City",m_nCountrySpecifc:0},{prev_fr_name:"Phone Area",this_fr_name:"City",prev_to_name:"Address Line 3",m_nCountrySpecifc:0},{prev_fr_name:"City Address",this_fr_name:"Address Line 2",prev_to_name:"City Street",m_nCountrySpecifc:0},{prev_fr_name:"Alphabet",this_fr_name:"Address Line 2",prev_to_name:"Alphabet Address Line 2",m_nCountrySpecifc:0},{prev_fr_name:"Alphabet",this_fr_name:"Address Line 1",prev_to_name:"Alphabet Address Line 1",m_nCountrySpecifc:0},{prev_fr_name:"City Address",this_fr_name:"State City Address",prev_to_name:"City",m_nCountrySpecifc:0},{prev_fr_name:"Card Expires",this_fr_name:"Year",prev_to_name:"Card Expires Month",m_nCountrySpecifc:0},{prev_fr_name:"Card Expires",this_fr_name:"Card Expires Year",prev_to_name:"Card Expires Month",m_nCountrySpecifc:0},{prev_fr_name:"Card Expires",this_fr_name:"YY",prev_to_name:"Card Expires Month",m_nCountrySpecifc:0},{prev_fr_name:"Name",this_fr_name:"First Name",prev_to_name:"Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Name",this_fr_name:"Middle Initial",prev_to_name:"First Name",m_nCountrySpecifc:0},{prev_fr_name:"Name",this_fr_name:"Last Name",prev_to_name:"First Name",m_nCountrySpecifc:0},{prev_fr_name:"Name",this_fr_name:"Last Names",prev_to_name:"First Name",m_nCountrySpecifc:0},{prev_fr_name:"Name",this_fr_name:"First Name Middle",prev_to_name:"Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Alphabet Name",this_fr_name:"First Name",prev_to_name:"Alphabet Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Last Name",this_fr_name:"Alphabet First Name",prev_to_name:"Alphabet Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Alphabet",this_fr_name:"Alphabet First Name",prev_to_name:"Alphabet Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Roman Name",this_fr_name:"First Name",prev_to_name:"Roman Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Roman",this_fr_name:"Roman First Name",prev_to_name:"Roman Last Name",m_nCountrySpecifc:0},{prev_fr_name:"Alphabet",this_fr_name:"Name",prev_to_name:"Alphabet Name",m_nCountrySpecifc:0},{prev_fr_name:"Roman Name",this_fr_name:"Roman Last Name",prev_to_name:"Roman First Name",m_nCountrySpecifc:0},{prev_fr_name:"Title",this_fr_name:"Company",prev_to_name:"Position",m_nCountrySpecifc:0},{prev_fr_name:"Title",this_fr_name:"Company Department",prev_to_name:"Position",m_nCountrySpecifc:0},{prev_fr_name:"Country",this_fr_name:"Phone Area",prev_to_name:"Country Code",m_nCountrySpecifc:0},{prev_fr_name:"Phone Area",this_fr_name:"Work Phone",prev_to_name:"Work Phone Area",m_nCountrySpecifc:0},{prev_fr_name:"Phone Area",this_fr_name:"Home Phone",prev_to_name:"Home Phone Area",m_nCountrySpecifc:0},{prev_fr_name:"Phone Area",this_fr_name:"Cell Phone",prev_to_name:"Cell Phone Area",m_nCountrySpecifc:0},{prev_fr_name:"Phone Area",this_fr_name:"Fax Phone",prev_to_name:"Fax Phone Area",m_nCountrySpecifc:0},{prev_fr_name:"Phone",this_fr_name:"Phone Ext",prev_to_name:"Phone Base",m_nCountrySpecifc:0},{prev_fr_name:"Home Phone",this_fr_name:"Phone Ext",prev_to_name:"Home Phone Base",m_nCountrySpecifc:0},{prev_fr_name:"Phone Ext",this_fr_name:"Phone Ext",prev_to_name:"Phone Base",m_nCountrySpecifc:0},{prev_fr_name:"Work Phone",this_fr_name:"Phone Ext",prev_to_name:"Work Phone Base",m_nCountrySpecifc:0},{prev_fr_name:"Zip Or PostCode",this_fr_name:"Zip Or PostCode",prev_to_name:"Zip Or PostCode 1",m_nCountrySpecifc:0},{prev_fr_name:"Zip City",this_fr_name:"City",prev_to_name:"Zip Or PostCode 1",m_nCountrySpecifc:0},{prev_fr_name:"Email",this_fr_name:"Email Domain",prev_to_name:"Email UserID",m_nCountrySpecifc:0},{prev_fr_name:"Mobile Email",this_fr_name:"Email Domain",prev_to_name:"Mobile Email UserID",m_nCountrySpecifc:0},{prev_fr_name:"Mobile Email",this_fr_name:"Mobile Email Domain",prev_to_name:"Mobile Email UserID",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Type",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Type Text",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Validation Code",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Expires",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Expires Month",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Expires MM YY",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Card Expires MMYY",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"CardHolder Name",prev_to_name:"Card Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Bank Account Type",prev_to_name:"Bank Account Number",m_nCountrySpecifc:0},{prev_fr_name:"Generic Number",this_fr_name:"Bank Routing Number",prev_to_name:"Bank Account Number",m_nCountrySpecifc:0},{prev_fr_name:"Card Number",this_fr_name:"Bank Routing Number",prev_to_name:"Bank Account Number",m_nCountrySpecifc:0},{prev_fr_name:"Card Number",this_fr_name:"Bank Account Type",prev_to_name:"Bank Account Number",m_nCountrySpecifc:0},{prev_fr_name:"User ID",this_fr_name:"Card Number",prev_to_name:"CardHolder Name",m_nCountrySpecifc:0},{prev_fr_name:"User ID",this_fr_name:"Bank Routing Number",prev_to_name:"Bank Account Owner",m_nCountrySpecifc:0},{prev_fr_name:"User ID",this_fr_name:"Bank Account Type",prev_to_name:"Bank Account Owner",m_nCountrySpecifc:0},{prev_fr_name:"Password",this_fr_name:"SSN Last 7 Digits",prev_to_name:"Card Password",m_nCountrySpecifc:0},{prev_fr_name:"First Name",this_fr_name:"Bank Type",prev_to_name:"Bank Name",m_nCountrySpecifc:0},{prev_fr_name:"First Name",this_fr_name:"Bank Branch Type",prev_to_name:"Bank Branch Name",m_nCountrySpecifc:0},{prev_fr_name:"CardHolder Name",this_fr_name:"CardHolder Last Name",prev_to_name:"CardHolder First Name",m_nCountrySpecifc:0},{prev_fr_name:"Name",this_fr_name:"Password",prev_to_name:"User ID",m_nCountrySpecifc:1},{prev_fr_name:"Month",this_fr_name:"Birth Year",prev_to_name:"Birth Month",m_nCountrySpecifc:0},{prev_fr_name:"Day",this_fr_name:"Birth Month",prev_to_name:"Birth Day",m_nCountrySpecifc:0},{prev_fr_name:"Year",this_fr_name:"Vehicle Identification Number",prev_to_name:"Car Year",m_nCountrySpecifc:0},{prev_fr_name:"Year",this_fr_name:"Car Plate Number",prev_to_name:"Car Year",m_nCountrySpecifc:0},{prev_fr_name:"Year",this_fr_name:"Car Make",prev_to_name:"Car Year",m_nCountrySpecifc:0},{prev_fr_name:"Year",this_fr_name:"Car Make Model",prev_to_name:"Car Year",m_nCountrySpecifc:0},{prev_fr_name:"Model",this_fr_name:"Vehicle Identification Number",prev_to_name:"Car Model",m_nCountrySpecifc:0},{prev_fr_name:"Model",this_fr_name:"Car Plate Number",prev_to_name:"Car Model",m_nCountrySpecifc:0},{prev_fr_name:"Model",this_fr_name:"Car Year",prev_to_name:"Car Model",m_nCountrySpecifc:0},{prev_fr_name:"Make",this_fr_name:"Car Model",prev_to_name:"Car Make",m_nCountrySpecifc:0},{prev_fr_name:"State Or Province",this_fr_name:"Car Plate Number",prev_to_name:"Car Plate State",m_nCountrySpecifc:0}];if(this.m_prev_part_no<=1)for(var u=0;u<d.length;u++){var f=d[u];if(0!=f.m_nCountrySpecifc){var p=this.m_pIdentity.getCountry();if("Russia"!=p&&"France"!=p&&"Korea"!=p&&"Czech Republic"!=p&&"Hungary"!=p)continue}if(this.m_prev_field_name==f.prev_fr_name&&_==f.this_fr_name){var h=f.prev_to_name,g={sMainValue:"",sAltValue:"",plsValues:[],bComputed:!1};if(""!=h){if(!(b=this.m_pIdentity.getFields().LookupStandard(h)))continue;g={sFieldName:h,pFilling:b,bComputed:!1,sMainValue:"",sAltValue:"",info:this.m_prev_Info,pbEmpty:null,plsValues:[]},this.GetValueWithAlts(g);var c={pFilling:b,sFieldName:h,sNewValue:g.sMainValue};this.AddPhonePrefix(c),g.sMainValue=c.sNewValue}logStringMessage("   OK.FillField: correct PREV field: '"+this.m_prev_field_name+"' -> '"+h+"' = '"+g.sMainValue+"'");var C={info:this.m_prev_Info,sMainValue:g.sMainValue,sAltValue:g.sAltValue,plsValues:g.plsValues,bAllowEVCFtoBlockFill:!1,bSilent:!0,Type:g.bComputed?CFieldType.Computed:CFieldType.Basic,sFieldName:h,nPartitionNumber:0,bActuallyFill:l,bIgnoreFNE:this.m_bActuallyChanged,bActuallyChanged:this.m_bActuallyChanged,bRedoFormFill:m};if(this.DoFillField(C),C.bRedoFormFill)return;this.m_prev_field_name=h;break}}var F=[{prev_fr_name:"Address Lines",this_fr_name:"Address Lines",this_to_name:"Address Line 2"},{prev_fr_name:"Address Line 1",this_fr_name:"Address Lines",this_to_name:"Address Line 2"},{prev_fr_name:"Address Line 1",this_fr_name:"Address Line 1",this_to_name:"Address Line 2"},{prev_fr_name:"Address Line 2",this_fr_name:"Address Lines",this_to_name:"Address Line 3"},{prev_fr_name:"Address Line 3",this_fr_name:"Address Lines",this_to_name:"Address Line 4"},{prev_fr_name:"Address Line 4",this_fr_name:"Address Lines",this_to_name:"Address Line 5"},{prev_fr_name:"Address Line 5",this_fr_name:"Address Lines",this_to_name:"Address Line 6"},{prev_fr_name:"Address Line 1",this_fr_name:"Line 2",this_to_name:"Address Line 2"},{prev_fr_name:"Address Line 2",this_fr_name:"Line 3",this_to_name:"Address Line 3"},{prev_fr_name:"Street Name",this_fr_name:"Generic Number",this_to_name:"House Number"},{prev_fr_name:"Address Line 2",this_fr_name:"Address Lines",this_to_name:"City"},{prev_fr_name:"Street Name",this_fr_name:"Phone Area",this_to_name:"Address Line 3"},{prev_fr_name:"Address Line 2",this_fr_name:"Phone Area",this_to_name:"Address Line 3"},{prev_fr_name:"House Number",this_fr_name:"Address Lines",this_to_name:"Address Line 2"},{prev_fr_name:"Zip Or PostCode",this_fr_name:"Zip Address",this_to_name:"Address Lines"},{prev_fr_name:"Zip Or PostCode 2",this_fr_name:"Zip Address",this_to_name:"Address Lines"},{prev_fr_name:"Address Line 1",this_fr_name:"Zip Address",this_to_name:"Address Line 2"},{prev_fr_name:"State Or Province",this_fr_name:"Address Line 2",this_to_name:"City Address"},{prev_fr_name:"State Or Province",this_fr_name:"State City Address",this_to_name:"City Address"},{prev_fr_name:"City",this_fr_name:"State City Address",this_to_name:"Address Lines"},{prev_fr_name:"Address Line 1",this_fr_name:"Alphabet",this_to_name:"Alphabet Address Line 1"},{prev_fr_name:"Address Line 2",this_fr_name:"Alphabet",this_to_name:"Alphabet Address Line 2"},{prev_fr_name:"Address Lines",this_fr_name:"Alphabet",this_to_name:"Alphabet Address Lines"},{prev_fr_name:"City",this_fr_name:"Alphabet",this_to_name:"Alphabet City"},{prev_fr_name:"Bank Routing Number",this_fr_name:"Card Number",this_to_name:"Bank Account Number"},{prev_fr_name:"Bank Routing Number",this_fr_name:"Generic Number",this_to_name:"Bank Account Number"},{prev_fr_name:"First Name",this_fr_name:"Name",this_to_name:"Last Name"},{prev_fr_name:"First Name",this_fr_name:"First Name Middle",this_to_name:"Middle Initial"},{prev_fr_name:"First Name",this_fr_name:"First Name Initial",this_to_name:"Middle Initial"},{prev_fr_name:"Last Name",this_fr_name:"Name",this_to_name:"First Name"},{prev_fr_name:"Last Names",this_fr_name:"Name",this_to_name:"First Name"},{prev_fr_name:"Zip Or PostCode 1",this_fr_name:"Zip Or PostCode",this_to_name:"Zip Or PostCode 2"},{prev_fr_name:"Zip Or PostCode",this_fr_name:"Zip City",this_to_name:"City"},{prev_fr_name:"Zip Or PostCode",this_fr_name:"Line 2",this_to_name:"Address Line 2"},{prev_fr_name:"Zip Or PostCode",this_fr_name:"Line 1",this_to_name:"Address Line 1"},{prev_fr_name:"Name",this_fr_name:"Line 1",this_to_name:"Address Line 1"},{prev_fr_name:"First Name Middle Last Name",this_fr_name:"Line 1",this_to_name:"Address Line 1"},{prev_fr_name:"Last Name",this_fr_name:"Line 1",this_to_name:"Address Line 1"},{prev_fr_name:"First Name",this_fr_name:"Line 1",this_to_name:"Address Line 1"},{prev_fr_name:"Full Name",this_fr_name:"Line 1",this_to_name:"Address Line 1"},{prev_fr_name:"Phone Area",this_fr_name:"Phone",this_to_name:"Phone Number"},{prev_fr_name:"Phone Area",this_fr_name:"Generic Number",this_to_name:"Phone Number"},{prev_fr_name:"Home Phone Area",this_fr_name:"Phone Number",this_to_name:"Home Phone Number"},{prev_fr_name:"Home Phone Area",this_fr_name:"Generic Number",this_to_name:"Home Phone Number"},{prev_fr_name:"Home Phone Area",this_fr_name:"Home Phone",this_to_name:"Home Phone Number"},{prev_fr_name:"Home Phone",this_fr_name:"Phone Ext",this_to_name:"Home Phone Ext"},{prev_fr_name:"Home Phone Base",this_fr_name:"Phone Ext",this_to_name:"Home Phone Ext"},{prev_fr_name:"Work Phone Area",this_fr_name:"Phone Number",this_to_name:"Work Phone Number"},{prev_fr_name:"Work Phone Area",this_fr_name:"Generic Number",this_to_name:"Work Phone Number"},{prev_fr_name:"Work Phone",this_fr_name:"Phone Ext",this_to_name:"Work Phone Ext"},{prev_fr_name:"Work Phone Base",this_fr_name:"Phone Ext",this_to_name:"Work Phone Ext"},{prev_fr_name:"Cell Phone Area",this_fr_name:"Cell Phone",this_to_name:"Cell Phone Number"},{prev_fr_name:"Cell Phone Area",this_fr_name:"Generic Number",this_to_name:"Cell Phone Number"},{prev_fr_name:"Cell Phone Area",this_fr_name:"Phone Number",this_to_name:"Cell Phone Number"},{prev_fr_name:"Fax Phone Area",this_fr_name:"Fax Phone",this_to_name:"Fax Phone Number"},{prev_fr_name:"Fax Phone Area",this_fr_name:"Phone Number",this_to_name:"Fax Phone Number"},{prev_fr_name:"Fax Phone Area",this_fr_name:"Generic Number",this_to_name:"Fax Phone Number"},{prev_fr_name:"Home Phone",this_fr_name:"Home Phone",this_to_name:"Work Phone"},{prev_fr_name:"Birth Month",this_fr_name:"Day",this_to_name:"Birth Day"},{prev_fr_name:"Birth Month",this_fr_name:"Year",this_to_name:"Birth Year"},{prev_fr_name:"Birth Day",this_fr_name:"Year",this_to_name:"Birth Year"},{prev_fr_name:"Birth Month",this_fr_name:"YY",this_to_name:"Birth YY"},{prev_fr_name:"Birth Day",this_fr_name:"YY",this_to_name:"Birth YY"},{prev_fr_name:"Birth Day",this_fr_name:"Month",this_to_name:"Birth Month"},{prev_fr_name:"Birth Year",this_fr_name:"Day",this_to_name:"Birth Day"},{prev_fr_name:"Birth Year",this_fr_name:"Month",this_to_name:"Birth Month"},{prev_fr_name:"Birth YY",this_fr_name:"Day",this_to_name:"Birth Day"},{prev_fr_name:"Birth YY",this_fr_name:"Month",this_to_name:"Birth Month"},{prev_fr_name:"Date Of Birth",this_fr_name:"YY",this_to_name:"Birth YY"},{prev_fr_name:"Date Of Birth",this_fr_name:"Month",this_to_name:"Birth Month"},{prev_fr_name:"Card Number",this_fr_name:"Year",this_to_name:"Card Expires Year"},{prev_fr_name:"Card Number",this_fr_name:"Month",this_to_name:"Card Expires Month"},{prev_fr_name:"Card Validation Code",this_fr_name:"Year",this_to_name:"Card Expires Year"},{prev_fr_name:"Card Validation Code",this_fr_name:"Month",this_to_name:"Card Expires Month"},{prev_fr_name:"Card Expires Month",this_fr_name:"Year",this_to_name:"Card Expires Year"},{prev_fr_name:"Card Expires Month",this_fr_name:"YY",this_to_name:"Card Expires YY"},{prev_fr_name:"Card Expires Year",this_fr_name:"Month",this_to_name:"Card Expires Month"},{prev_fr_name:"CardHolder Name",this_fr_name:"Month",this_to_name:"Card Expires Month"},{prev_fr_name:"CardHolder Name",this_fr_name:"Bank Account Type",this_to_name:"Card Type"},{prev_fr_name:"CardHolder First Name",this_fr_name:"Last Name",this_to_name:"CardHolder Last Name"},{prev_fr_name:"CardHolder First Name",this_fr_name:"Middle Initial",this_to_name:"CardHolder MI"},{prev_fr_name:"CardHolder MI",this_fr_name:"Last Name",this_to_name:"CardHolder Last Name"},{prev_fr_name:"Card Type",this_fr_name:"Generic Number",this_to_name:"Card Number"},{prev_fr_name:"Card Type Text",this_fr_name:"Generic Number",this_to_name:"Card Number"},{prev_fr_name:"CardHolder Name",this_fr_name:"Generic Number",this_to_name:"Card Number"},{prev_fr_name:"Card Type Text",this_fr_name:"Name",this_to_name:"CardHolder Name"},{prev_fr_name:"CardHolder Last Name",this_fr_name:"Generic Number",this_to_name:"Card Number"},{prev_fr_name:"Card ValidFrom Month",this_fr_name:"Year",this_to_name:"Card ValidFrom Year"},{prev_fr_name:"Card ValidFrom Month",this_fr_name:"YY",this_to_name:"Card ValidFrom YY"},{prev_fr_name:"Card ValidFrom Year",this_fr_name:"Month",this_to_name:"Card ValidFrom Month"},{prev_fr_name:"Card Expires Month",this_fr_name:"Password",this_to_name:"Card Password"},{prev_fr_name:"Card Expires",this_fr_name:"Password",this_to_name:"Card Password"},{prev_fr_name:"Card Issuing Bank",this_fr_name:"Bank Account Owner",this_to_name:"CardHolder Name"},{prev_fr_name:"Social Security Number",this_fr_name:"Password",this_to_name:"Card Password"},{prev_fr_name:"SSN Last 7 Digits",this_fr_name:"Password",this_to_name:"Card Password"},{prev_fr_name:"Alphabet Name",this_fr_name:"First Name",this_to_name:"Alphabet First Name"},{prev_fr_name:"Alphabet Last Name",this_fr_name:"First Name",this_to_name:"Alphabet First Name"},{prev_fr_name:"Alphabet Last Name",this_fr_name:"Alphabet",this_to_name:"Alphabet First Name"},{prev_fr_name:"Alphabet Last Name",this_fr_name:"Alphabet Name",this_to_name:"Alphabet First Name"},{prev_fr_name:"First Name",this_fr_name:"Alphabet",this_to_name:"Alphabet Last Name"},{prev_fr_name:"Roman Name",this_fr_name:"First Name",this_to_name:"Roman First Name"},{prev_fr_name:"Roman Last Name",this_fr_name:"First Name",this_to_name:"Roman First Name"},{prev_fr_name:"Name",this_fr_name:"Alphabet",this_to_name:"Alphabet Name"},{prev_fr_name:"Alphabet Name",this_fr_name:"Roman",this_to_name:"Roman Name"},{prev_fr_name:"Company",this_fr_name:"Alphabet",this_to_name:"Alphabet Company"},{prev_fr_name:"Company",this_fr_name:"Roman",this_to_name:"Roman Company"},{prev_fr_name:"Company",this_fr_name:"Roman Name",this_to_name:"Roman Company"},{prev_fr_name:"CardHolder Name",this_fr_name:"Alphabet",this_to_name:"Alphabet CardHolder Name"},{prev_fr_name:"Alphabet CardHolder Last Name",this_fr_name:"Alphabet CardHolder Name",this_to_name:"Alphabet CardHolder First Name"},{prev_fr_name:"Bank Account Owner",this_fr_name:"Alphabet",this_to_name:"Alphabet Bank Account Owner"},{prev_fr_name:"Bank Account Owner",this_fr_name:"Alphabet Name",this_to_name:"Alphabet Bank Account Owner"},{prev_fr_name:"Bank Account Owner Last",this_fr_name:"First Name",this_to_name:"Bank Account Owner First"},{prev_fr_name:"Bank Account Owner First",this_fr_name:"Alphabet Name",this_to_name:"Alphabet Bank Account Owner"},{prev_fr_name:"Bank Account Owner First",this_fr_name:"Alphabet Last Name",this_to_name:"Alphabet Bank Account Owner Last"},{prev_fr_name:"Alphabet Bank Account Owner Last",this_fr_name:"First Name",this_to_name:"Alphabet Bank Account Owner First"},{prev_fr_name:"Bank Name",this_fr_name:"Generic Branch",this_to_name:"Bank Branch"},{prev_fr_name:"Bank Name",this_fr_name:"Phone",this_to_name:"Bank Phone"},{prev_fr_name:"Bank Branch",this_fr_name:"Phone",this_to_name:"Bank Phone"},{prev_fr_name:"Bank Name",this_fr_name:"Address Lines",this_to_name:"Bank Address"},{prev_fr_name:"Bank Branch",this_fr_name:"Address Lines",this_to_name:"Bank Address"},{prev_fr_name:"Bank Phone",this_fr_name:"Address Lines",this_to_name:"Bank Address"},{prev_fr_name:"Bank Account Owner",this_fr_name:"Address Lines",this_to_name:"Bank Address"},{prev_fr_name:"Bank Swift Code",this_fr_name:"User ID",this_to_name:"Bank Account Owner"},{prev_fr_name:"Bank Branch",this_fr_name:"User ID",this_to_name:"Bank Account Owner"},{prev_fr_name:"Bank Account Number",this_fr_name:"User ID",this_to_name:"Bank Account Owner"},{prev_fr_name:"Bank Name",this_fr_name:"User ID",this_to_name:"Bank Account Owner"},{prev_fr_name:"Bank Account Number",this_fr_name:"Generic PIN",this_to_name:"Bank PIN Code"},{prev_fr_name:"Bank Account Type",this_fr_name:"Card Number",this_to_name:"Bank Account Number"},{prev_fr_name:"Bank Account Owner",this_fr_name:"Card Number",this_to_name:"Bank Account Number"},{prev_fr_name:"Bank Address",this_fr_name:"Phone",this_to_name:"Bank Phone"},{prev_fr_name:"Card Validation Code",this_fr_name:"Bank Phone",this_to_name:"Card Customer Service Phone"},{prev_fr_name:"Card Expires",this_fr_name:"Bank Phone",this_to_name:"Card Customer Service Phone"},{prev_fr_name:"Card Expires Year",this_fr_name:"Bank Phone",this_to_name:"Card Customer Service Phone"},{prev_fr_name:"Mobile Email",this_fr_name:"Email Domain",this_to_name:"Mobile Email Domain"},{prev_fr_name:"Email",this_fr_name:"Confirmation",this_to_name:"Email"},{prev_fr_name:"Email Domain",this_fr_name:"Confirmation",this_to_name:"Email"},{prev_fr_name:"Mobile Email",this_fr_name:"Confirmation",this_to_name:"Mobile Email"},{prev_fr_name:"Mobile Email UserID",this_fr_name:"Email Domain",this_to_name:"Mobile Email Domain"},{prev_fr_name:"Mobile Email Domain",this_fr_name:"Confirmation",this_to_name:"Mobile Email"},{prev_fr_name:"Password",this_fr_name:"Confirmation",this_to_name:"Password"},{prev_fr_name:"Password Answer",this_fr_name:"Confirmation",this_to_name:"Password Answer"},{prev_fr_name:"Card PIN Number",this_fr_name:"Confirmation",this_to_name:"Card PIN Number"},{prev_fr_name:"Company",this_fr_name:"Tax ID",this_to_name:"Employer Identitification Number"},{prev_fr_name:"Company Registration Number",this_fr_name:"Tax ID",this_to_name:"Employer Identitification Number"},{prev_fr_name:"Driver License Number",this_fr_name:"Card Expires",this_to_name:"Driver License Expires"},{prev_fr_name:"Driver License Number",this_fr_name:"State Or Province",this_to_name:"Driver License State"},{prev_fr_name:"Driver License Expires",this_fr_name:"State Or Province",this_to_name:"Driver License State"},{prev_fr_name:"Driver License State",this_fr_name:"Card Expires",this_to_name:"Driver License Expires"},{prev_fr_name:"Car Make",this_fr_name:"Model",this_to_name:"Car Model"},{prev_fr_name:"Car Make",this_fr_name:"Year",this_to_name:"Car Year"},{prev_fr_name:"Car Make Model",this_fr_name:"Year",this_to_name:"Car Year"},{prev_fr_name:"Car Model",this_fr_name:"Year",this_to_name:"Car Year"},{prev_fr_name:"Car Plate Number",this_fr_name:"Year",this_to_name:"Car Year"},{prev_fr_name:"Vehicle Identification Number",this_fr_name:"Year",this_to_name:"Car Year"},{prev_fr_name:"Car Year",this_fr_name:"Make",this_to_name:"Car Make"},{prev_fr_name:"Car Plate Number",this_fr_name:"Card Expires",this_to_name:"Car Plate Year"},{prev_fr_name:"Car Plate Number",this_fr_name:"State Or Province",this_to_name:"Car Plate State"},{prev_fr_name:"Passport Number",this_fr_name:"Card Expires",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Issue Date",this_fr_name:"Card Expires",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Issue Place",this_fr_name:"Card Expires",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Type",this_fr_name:"Card Expires",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Number",this_fr_name:"Card Expires MM DD YY",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Issue Date",this_fr_name:"Card Expires MM DD YY",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Issue Place",this_fr_name:"Card Expires MM DD YY",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Type",this_fr_name:"Card Expires MM DD YY",this_to_name:"Passport Expiration Date"},{prev_fr_name:"Passport Number",this_fr_name:"Issue Date",this_to_name:"Passport Issue Date"},{prev_fr_name:"Passport Number",this_fr_name:"Issue Place",this_to_name:"Passport Issue Place"},{prev_fr_name:"Passport Issue Date",this_fr_name:"Issue Place",this_to_name:"Passport Issue Place"}];for(u=0;u<F.length;u++){var S=F[u];if(this.m_prev_field_name==S.prev_fr_name&&_==S.this_fr_name){var b;if(""==(h=S.this_to_name))return void logStringMessage("   FillField: correct THIS field "+s+" SKIP\n");if(!(b=this.m_pIdentity.getFields().LookupStandard(h)))continue;var R={sFieldName:h,pFilling:b,bComputed:!1,sMainValue:"",sAltValue:"",info:e,pbEmpty:null,plsValues:[]};this.GetValueWithAlts(R);c={pFilling:b,sFieldName:h,sNewValue:R.sMainValue};this.AddPhonePrefix(c),R.sMainValue=c.sNewValue,logStringMessage("   FillField: correct THIS field: '"+s+"' -> '"+h+"' = '"+R.sMainValue+"'");var T={info:e,sMainValue:R.sMainValue,sAltValue:R.sAltValue,plsValues:R.plsValues,bAllowEVCFtoBlockFill:!0,bSilent:!1,Type:r,sFieldName:h,nPartitionNumber:a,bActuallyFill:l,bIgnoreFNE:!1,bActuallyChanged:this.m_bActuallyChanged,bRedoFormFill:m};if(this.DoFillField(T),T.bRedoFormFill)return;return this.m_prev_field_name=h,this.m_prev_Info=e,void(this.m_prev_part_no=o)}}}var N={info:e,sMainValue:t,sAltValue:i,plsValues:n,bAllowEVCFtoBlockFill:!0,bSilent:!1,Type:r,sFieldName:s,nPartitionNumber:a,bActuallyFill:l,bIgnoreFNE:!1,bActuallyChanged:this.m_bActuallyChanged,bRedoFormFill:m};if(this.DoFillField(N),N.bRedoFormFill)return;this.m_prev_field_name=s,this.m_prev_Info=e,this.m_prev_part_no=o}catch(e){logStringMessage("CFormFiller.FillField error: "+e)}},CFormFiller.prototype.AddPhonePrefix=function(e){var t=e.pFilling,i=e.sFieldName,n=e.sNewValue,r=t.GetFieldFormat().GetDisplayTitle(i);if(""!=r&&""!=n&&"#"==r[0]){var s=this.m_pIdentity.GetPhonePrefixCurrent();logStringMessage("AddPhonePrefix: got phone prefix: "+s),e.sNewValue=s+n}},CFormFiller.prototype.DoFillField=function(e){try{var t=e.info,i=e.sMainValue,n=e.sAltValue,r=e.plsValues,s=e.bAllowEVCFtoBlockFill,a=e.bSilent,o=e.Type,l=e.sFieldName,m=e.nPartitionNumber,_=e.bActuallyFill,d=e.bIgnoreFNE,u=e.bActuallyChanged,f=e.bRedoFormFill;logStringMessage("### 6: DoFillField sMainValue='"+i+"'  sFieldName='"+l+"' bIgnoreFNE="+d+" bActuallyChanged="+u+" bRedoFormFill="+f+" bSendEvents="+this.m_bSendEvents),e.bActuallyChanged=!1,this.m_bActuallyChanged=!1;var p=i;if(this.m_pIdentity&&("state or province"==l.toLowerCase()||"country or country and state"==l.toLowerCase()||"country"==l.toLowerCase()))if((P=t.GetSelectElem())&&P.getAttribute("onchange")){if("City"!=this.m_prev_field_name&&"Zip Or PostCode"!=this.m_prev_field_name&&"Address Lines"!=this.m_prev_field_name&&"Address Line 1"!=this.m_prev_field_name&&"Address Line 2"!=this.m_prev_field_name&&"Address Line 3"!=this.m_prev_field_name&&"Address Line 4"!=this.m_prev_field_name&&"State Or Province"!=this.m_prev_field_name&&"Country"!=this.m_prev_field_name&&"Country Or Country And State"!=this.m_prev_field_name)return void logStringMessage("   DoFillField: preceding field not City/Zip, do not fill\n");RfNormalizePosns1(t.m_position,this.m_prev_Info.m_position);var h=Math.abs(t.m_position.m_x-this.m_prev_Info.m_position.m_x),g=Math.abs(t.m_position.m_y-this.m_prev_Info.m_position.m_y);if(logStringMessage("    DoFillFieldIdentity: SELECT with onchange: dx="+h+" dy="+g),!(h<600&&g<100))return void logStringMessage("           distance too large, do not fill\n");logStringMessage("           have preceding City/Zip, allow this\n")}switch(t.GetType()){case RfFieldType.RfFieldText:case RfFieldType.RfFieldPassword:var c=t.GetInputTextElem(),C=65e3,F=c.getAttribute("maxLength");if((F=null==F||""==F||" "==F?-1:parseInt(F))>=0&&(C=F),this.m_pIdentity){if(r.length){var S=C,b=c.getAttribute("size");(b=null==b||""==b?-1:parseInt(b))>=0&&b<S&&(S=b);var R="";if(p.length<=S)p;else{var T=!1;R=p;for(var N=0;N<r.length;N++){var y=r[N];if(y.length<=S){p=y,T=!0;break}y.length<R.length&&(R=y)}T||(p=R)}}for(var I=0;!((I=p.indexOf(CRLF,I))<0);){var E=p.substr(0,I),v=p.substr(I+2);RfIsStringHieroglyph(p=E+v)||(p=p.substr(0,I)+" "+p.substr(I))}if((p=p.trimRight()).length>C){var M=p.length;M-C==2&&M>=4&&("19"==p.substr(M-4,2)||"20"==p.substr(M-4,2))?(p=p.substr(0,M-4)+p.substr(M-2),logStringMessage("YEAR Value was truncated to len="+C+" : "+p)):M-C==3&&M>=5&&"/"==p[M-5]&&("19"==p.substr(M-4,2)||"20"==p.substr(M-4,2))?(p=p.substr(0,M-5)+p.substr(M-2),logStringMessage(" YEAR Value was truncated to len="+C+" : "+p)):(p=p.substr(0,C),logStringMessage("  Value was truncated to len="+C+" : "+p))}}var A={info:t,pInputElem:c,pElem:c,Type:o,sFieldName:l,nPartitionNumber:m,sValue:p,bAllowEVCFtoBlockFill:s,bSilent:a,bActuallyFill:_,bIgnoreFNE:d,bActuallyChanged:e.bActuallyChanged,bRedoFormFill:e.bRedoFormFill};if(this.DoFillTextField(A),e.bRedoFormFill=A.bRedoFormFill,e.bActuallyChanged=A.bActuallyChanged,A.bRedoFormFill)return;break;case RfFieldType.RfFieldTextArea:logStringMessage("RfFieldType.RfFieldTextArea!!!  VALUE="+i);var x=t.GetTextAreaElem();if(!RfOnBeforeAction(x,o,l,m,i,this.m_pSelection,{m_bChecking:!1}))return void logStringMessage("  --OnBeforeAction prevents filling\n");if(a||(this.m_nFieldsFilled_name++,this.m_nFieldsFilled_unfilled--),s&&""==p&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");var O=x.value;if(!d&&!this.m_bFillNonemptyFields&&""!=O)return this.m_frc<FillRetCode.FillCodeFieldNonEmpty&&(this.m_frc=FillRetCode.FillCodeFieldNonEmpty),void logStringMessage("  --non-empty TEXTAREA field and FNE is Off, skip\n");if(O==p)return logStringMessage("  area: same: [["+l+"]] = [["+O+"]]"),void(this.m_frc<FillRetCode.FillCodeNoDifferentFields&&(this.m_frc=FillRetCode.FillCodeNoDifferentFields));a||(this.m_frc=FillRetCode.FillCodeFieldFilled,this.m_nFieldsFilled_namenotvalue++),this.DecidedToFill({pElem:x,bIsPasswordField:!1}),_?(logStringMessage("  area: '"+l+"': [["+O+"]] -> [["+p+"]]"),e.bActuallyChanged=!0,x.value=p,this.bHighLightTextInput&&this.HightLightFilledField(x)):logStringMessage("###DoFillField  TRY area: "+i);break;case RfFieldType.RfFieldSelect:var P;if(logStringMessage("### Fill Field RfFieldType.RfFieldSelect. VALUE="+i),!RfOnBeforeAction(P=t.GetSelectElem(),o,l,m,i,this.m_pSelection,{m_bChecking:!1}))return void logStringMessage("  --OnBeforeAction prevents filling\n");var L=t.GetSelectOptions();if(!P.multiple){if(logStringMessage("    SELECT: single selection\n"),(j=ChooseSelectOption(p,n,r,L,!1,!1))<0)return void logStringMessage("   --Select: did not find appropriate online value\n");if(p=L[j],a||this.m_nFieldsFilled_name++,s&&""==p&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");var k;k=P.selectedIndex;var D=!0;if(k>0)try{D=(J=P.options[k]).defaultSelected}catch(e){}if(!(d||this.m_bFillNonemptyFields&&"false"!=this.m_bFillNonemptyFields||D))return this.m_frc<FillRetCode.FillCodeFieldNonEmpty&&(this.m_frc=FillRetCode.FillCodeFieldNonEmpty),void logStringMessage("   --non-empty SELECT field and FNE is Off, skip\n");if(k==j)return void logStringMessage("  select: same: '"+l+"' = "+k);if(a||(this.m_frc=FillRetCode.FillCodeFieldFilled,this.m_nFieldsFilled_namenotvalue++),this.DecidedToFill({pElem:P,bIsPasswordField:!1}),logStringMessage("        !DoFillField SET INDEX FOR SELECT. nChosenOption="+j),_){z={pElem:P,info:t,sValue:"",bAlwaysThrowEvents:!0,bRedoFormFill:!1};this.RfPreFillField(z),logStringMessage("  select: '"+l+"': '"+k+"' -> '"+j+"'"),e.bActuallyChanged=!0,P.selectedIndex=j,(this.m_bAlwaysThrowEvents||P.onchange)&&(this.SendInputEvent(this.curDoc,P),this.SendChangeEvent(this.curDoc,P)),this.bHighLightTextInput&&this.HightLightFilledField(P)}else logStringMessage("  TRY select: '"+l+"': '"+k+"' -> '"+j+"'");return}logStringMessage("    SELECT: multiple selection\n");var w=[],V=0,B=0;for(V=0;V<p.length;V=B+1){(B=p.indexOf("\n",V))<0&&(B=p.length);var G=p.substr(V,B-V);""!=(G=(G=G.trimRight("\r\n")).trimRight("\n"))&&w.push(G)}var U=new Array(L.length),H=0;for(H=0;H<U.length;H++)U[H]=!1;var Y=!1,W=0;for(H=0;H<w.length;H++){var j;(j=ChooseSelectOption(w[H],"",r,L,!1,!1))<0||(W++,Y=!0,U[j]=!0)}if(!Y)return void logStringMessage("  --Select: (multiple) did not find appropriate online values\n");if(a||this.m_nFieldsFilled_name++,s&&0==w.length&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");if(a||(this.m_frc=FillRetCode.FillCodeFieldFilled,this.m_nFieldsFilled_namenotvalue++),this.DecidedToFill({pElem:P,bIsPasswordField:!1}),_){var z={pElem:P,info:t,sValue:"",bAlwaysThrowEvents:!0,bRedoFormFill:!1};this.RfPreFillField(z),logStringMessage("  select multi: '"+l+"' ("+W+"/"+U.length+"):"+p),e.bActuallyChanged=!0;var K=P.length;if(null==K){logStringMessage("  --no length, skip\n");break}for(var X=0;X<K;X++){var J;if(!(J=P.item(X)))break;J.selected=!!U[X]}(this.m_bAlwaysThrowEvents||P.onchange)&&(this.SendInputEvent(this.curDoc,P),this.SendChangeEvent(this.curDoc,P)),this.bHighLightTextInput&&this.HightLightFilledField(P)}else logStringMessage("  TRY multi select: '"+l+"': '"+p+"'");break;case RfFieldType.RfFieldRadio:var Z=t.GetRadioOptions();if(!RfOnBeforeAction(Z,o,l,m,i,this.m_pSelection,{m_bChecking:!1}))return void logStringMessage("  --OnBeforeAction prevents filling\n");var $={nChosenOption:-1};if(p=this.ChooseRadioOption(p,n,r,t,$),$.nChosenOption<0)return void logStringMessage("  --Radio: did not find appropriate online value\n");if(a||this.m_nFieldsFilled_name++,s&&""==p&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");if(d&&!this.m_bFillNonemptyFields){0}var q=Z[$.nChosenOption].m_pElement,Q=q.checked;if(Q)return void logStringMessage("  radio: same: '"+l+"' = CHECKED\n");a||(this.m_frc=FillRetCode.FillCodeFieldFilled,this.m_nFieldsFilled_namenotvalue++),_?(logStringMessage("  radio: '"+l+"': '"+Q+"' -> CHECKED"),e.bActuallyChanged=!0,q.click()):logStringMessage("  TRY radio: '"+l+"': '"+Q+"' -> CHECKED, rc="+Q);break;case RfFieldType.RfFieldRadioCheck:var ee=t.GetRadioCheckElem();if((p=p.trimLeft()).length>1)return void logStringMessage("  --radiocheck value longer than 1 char\n");if(!RfOnBeforeAction(ee,o,l,m,i,this.m_pSelection,{m_bChecking:!1}))return void logStringMessage("  --OnBeforeAction prevents filling\n");if(a||this.m_nFieldsFilled_name++,s&&""==p&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");var te=-2;if(!((te=ee.checked)>=-1&&te<=1))return void logStringMessage("   --bad CHECKBOX state, skip\n");if(!d&&!this.m_bFillNonemptyFields&&te)return this.m_frc<FillRetCode.FillCodeFieldNonEmpty&&(this.m_frc=FillRetCode.FillCodeFieldNonEmpty),void logStringMessage("   --non-empty CHECKBOX field and FNE is Off, skip\n");if(te==(ne=""!=p))return void logStringMessage("  check: same: '"+l+"': '"+te+"'");a||(this.m_frc=FillRetCode.FillCodeFieldFilled,this.m_nFieldsFilled_namenotvalue++),this.DecidedToFill({pElem:t.m_pElem,bIsPasswordField:!1}),_?(logStringMessage("  check: '"+l+"': '"+te+"' -> '"+ne+"'"),e.bActuallyChanged=!0,t.m_pElem.click()):logStringMessage("  check: '"+l+"': '"+te+"' -> '"+ne+"'");break;case RfFieldType.RfFieldCheckbox:logStringMessage("### Fill Field RfFieldType.RfFieldRadioCheck: "+p);var ie=t.GetCheckBoxElem();if(!RfOnBeforeAction(ie,o,l,m,i,this.m_pSelection,{m_bChecking:!1}))return void logStringMessage("  --OnBeforeAction prevents filling\n");if(a||this.m_nFieldsFilled_name++,s&&""==p&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");var ne;te=-2;if(!((te=ie.checked)>=-1&&te<=1))return void logStringMessage("   --bad CHECKBOX state, skip\n");if(!d&&!this.m_bFillNonemptyFields&&te)return this.m_frc<FillRetCode.FillCodeFieldNonEmpty&&(this.m_frc=FillRetCode.FillCodeFieldNonEmpty),void logStringMessage("   --non-empty CHECKBOX field and FNE is Off, skip\n");if(te==(ne="*"==p||"1"==p))return void logStringMessage("  check: same: '"+l+"': '"+te+"'\n");a||(this.m_nFieldsFilled_namenotvalue++,this.m_frc=FillRetCode.FillCodeFieldFilled),this.DecidedToFill({pElem:t.m_pElem,bIsPasswordField:!1}),_&&(logStringMessage("  check: '"+l+"': '"+te+"' -> '"+ne+"'"),e.bActuallyChanged=!0,t.m_pElem.click())}}catch(e){logStringMessage("CFormFiller.DoFillField error: "+e)}},CFormFiller.prototype.ChooseRadioOption=function(e,t,i,n,r){var s=[];n.GetRadioTitles(s),r.nChosenOption=ChooseSelectOption(e,t,i,s,!1,!1);var a="";if(r.nChosenOption>=0)a=s[r.nChosenOption];else{var o=n.GetRadioValues();r.nChosenOption=ChooseSelectOption(e,t,i,o,!0,!1),r.nChosenOption>=0&&(a=o[r.nChosenOption])}return a},CFormFiller.prototype.RfFindElemCaptions=function(e,t,i,n,r,s,a){try{var o=r.m_left_caption,l=r.m_upper_caption,m=r.m_right_caption,_=r.m_lower_caption,d=r.m_position,u=r.m_inside_before_caption,f=r.m_inside_after_caption,p=e.getAttribute("id");RfGetNodePosn(e,d);var h=new RfPosition;h.Clone(d),logStringMessage("+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"),logStringMessage("RfFindElemCaptions: NAME="+i+" ID="+p+" TYPE="+t+" bOnlyBefore= "+s+" bOnlyAfter="+a+" posField="+d);var g=e,c=!1,C=null,F=null;if(!a){F=g,C=null;var S={},b=e.sourceIndex||-1,R=0,T=0,N=!0,y=!1,I=!1,E=0,v=-1,M=RF_LEVEL_START,A="",x=-1,O=null,P=new RfPosition,L=0,k=!1,D=!1,w=new RfPosition,V=(new RfPosition,!0),B="",G=!1,U=!1;c=!1;for(var H=0;;){if(++H>50)break;var Y=new RfPosition,W="";if(RfGetAndProcessNextNode(ae={pCurNode:g,pPrevNode:null,pDoc:n,pNodeHelper:null,bGoRight:!1,nLastSIFound:b,nLevel:M,nHtmlNodes:T,nDomNodes:R,lElementVisits:S,pHTMLelem:me=null,sTagName:"",sText:"",posNode:Y,bDidNotGoInside:G,bTextBreak:oe=!1,sLabel:"NODEleft",bBrBeforeText:!1}),G=ae.bDidNotGoInside,oe=ae.bTextBreak,W=ae.sText,B=ae.sTagName,R=ae.nDomNodes,T=ae.nHtmlNodes,M=ae.nLevel,b=ae.nLastSIFound,C=ae.pPrevNode,F=ae.pCurNode,me=ae.pHTMLelem,!F){logStringMessage("NODEleft: no more prev nodes, stop\n");break}if(g=ae.pCurNode,me){logStringMessage(" RfFindElemCaptions: HTML ELEMENT.  TAG='"+B+"' posNode="+Y);var j=!1;if("label"==B){var z=me.getAttribute("for");if(logStringMessage("  got LABEL for "+z),rf_GetNodePosn(me,_e=new RfPosition),!RfIsPosnVisibleStrict(_e)){k=!0,logStringMessage("  skip LABEL with bad coords\n");continue}logStringMessage("  got LABEL for our field, use its position\n"),j=!0}if(j||k){logStringMessage("  compute prev DOM position. bUseLabelPosn = "+j+" bGetDomNodePosn="+k+" bBeforeInput="+V+" nAccumulatedNodes="+E+" NEXT SIBLING="+ae.pPrevNode.nextSibling+" obj_params.nLevel="+ae.nLevel+" nTextLevel="+v+"  obj_params.sTagName="+ae.sTagName+" \n pPrevNode="+ae.pPrevNode),k=!1;var K=new RfPosition;j||1==E&&ae.nLevel==v-1&&"div"!=ae.sTagName&&!ae.pPrevNode.nextSibling?(K.Clone(Y),logStringMessage("  EXACT prev dom node posn="+K)):("br"==B?w.m_x<0?(logStringMessage("  the node before text is BR and we did not see preceding BR\n"),(g_ischrome||g_issafari||g_isfirefox||g_isopera||g_isedge)&&(1==t||7==t||5==t?U&&(Y.m_height=h.m_height,Y.m_y=h.m_y):6==t&&U?(Y.m_height=h.m_height,Y.m_y=h.m_y):Y.m_height=15),K.Clone(Y),U||(K.m_y+=Y.m_height),K.m_x>0&&(K.m_x=0),K.m_height<7&&(K.m_height=7)):(logStringMessage("  the node before text is BR and we have preceding BR prevBR=\n"+w),g_ischrome||g_issafari||g_isopera||g_isedge?1==t||7==t||5==t?(w.m_height=h.m_height,w.m_y=h.m_y,w.m_y-=h.m_height):6==t&&(w.m_height=15,w.m_y=h.m_y,w.m_y-=15):g_isfirefox&&(1!=t&&7!=t&&5!=t||(w.m_y=w.m_y||h.m_y,w.m_height||(w.m_y-=h.m_height),w.m_height=w.m_height||h.m_height)),K.Clone(w),K.m_x>0&&(K.m_x=0)):V?(logStringMessage("  we are right before INPUT!  posField="+d),K.Clone(d),K.m_x>=6*L&&(K.m_x-=6*L)):(logStringMessage("  the node before text is regular: posNode="+Y+" posTxtNode="+K),K.Clone(Y),M<v&&K.m_height>13&&(K.m_height=13,logStringMessage("%%%%%%%%%%%%%%%%%%%%%%%%%%%% posTxtNode="+K)),M>=v&&(K.m_x+=Y.m_width)),K.m_width=6*L,logStringMessage("  APPROX prev dom node nLastTextLen= "+L+"  posn="+K)),x=b,O=me,j?(logStringMessage("1 posNode_acc="+P+"  CLONE  FROM posTxtNode="+K),P.Clone(K)):P.m_pOffsetParent?RfCoverPosns(K,P,P):(logStringMessage("2 posNode_acc="+P+"  CLONE  FROM posTxtNode="+K),P.Clone(K)),logStringMessage("  nNearestSI_acc="+x+"  posNode_acc="+P+"  nNearestSI_accEl="+O),L=0}if("br"==B){if(g_ischrome||g_issafari||g_isfirefox||g_isopera||g_isedge)if(w.m_x<0)P.m_x<0?(w.m_x=0,w.m_width=0,c?(w.m_y=h.m_y-15,w.m_height=15,c=!1):(w.m_y=h.m_y,w.m_height=h.m_height)):w.Clone(P);else{var X=me.previousElementSibling;if(X&&X.tagName&&"br"!=X.tagName.toLowerCase()){var J=new RfPosition;RfGetNodePosn(X,J),w.m_x=0,w.m_y=J.m_y,w.m_width=0,w.m_height=J.m_height}else w.Clone(Y)}else w.Clone(Y);logStringMessage(" sTagName== 'br'.....  posPrevBR="+w)}if(V="br"==B&&-1!=n.URL.indexOf("http://www.credoaction.com"),I){if("br"==B){if(!D){D=!0,logStringMessage("  1st BR: accumulate\n"),A=" "+A;continue}logStringMessage("  2nd BR: stop text accumulation\n")}else D=!1;if("strike"==B||"img"==B||"listing"==B){logStringMessage("  continue accumulating text with space\n"),A=" "+A;continue}if(RfIsTextAccumulationTag(B)){oe?(A=" "+A,logStringMessage("  continue accumulating text with space\n")):logStringMessage("  continue accumulating text with no space. sAccumulatedText="+A);continue}if(""!=A){if(logStringMessage(" 1 process accumulated text '"+A+"' posNode_acc="+P+" posField="+d),!y||"input"!=B&&"select"!=B||t==RfFieldType.RfFieldRadio||t==RfFieldType.RfFieldCheckbox||"hidden"==me.type){if(!RfNormalizePosns1(P,d))break;logStringMessage(" After NORMILIZE  posNode_acc="+P+" posField="+d);var Z=Math.abs(P.m_y-d.m_y),$=RfIsOnSameLine(P,d,-2),q=t==RfFieldType.RfFieldRadio||RfIsOnSameVert(P,d);if(logStringMessage("bSameVert = "+q+"  bSameLine= "+$+" posNode_acc="+P+" posField="+d+" posNode="+Y+"  distY="+Z),1==E&&t==RfFieldType.RfFieldText&&RfIsCaptionInside(P,d)&&RfCheckCaption(u,P,x,A,!1,"inside_before",O),$&&P.m_x<=d.m_x)N?(logStringMessage("  same line + caption: take left caption, now allow only left captions. bOnlyLeftCaptions="+y),RfCheckCaption(o,P,x,A,!1,"left",O)||(logStringMessage("bOnlyLeftCaptions = true"),y=!0)):(logStringMessage("  same line + left captions not allowed: skip, block upper captions\n"),y=!0);else if(!$&&q&&Z<RF_FAR_UPPER_DIST){if(y){logStringMessage("  upper line not too far + allow only left captions: break\n");break}if(logStringMessage("  upper line not too far, same vert: take upper caption\n"),!RfCheckCaption(l,P,x,A,!1,"upper",O)){logStringMessage("upper line not too far -> BREAK  do");break}}else{if(y){logStringMessage("  non-qualifying upper caption + allow only left captions: break\n");break}if(P.m_x<d.m_x&&P.m_y<d.m_y){logStringMessage("  non-qualifying upper left caption: break\n");break}logStringMessage("  non-qualifying upper right caption or lower right: skip\n")}}else logStringMessage("  accumulated text immediately after INPUT + have caption already: skip it\n");A="",P=new RfPosition,I=!1,E=0,v=-1,w=new RfPosition}}if("input"==B||"select"==B){var Q="";if("input"==B&&(Q=me.getAttribute("type"),logStringMessage("!!!sInputType="+Q),Q&&""!=Q||(Q="text"),Q=Q.toLowerCase()),"hidden"==Q||"image"==Q)logStringMessage("  hidden/image input control: skip\n");else{if(!RfNormalizePosns1(Y,d))break;if((Z=Math.abs(Y.m_y-d.m_y))<RF_SAME_LINE_DIST){if(logStringMessage("  left same-line control: disallow left captions, continue!"),N=!1,y){logStringMessage("  left control + allow only left captions: break!");break}}else{if(Z>=RF_FAR_UPPER_DIST){logStringMessage("  FAR upper control: break\n");break}if(y){logStringMessage("  upper control + allow only left captions: break\n");break}if(RfIsOnSameVert(Y,d)){logStringMessage("  upper control above main control: break\n");break}logStringMessage("  upper non-qualifying control: continue\n")}}}else if("pre"==B||"form"==B||"hr"==B||"h1"==B){logStringMessage("  tag "+B+": break\n");break}}var ee=""==W;RfIsCaptionEmpty(W)?(ae.bBrBeforeText&&(logStringMessage(" RfFindElemCaptions: Caption Empty == BREAK_LINE TEXT!"),c=!0),ee||(logStringMessage(" RfFindElemCaptions: Caption Empty and bOrigEmpty=false.  sAccumulatedText="+A),A=" "+A)):(I?(oe?(logStringMessage("  continue accumulating text with space: bTextBreak\n"),A=W+" "+A):1==ae.sText.length?(A=W+A,logStringMessage("  continue accumulating short text with NO space: !bTextBreak  TEXT="+A)):(A=W+" "+A,logStringMessage("  continue accumulating longer text with space: !bTextBreak  TEXT="+A)),E++,L+=W.length):(logStringMessage("  start accumulating text ='"+W+"'"),I=!0,A=W,E=1,L=W.length,U=ae.bBrBeforeText),k=!0,v=ae.nLevel,D=!1)}}if(logStringMessage("***************** Walk to the RIGHT *************************\n"),!s){g=e;B=(B=e.tagName).toLowerCase();S={},b=e.sourceIndex||-1,R=0,T=0;var te=!0,ie=(I=!1,E=0,v=-1,M=RF_LEVEL_START,A="",x=-1,O=null,P=new RfPosition,L=0,new RfPosition);ie.Clone(d);var ne="",re=-1,se=(k=!1,!0);G=!1;c=!1;for(H=0;;){if(++H>50)break;var ae,oe=!1;Y=new RfPosition,W="";if(RfGetAndProcessNextNode(ae={pCurNode:g,pPrevNode:null,pDoc:n,pNodeHelper:null,bGoRight:!0,nLastSIFound:b,nLevel:M,nHtmlNodes:T,nDomNodes:R,lElementVisits:S,pHTMLelem:null,sTagName:"",sText:"",posNode:Y,bDidNotGoInside:G,bTextBreak:oe,sLabel:"NODEright",bBrBeforeText:!1}),!ae.pCurNode){logStringMessage("NODEright: no more next nodes\n");break}g=ae.pCurNode;var le=!1;if(G=ae.bDidNotGoInside,oe=ae.bTextBreak,W=ae.sText,B=ae.sTagName,R=ae.nDomNodes,T=ae.nHtmlNodes,M=ae.nLevel,b=ae.nLastSIFound,C=ae.pPrevNode,F=ae.pCurNode,me=ae.pHTMLelem,ae.pHTMLelem){var me=ae.pHTMLelem;if("label"==B){var _e;me.getAttribute("for");rf_GetNodePosn(me,_e=new RfPosition),RfIsPosnVisibleStrict(_e)?logStringMessage("   got LABEL for our field, continue"):(le=!0,logStringMessage("  stop at LABEL with bad coords"))}if(k){k=!1;K=new RfPosition;var de=ae.pPrevNode.nextSibling,ue=ae.pPrevNode.previousSibling;1!=E||de||ue?(se?(logStringMessage("  immediately after INPUT, use input\n"),K.Clone(d),K.m_x+=d.m_width):(K.Clone(ie),logStringMessage("  use pos of node before DOM text\n  posTxtNode="+K),"br"==ne?(logStringMessage("  node before text is BR\n"),K.m_x=0,g_ischrome||g_issafari||g_isfirefox||g_isopera||g_isedge?(K.m_y=K.m_y||d.m_y,K.m_y+=d.m_height||15):K.m_y+=K.m_height||15):re<v&&K.m_height>10&&(K.m_height=10)),K.m_width=6*L,logStringMessage("  approx prev dom node posn="+K)):(K.Clone(ie),logStringMessage("  exact prev dom node posn="+K)),P.m_pOffsetParent?RfCoverPosns(P,K,P):P.Clone(K),logStringMessage("  nNearestSI_acc= "+x+"  posNode_acc="+P),L=0}if(ae.pCurNode,ne=B,re=ae.nLevel,se=!1,"br"==B&&P.m_x<0?c?ie.Clone(Y):(ie.m_x=h.m_x,ie.m_y=h.m_y,ie.m_width=0,ie.m_height=h.m_height,ie.m_pOffsetParent=Y.m_pOffsetParent):ie.Clone(Y),logStringMessage("bAccumulateText="+I+" sTagName="+B),I){if("img"==B||"listing"==B||"strike"==B){logStringMessage("  continue accumulating text with space\n"),A=" "+A;continue}if(RfIsTextAccumulationTag(B)){logStringMessage("  continue accumulating text with no space\n");continue}if("label"==B&&!le){logStringMessage("  LABEL visible: continue accumulating text with space\n"),A+=" ";continue}if(""!=A){if(logStringMessage("  process accumulated text '"+A+"'"),!RfNormalizePosns1(d,P))break;$=RfIsOnSameLine(d,P,0);if(logStringMessage("bSameLine="+$),1==E&&t==RfFieldType.RfFieldText&&RfIsCaptionInside(P,d)&&RfCheckCaption(f,P,x,A,!1,"inside_after",O),$&&d.m_x+d.m_width+RF_MIN_HORIZ_DIST>=P.m_x)if(te){if(logStringMessage("  right caption: get it\n"),!RfCheckCaption(m,P,x,A,!0,"right",O))break}else logStringMessage("  right caption after control: skip\n");else if(RfIsOnNextLine(P,d)&&Math.abs(P.m_x-d.m_x)<RF_MIN_HORIZ_DIST){if(logStringMessage("  lower caption: take it\n"),!RfCheckCaption(_,P,x,A,!0,"lower",O))break}else{if(Math.abs(P.m_y-d.m_y)>=RF_LOWER_LINE_DIST){logStringMessage("  FAR lower caption: break\n");break}if(!(P.m_x<d.m_x)){logStringMessage("  NEXT lower right caption: break\n");break}logStringMessage("  NEXT lower left caption: skip\n")}}A="",P=new RfPosition,I=!1,E=0,v=-1}else if(le){logStringMessage(" stop with no text accumulated!!!");break}if("input"==B||"select"==B){Q="";if("input"==B&&(""!=(Q=me.getAttribute("type"))&&null!=Q||(Q="text"),Q=Q.toLowerCase()),"hidden"==Q)logStringMessage("   hidden input/select control: skip\n");else{if(!RfNormalizePosns1(Y,d))break;if(Math.abs(Y.m_y-d.m_y)>=RF_LOWER_LINE_DIST){logStringMessage("  FAR lower control: break\n");break}if(Math.abs(Y.m_y-d.m_y)>=RF_SAME_LINE_DIST){if(!(Y.m_x<d.m_x)){logStringMessage("  NEXT lower right control: break\n");break}logStringMessage("  NEXT lower left control: skip\n")}else logStringMessage("  right control: skip\n"),te=!1}}else if("form"==B||"pre"==B||"hr"==B||"h1"==B||"h2"==B||"h3"==B||"h4"==B)break}if(ae.sText){ae.sText=ae.sText.trimRight();var fe=ae.sText.length-1;if(fe>=0&&":"==ae.sText[fe]){logStringMessage("  colon at the end, drop right caption\n"),m=new RfFieldCaption;break}}ee=""==ae.sText;RfIsCaptionEmpty(ae.sText)?ee||(A+=" "):(I?ae.nLevel<v?(logStringMessage("  text level got too low: replace it with space: nLevel = "+ae.nLevel+" nTextLevel = "+v),A+=" "):(logStringMessage("  continue accumulating text\n"),A+=ae.sText,E++,L+=ae.sText.length):(logStringMessage("  start accumulating text\n"),I=!0,A=ae.sText,E=1,L=ae.sText.length,v=ae.nLevel),k=!0,x=b,O=C)}}return o.m_sCaption=RfTrimCaption(o.m_sCaption),l.m_sCaption=RfTrimCaption(l.m_sCaption),m.m_sCaption=RfTrimCaption(m.m_sCaption),_.m_sCaption=RfTrimCaption(_.m_sCaption),u.m_sCaption=RfTrimCaption(u.m_sCaption),f.m_sCaption=RfTrimCaption(f.m_sCaption),logStringMessage(">>>>>RfFindElemCaptions: left='"+o+"'"),logStringMessage(">>>>>RfFindElemCaptions: upper='"+l+"'"),logStringMessage(">>>>>RfFindElemCaptions: right='"+m+"'"),logStringMessage(">>>>>RfFindElemCaptions: lower='"+_+"'"),r.m_left_caption=o,r.m_upper_caption=l,r.m_right_caption=m,r.m_lower_caption=_,r.m_inside_before_caption=u,r.m_inside_after_caption=f,!0}catch(e){return logStringMessage("CFormFiller.RfFindElemCaptions error: "+e),!1}},CFormFiller.prototype.GetNextOrderIndex=function(e){try{var t=0;e=e.toLowerCase();var i=this.m_NamesIndexes[e];return null!=i?(t=parseInt(i)+1,this.m_NamesIndexes[e]=t):this.m_NamesIndexes[e]=0,t}catch(e){return logStringMessage("CFormFiller.GetNextOrderIndex error: "+e),0}},CFormFiller.prototype.FillDocument=function(e,t,i,n,r,s){try{logStringMessage("+++CFormFiller::FillDocument. >> bActuallyFill='"+t+"'  m_bCountFields='"+this.m_bCountFields+"'  bTryFillAnyValuesToo='"+r+"' bFillInvisibleFields='"+i+"' bReturnFields='"+s+"' bSendEvents='"+this.m_bSendEvents+"'"),this.m_frc=FillRetCode.FillCodeNoFormsFound,this.m_bFillingStopped=!1,this.m_nFillAttempts=0,this.m_nFieldsFilled_name=0,this.m_nFieldsFilled_namenotvalue=0,this.m_nFieldsFilled_passwords=0,this.m_nFieldsFilled_unfilled=0,this.m_nFieldsFilled_unused=0,this.m_nFieldsCounted_text=0,this.m_nFieldsCounted_fillable=0,this.m_nFieldsCounted_visible_fillable=0,this.m_nFieldsCounted_textarea=0,this.m_nFieldsCounted_passwords=0,this.m_NamesIndexes={},this.m_aFillableFields=[];if(!e)return logStringMessage("---FillDocument: not a Document\n"),!1;if(this.curDoc=e,RfInitEventSender(this,this.curDoc),s);else if(!this.m_pPasscard)return logStringMessage("CFormFiller.FillDocument passcard is null"),!1;for(var a=!0;a;){logStringMessage("CFormFiller.FillDocument #### START FILLING FIELDS ####");var o=!1,l=!1,m=!1;this.m_NamesIndexes={};var _=new CRfHtmlInputIterator;this.m_aFillableFields=[],logStringMessage("CFormFiller.FillDocument ###ITERATOR:START###"),_.Build2(e),logStringMessage("CFormFiller.FillDocument ###ITERATOR:END###");var d=_.GetSizeofArray();if(0==d)return logStringMessage("CFormFiller.FillDocument html input fields not found"),!1;d>3e3&&(logStringMessage("CFormFiller.FillDocument decrease inputs count to 3000!"),d=3e3);var u=null,f=null,p="",h=0,g=-1,c=0,C=0,F=[];if(this.m_pPasscard&&this.m_pPasscard.m_lFields&&this.m_pPasscard.m_lFields.length)for(var S=0;S<this.m_pPasscard.m_lFields.length;++S){var b=this.m_pPasscard.m_lFields[S];b.m_field_type>RfFieldType.RfField_None&&b.m_field_type<RfFieldType.RfField_Last&&b.m_sName!=RFNAME_LOGINTIP&&F.push(b)}var R=null,T=null,N=null,y="",I=!s&&this.m_pPasscard.IsTwoField();this.m_frc=parseInt(this.m_frc),d>0&&this.m_frc<FillRetCode.FillCodeNoMatchingFields&&(this.m_frc=FillRetCode.FillCodeNoMatchingFields),logStringMessage("***RF: FillDocument. IsTwoField:"+I+"  nItemCount:"+d);for(var E=0;E<d;E++){var v=_.GetNext();if(!v)break;var M=new CRfHtmlObjectProperties,A=RfIsElemVisible(v,M,this.m_bCountFields);if(A||M.bInvisibleButCanChange&&i)if(s)M.bVisible=A,this.m_aFillableFields[this.m_aFillableFields.length]=M,logStringMessage("RF: FillDocument->CONTINUE. RETURN_FIELDS_MODE bVisible:'"+A+"' canChange:'"+M.bInvisibleButCanChange+"'  TYPE='"+M.sType+"' ID='"+M.sId+"' NAME='"+M.sName+"' INDEX="+E);else{var x=new CInputFieldInfo(M.sTagName,M.sName,M.sType,A);logStringMessage("RF: FillDocument TAG:'"+M.sTagName+"' NAME:'"+M.sName+"'  TYPE:'"+M.sType+"'  INDEX:"+E);if(-1!=M.sTagName.indexOf("input")){var O=v;if("text"==M.sType||"password"==M.sType){if(this.m_nFieldsCounted_text++,this.m_nFieldsFilled_unfilled++,this.m_nFieldsCounted_fillable++,A&&this.m_nFieldsCounted_visible_fillable++,"password"==M.sType&&(this.m_nFieldsCounted_passwords++,this.m_pPasswordElem||(this.m_pPasswordElem=O)),this.m_bCountFields){logStringMessage("  --counted");continue}"password"==M.sType?x.InitText(O,RfFieldType.RfFieldPassword,v):x.InitText(O,RfFieldType.RfFieldText,v)}else if("radio"==M.sType){if(this.m_nFieldsCounted_fillable++,A&&this.m_nFieldsCounted_visible_fillable++,this.m_bCountFields){logStringMessage("  --counted");continue}x.InitRadioCheck(O,v);var P=O.value;M.sName=M.sName+":"+P}else{if("checkbox"!=M.sType){logStringMessage("  --not checkbox or radio, skip");continue}if(this.m_nFieldsCounted_fillable++,A&&this.m_nFieldsCounted_visible_fillable++,this.m_bCountFields){logStringMessage("  --counted");continue}x.InitCheckbox(O,v)}}else if(-1!=M.sTagName.indexOf("textarea")){var L=v;if(this.m_nFieldsCounted_text++,this.m_nFieldsFilled_unfilled++,this.m_nFieldsCounted_fillable++,A&&this.m_nFieldsCounted_visible_fillable++,this.m_nFieldsCounted_textarea++,this.m_bCountFields){logStringMessage("  --counted");continue}x.InitTextarea(L,v),L=null}else{if(-1==M.sTagName.indexOf("select"))continue;if(this.m_nFieldsCounted_text++,this.m_nFieldsCounted_fillable++,A&&this.m_nFieldsCounted_visible_fillable++,this.m_bCountFields){logStringMessage("  --counted");continue}var k=v;x.InitSelect(k,v),k=null}var D,w=this.GetNextOrderIndex(M.sName);if((D=this.m_pPasscard.FillingSetUsed(M,w,x.GetType()))&&logStringMessage("***FillDocument. After FillingSetUsed. Tag:'"+M.sTagName+"'  Name:'"+M.sName+"'  Type:'"+M.sType+"'  bCanFill:'"+D+"'  OrderIndex:"+w+"  VALUE:'"+M.sValue+"'"),I){if(D){if(M.sValue!=RF_DEFAULT_VALUE_HERE&&M.sValue!=RF_ANY_VALUE_HERE){var V=!1,B={info:x,sMainValue:M.sValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:M.sName,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:V,bRedoFormFill:o};if(this.DoFillField(B),B.bRedoFormFill){o=!0;break}}}else if("text"==M.sType){M.sName=RFNAME_USERID;var G;(G=this.m_pPasscard.FillingSetUsed(M,0,x.GetType()))&&(N=x,y=M.sValue),logStringMessage("***FillDocument. bTwoFieldPasscard=true. Result from this.m_pPasscard.FillingSetUsed:"+G)}else if("password"==M.sType){if(N){if(logStringMessage("   TwoField: fill memorized"),M.sValue!=RF_DEFAULT_VALUE_HERE&&M.sValue!=RF_ANY_VALUE_HERE){var U={info:N,sMainValue:y,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:RFNAME_USERID,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:!1,bRedoFormFill:o};if(this.DoFillField(U),U.bRedoFormFill){o=!0;break}}N=null}if(M.sName=RFNAME_PASSWORD,this.m_pPasscard.FillingSetUsed(M,0,x.GetType())&&(logStringMessage("   TwoField: fill: Password = "+M.sValue),M.sValue!=RF_DEFAULT_VALUE_HERE&&M.sValue!=RF_ANY_VALUE_HERE)){var H={info:x,sMainValue:M.sValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:RFNAME_PASSWORD,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:!1,bRedoFormFill:o};if(this.DoFillField(H),H.bRedoFormFill){o=!0;break}}}}else{if(c<F.length&&(x.GetType()==F[c].m_field_type&&C++,"password"==M.sType&&null!=u&&null==f&&F[c].m_sValue!=RF_DEFAULT_VALUE_HERE&&F[c].m_sValue!=RF_ANY_VALUE_HERE&&(f=x,p=F[c].m_sValue),D||"password"==M.sType||"checkbox"==M.sType||F[c].m_sValue==RF_DEFAULT_VALUE_HERE||F[c].m_sValue==RF_ANY_VALUE_HERE||(h++,"text"==M.sType&&null==u&&(u=x,g=c)),c++),D&&"password"==M.sType&&!m&&R){var Y={bHasUserid:!1,bHasPassword:!1,sUseridValue:"",sPasswordValue:""};this.m_pPasscard.GetTwoField(Y);if(Y.bHasUserid){var W=new RfPosition;rf_GetNodePosn(v,W);var j=Math.abs(R.m_position.m_x-W.m_x),z=Math.abs(R.m_position.m_y-W.m_y);if(j<user_pass_diff_dist&&z<user_pass_diff_dist&&(logStringMessage("   TwoField1: fill UserID="+Y.sUseridValue),Y.sUseridValue!=RF_ANY_VALUE_HERE)){var K={info:R,sMainValue:Y.sUseridValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:RFNAME_USERID,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:!1,bRedoFormFill:o};if(this.DoFillField(K),K.bRedoFormFill){o=!0;break}}W=null}Y=null}else if(D&&"password"==M.sType&&F.length==C&&1==h&&g>=0){var X={info:u,sMainValue:F[g].m_sValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:RFNAME_USERID,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:!1,bRedoFormFill:o};if(this.DoFillField(X),X.bRedoFormFill){o=!0;break}}V=!1;if(D&&M.sValue!=RF_ANY_VALUE_HERE&&M.sValue!=RF_DEFAULT_VALUE_HERE){var J={info:x,sMainValue:M.sValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:M.sName,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:V,bRedoFormFill:o};if(this.DoFillField(J),J.bRedoFormFill){o=!0;break}V=J.bActuallyChanged}"text"==M.sType?(m=D,logStringMessage("   TwoField: password filled: bUserIdFilled="+m),null==T&&(logStringMessage("   TwoField: nominate to be UserID"),rf_GetNodePosn(v,(R=x).m_position))):"password"==M.sType&&(!l&&V&&(logStringMessage("TwoField: password filled!"),l=!0),null==T&&(logStringMessage("   TwoField: nominate to be Password!"),T=x))}M=null}else logStringMessage("RF: FillDocument->CONTINUE. bVisible:'"+A+"' canChange:'"+M.bInvisibleButCanChange+"'  INDEX:"+E)}if(logStringMessage("AfterPasscardFill: CFormFiller.FillDocument END FOR (nIndex < nItemCount)!!!  password_info="+T+" bPasswordFilled="+l),_=null,!s&&T&&!l){logStringMessage("CFormFiller.FillDocument find userID and password in the passcard...");Y={bHasUserid:!1,bHasPassword:!1,sUseridValue:"",sPasswordValue:""},this.m_pPasscard.GetTwoField(Y);if(F.length==C&&1==h&&g>=0&&(Y.bHasUserid=!0,Y.sUseridValue=F[g].m_sValue,R=u,null!=f&&(Y.bHasPassword=!0,Y.sPasswordValue=p,T=f)),Y.bHasUserid&&R&&Y.sUseridValue!=RF_ANY_VALUE_HERE){var Z=!0;if(Y.bHasPassword&&Y.sPasswordValue!=RF_ANY_VALUE_HERE){var $=R.m_pElem.getBoundingClientRect(),q=T.m_pElem.getBoundingClientRect();j=Math.abs($.top-q.top),z=Math.abs($.left-q.left);(j>user_pass_diff_dist||z>user_pass_diff_dist)&&(Z=!1)}if(Z){logStringMessage("   TwoField2: fill UserID="+Y.sUseridValue);var Q={info:R,sMainValue:Y.sUseridValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:RFNAME_USERID,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:!1,bRedoFormFill:o};if(this.DoFillField(Q),Q.bRedoFormFill){o=!0;break}}}if(Y.bHasPassword&&Y.sPasswordValue!=RF_ANY_VALUE_HERE){logStringMessage("   TwoField2: fill Password="+Y.sPasswordValue);var ee={info:T,sMainValue:Y.sPasswordValue,sAltValue:"",plsValues:[],bAllowEVCFtoBlockFill:!1,bSilent:!1,Type:4,sFieldName:RFNAME_PASSWORD,nPartitionNumber:0,bActuallyFill:t,bIgnoreFNE:!1,bActuallyChanged:!1,bRedoFormFill:o};if(this.DoFillField(ee),ee.bRedoFormFill){o=!0;break}}Y=null}o||(a=!1)}return this.m_FieldsForExtenalFilling.length>0&&CallExternalFilling(this.m_FieldsForExtenalFilling,this.m_pfnFillFieldFromExternalCode),!0}catch(e){return logStringMessage("CFormFiller.FillDocument error: "+e),!1}},CFormFiller.prototype.DecidedToFill=function(e){try{for(var t=e.pElem,i=e.bIsPasswordField,n=t.form,r=n,s=!1,a=0;a<this.m_FilledForms.length;a++){var o=this.m_FilledForms[a];if(o.m_pFormUnknown==n){logStringMessage("   m_FilledForms: logged already:"+r+" PWD's= "+o.m_nPasswordFields),this.m_FilledForms[a].m_nFillableFields++,i&&this.m_FilledForms[a].m_nPasswordFields++,s=!0;break}}if(!s){logStringMessage("   m_FilledForms: add form: "+r);var l=new CFilledFormInfo;l.m_pFormUnknown=r,l.m_nFillableFields=1,l.m_nPasswordFields=i?1:0,this.m_FilledForms.push(l)}}catch(e){logStringMessage("CFormFill.DecidedToFill error: "+e)}},CFormFiller.prototype.SendChangeEvent=function(e,t){try{logStringMessage("   fire onchange event\n");var i=e.createEvent("Events");i.initEvent("change",!0,!1),t.dispatchEvent(i)}catch(e){logStringMessage("*FILLER.JS* Exception in SendChangeEvent:"+e)}},CFormFiller.prototype.SendInputEvent=function(e,t){try{var i=e.createEvent("Events");i.initEvent("input",!0,!1),t.dispatchEvent(i)}catch(e){logStringMessage("*FILLER.JS* Exception in SendInputEvent:"+e)}},CFormFiller.prototype.RfPostFillField=function(e,t,i){try{logStringMessage("RfPostFillField entry  pElem"+e+" bAlwaysThrowEvents="+i),e&&i&&(logStringMessage("   fire onkeyup event\n"),this.SendKeyboardEvent("keyup",t,this.curDoc,e),-1==this.curDoc.URL.indexOf("narrpr.com")&&this.SendChangeEvent(this.curDoc,e))}catch(e){logStringMessage("*FILLER.JS* Exception in RfPostFillField init change:"+e)}},CFormFiller.prototype.RfPreFillField=function(e){try{var t=e.pElem,i=e.info,n=e.sValue,r=e.bAlwaysThrowEvents;e.bRedoFormFill;if(!1,r&&(-1!=this.curDoc.URL.indexOf("saladbars.com")||-1!=this.curDoc.URL.indexOf("wellsoffice.wellsfargo.com")||(-1!=this.curDoc.URL.indexOf("ewealthmanager.com")?(t.onfocus=function(e){},t.focus()):t.focus())),this.m_pPasscard){var s=new CRfHtmlObjectProperties,a=RfIsElemVisible(t,s);if(s.sName!=i.m_sHtmlName||s.sTagName!=i.m_sTagName||s.sType!=i.m_sType||a!=i.m_bVisible){if(logStringMessage("RfPreFillField_#Check_1: HTML elt #CHANGED#! \nNEW_Name='"+s.sName+"' OLD_Name='"+i.m_sHtmlName+"' \nNEW_Tag='"+s.sTagName+"' OLD_Tag='"+i.m_sTagName+"' \nNEW_Type='"+s.sType+"'  OLD_Type='"+i.m_sType+"' NEW_Visibility="+a+" OLD_Visibility="+i.m_bVisible+" m_nFillAttempts="+this.m_nFillAttempts),this.m_nFillAttempts<3)return this.m_nFillAttempts++,void(e.bRedoFormFill=!0);logStringMessage("3 or more form fill attempts, stop redoing!!!\n")}else{if(checkForChangedElement(this.curDoc,t,i,a,s)){if(this.m_nFillAttempts<3)return this.m_nFillAttempts++,void(e.bRedoFormFill=!0);logStringMessage("3 or more form fill attempts, stop redoing!!!\n")}}t&&r&&(logStringMessage("   fire onkeydown event\n"),this.SendKeyboardEvent("keydown",n,this.curDoc,t))}}catch(e){logStringMessage("CFormFill.RfPreFillField error: "+e)}},CRfHtmlObjectProperties.prototype.toString=function(){return"<<CRfHtmlObjectProperties TAG='"+this.sTagName+"' NAME='"+this.sName+"' TYPE='"+this.sType+"' VALUE='"+this.sValue+"' bInvisibleButCanChange='"+this.bInvisibleButCanChange+"' >>"},CFormFiller.prototype.HightLightFilledField=function(e){e&&(e.style.border="solid 2px green",image_roboform_data&&(e.style.backgroundImage="url('"+image_roboform_data+"')",e.style.backgroundPosition="100% 50%",e.style.backgroundRepeat="no-repeat no-repeat"))},CFormFiller.prototype.DoFillTextField=function(e){try{var t=e.info,i=e.pInputElem,n=e.pElem,r=e.Type,s=e.sFieldName,a=e.nPartitionNumber,o=e.sValue,l=e.bAllowEVCFtoBlockFill,m=e.bSilent,_=e.bActuallyFill,d=e.bIgnoreFNE;e.bActuallyChanged,e.bRedoFormFill;if(o==RF_DEFAULT_VALUE_HERE)return;if(!RfOnBeforeAction(i,r,s,a,o,this.m_pSelection,{m_bChecking:!1}))return void logStringMessage("  --OnBeforeAction prevents filling\n");if(m||(this.m_nFieldsFilled_name++,this.m_nFieldsFilled_unfilled--),t.GetType()==RfFieldType.RfFieldPassword&&this.m_nFieldsFilled_passwords++,l&&""==o&&!this.m_bEmptyValuesCauseFilling)return void logStringMessage("  --EmptyValuesCauseFilling encountered empty value\n");var u=i.value;if(!(d||this.m_bFillNonemptyFields&&"false"!=this.m_bFillNonemptyFields))if(""!=u.trim())return this.m_frc<FillRetCode.FillCodeFieldNonEmpty&&(this.m_frc=FillRetCode.FillCodeFieldNonEmpty),void logStringMessage("   --non-empty TEXT field and FNE is Off, skip\n");if(u==o)return logStringMessage("  text: same value: "+s+" -> "+u),void(this.m_frc<FillRetCode.FillCodeNoDifferentFields&&(this.m_frc=FillRetCode.FillCodeNoDifferentFields));if(m||(this.m_frc=FillRetCode.FillCodeFieldFilled,this.m_nFieldsFilled_namenotvalue++),this.DecidedToFill({pElem:n,bIsPasswordField:t.GetType()==RfFieldType.RfFieldPassword}),_){if(logStringMessage("###RF  Fill Field. TYPE=Password || Text  VALUE='"+o+"' TYPE='"+t.GetType()+"'"),this.m_pfnFillFieldFromExternalCode){var f={elem:n,value:o};e.bActuallyChanged=!0,this.m_bActuallyChanged=!0,this.m_FieldsForExtenalFilling.push(f)}else if(IsClareitySafeaccess(this.curDoc.URL)&&this.m_bAlwaysThrowEvents&&this.m_bSendEvents){for(var p="",h=0;h<o.length;++h)p+=o[h],this.SendKeyboardEvent("keydown",p,this.curDoc,n),this.SendKeyboardEvent("keypress",p,this.curDoc,n),n.value=p,this.SendInputEvent(this.curDoc,n),this.SendKeyboardEvent("keyup",p,this.curDoc,n);this.SendChangeEvent(this.curDoc,n),e.bActuallyChanged=!0,this.m_bActuallyChanged=!0}else{var g={pElem:n,info:t,sValue:o,bAlwaysThrowEvents:this.m_bSendEvents,bRedoFormFill:!1};if(this.RfPreFillField(g),g.bRedoFormFill)return void(e.bRedoFormFill=!0);logStringMessage("  text: '"+s+"': '"+u+"' -> '"+o+"'"),e.bActuallyChanged=!0,this.m_bActuallyChanged=!0,-1===this.curDoc.URL.indexOf("banking.bankofscotland.de")&&this.SendKeyboardEvent("keypress",o,this.curDoc,n),n.value=o,this.SendInputEvent(this.curDoc,n),this.RfPostFillField(n,o,this.m_bAlwaysThrowEvents&&this.m_bSendEvents),this.bHighLightTextInput&&this.HightLightFilledField(n)}this.m_pRfOnAfterAction&&this.m_pRfOnAfterAction(s)}else logStringMessage("#DoFillTextField# TRY text: sValue = "+o),this.m_pRfOnAfterAction_IgnoreActualFill&&this.m_pRfOnAfterAction_IgnoreActualFill(s)}catch(e){logStringMessage("ERROR in #DoFillTextField# = "+e)}},RfFieldCaption.prototype.toString=function(){return"CAPTION=["+this.m_sCaption+"] m_Position=["+this.m_Position+"]  m_nNodeSI="+this.m_nNodeSI+" ELEMENT:"+this.m_nElement},CInputFieldInfo.prototype.toString=function(){var e="";return this.m_pElem&&(e=this.m_pElem.id),"{id="+pad_str(e||"''",10)+", name="+pad_str(this.m_sHtmlName?this.m_sHtmlName:"''",10)+", placeholder="+pad_str(this.placeholder?this.placeholder:"''",10)+", title="+pad_str(this.m_sTitle?this.m_sTitle:"''")+"}"},CInputFieldInfo.prototype.InitText=function(e,t,i){this.m_eType=t,this.m_pInputTextElem=e,this.m_pElem=i},CInputFieldInfo.prototype.InitCheckbox=function(e,t){this.m_eType=RfFieldType.RfFieldCheckbox,this.m_pCheckBoxElem=e,this.m_pElem=t},CInputFieldInfo.prototype.InitTextarea=function(e,t){this.m_eType=RfFieldType.RfFieldTextArea,this.m_pTextAreaElem=e,this.m_pElem=t},CInputFieldInfo.prototype.InitSelect=function(e,t){this.m_eType=RfFieldType.RfFieldSelect,this.m_pSelectElem=e,this.m_pElem=t},CInputFieldInfo.prototype.InitRadio=function(){this.m_eType=RfFieldType.RfFieldRadio},CInputFieldInfo.prototype.AddRadioOption=function(e){this.m_lRadioOptions[this.m_lRadioOptions.length]=e},CInputFieldInfo.prototype.GetRadioOptions=function(){return this.m_lRadioOptions},CInputFieldInfo.prototype.SetRadioOptions=function(e){this.m_lRadioOptions=e},CInputFieldInfo.prototype.GetRadioValues=function(){return this.m_bRadioValuesComputed||this.ComputeRadioValues(),this.m_asRadioValues},CInputFieldInfo.prototype.GetRadioTitles=function(e){switch(this.m_eType){case RfFieldType.RfFieldRadio:for(var t=0;t<this.m_lRadioOptions.length;t++)e[e.length]=this.m_lRadioOptions[t].m_sTitle}},CInputFieldInfo.prototype.InitRadioCheck=function(e,t){this.m_eType=RfFieldType.RfFieldRadioCheck,this.m_pCheckBoxElem=e,this.m_pElem=t},CInputFieldInfo.prototype.ComputeRadioValues=function(){switch(this.m_eType){case RfFieldType.RfFieldRadio:for(var e=0;e<this.m_lRadioOptions.length;e++){var t=this.m_lRadioOptions[e].m_pElement.value;t&&""!=t||(t=RFNAME_NONAME),RfNormalizeSelectValue(t,null,this.m_asRadioValues,!0)}}this.m_bRadioValuesComputed=!0},CInputFieldInfo.prototype.IsSet=function(){return null!=this.m_pElem},CInputFieldInfo.prototype.GetType=function(){return this.m_eType},CInputFieldInfo.prototype.GetTitle=function(){return this.m_sTitle},CInputFieldInfo.prototype.SetTitle=function(e){this.m_sTitle=e},CInputFieldInfo.prototype.GetRadioCheckElem=function(){return this.m_pCheckBoxElem},CInputFieldInfo.prototype.GetCheckBoxElem=function(){return this.m_pCheckBoxElem},CInputFieldInfo.prototype.GetTextAreaElem=function(){return this.m_pTextAreaElem},CInputFieldInfo.prototype.GetInputTextElem=function(){return this.m_pInputTextElem},CInputFieldInfo.prototype.GetSelectElem=function(){return this.m_pSelectElem},CInputFieldInfo.prototype.GetSelectOptions=function(){return this.m_bSelectOptionsComputed||this.ComputeSelectOptions(),this.m_asSelectOptions},CInputFieldInfo.prototype.ComputeSelectOptions=function(){try{var e;e=this.m_pSelectElem.length;for(var t=0;t<e;t++){var i=this.m_pSelectElem.options[t];if(!i)break;var n=i.text;this.m_asSelectOptions[t]=n}this.m_bSelectOptionsComputed=!0}catch(e){logStringMessage("ERROR in CInputFieldInfo.ComputeSelectOptions :"+e)}},CInputFieldInfo.prototype.GetName=function(){return this.m_bNameComputed||this.ComputeName(),this.m_sName},CInputFieldInfo.prototype.ComputeName=function(){var e="";switch(this.m_eType){case RfFieldType.RfFieldText:(e=this.m_pInputTextElem.getAttribute("name"))&&""!=e||(e=RFNAME_NONAME);break;case RfFieldType.RfFieldTextArea:(e=this.m_pTextAreaElem.getAttribute("name"))&&""!=e||(e=RFNAME_NONAME);break;case RfFieldType.RfFieldSelect:(e=this.m_pSelectElem.getAttribute("name"))&&""!=e||(e=RFNAME_NONAME);break;case RfFieldType.RfFieldCheckbox:case RfFieldType.RfFieldRadioCheck:(e=this.m_pCheckBoxElem.getAttribute("name"))&&""!=e||(e=RFNAME_NONAME);break;case RfFieldType.RfFieldRadio:(e=this.m_lRadioOptions[0].m_pElement.getAttribute("name"))&&""!=e||(e=RFNAME_NONAME);break;default:e=RFNAME_NONAME}this.m_sName=e.toLowerCase(),this.m_bNameComputed=!0},CRfHtmlInputIterator.prototype.GetSizeofArray=function(){return this.m_nSize},CRfHtmlInputIterator.prototype.AccessSelectElement=function(e){try{if(this.m_pSelectElement=null,this.m_nSelectSrcIndex=-1,e==this.m_nSelectCount)return void(this.m_nSelectSrcIndex=this.m_nVeryLargeSrcIndex);if(this.m_pSelectElement=this.pSelectsArr[e],!this.m_pSelectElement)return;this.m_nSelectSrcIndex=this.m_pSelectElement.sourceIndex}catch(e){logStringMessage("ERROR in CRfHtmlInputIterator.AccessSelectElement: "+e)}},CRfHtmlInputIterator.prototype.AccessTextAreaElement=function(e){try{if(this.m_pTextAreaElement=null,this.m_nTextAreaSrcIndex=-1,e==this.m_nTextAreaCount)return void(this.m_nTextAreaSrcIndex=this.m_nVeryLargeSrcIndex);if(this.m_pTextAreaElement=this.pTextAreaArr[e],!this.m_pTextAreaElement)return;this.m_nTextAreaSrcIndex=this.m_pTextAreaElement.sourceIndex}catch(e){logStringMessage("ERROR in CRfHtmlInputIterator.AccessTextAreaElement: "+e)}},CRfHtmlInputIterator.prototype.AccessInputElement=function(e){try{if(this.m_pInputElement=null,this.m_nInputSrcIndex=-1,e==this.m_nInputCount)return void(this.m_nInputSrcIndex=this.m_nVeryLargeSrcIndex);if(this.m_pInputElement=this.pInputsArr[e],!this.m_pInputElement)return;this.m_nInputSrcIndex=this.m_pInputElement.sourceIndex}catch(e){logStringMessage("ERROR in CRfHtmlInputIterator.AccessInputElement: "+e)}},CRfHtmlInputIterator.prototype.Reset=function(){return this.m_nInputSrcIndex=0,this.m_nTextAreaSrcIndex=0,this.m_nSelectSrcIndex=0,this.m_nInputIndex=0,this.m_nSelectIndex=0,this.m_nTextAreaIndex=0,this.m_pForm||(this.AccessInputElement(0),this.AccessTextAreaElement(0),this.AccessSelectElement(0)),!0},CRfHtmlInputIterator.prototype.Build2=function(e){try{this.m_nSelectCount=0,this.m_nInputCount=0,this.m_nTextAreaCount=0,this.pInputsArr=e.getElementsByTagName("input"),this.pInputsArr&&(this.m_nInputCount=this.pInputsArr.length),this.pSelectsArr=e.getElementsByTagName("select"),this.pSelectsArr&&(this.m_nSelectCount=this.pSelectsArr.length),this.pTextAreaArr=e.getElementsByTagName("textarea"),this.pTextAreaArr&&(this.m_nTextAreaCount=this.pTextAreaArr.length),logStringMessage("CRfHtmlInputIterator.Build2.  INPUT="+this.pInputsArr.length+"  SELECT="+this.pSelectsArr.length+"  TEXTAREA="+this.pTextAreaArr.length),this.m_nSize=this.m_nInputCount+this.m_nTextAreaCount+this.m_nSelectCount,this.Reset()}catch(e){logStringMessage("Build2 error:"+e)}},CRfHtmlInputIterator.prototype.GetNext=function(){try{var e=null;if(this.m_nInputIndex+this.m_nTextAreaIndex+this.m_nSelectIndex>=this.m_nSize)return!1;if(this.m_pInputElement)this.m_pSelectElement&&this.m_pTextAreaElement?4&this.m_pInputElement.compareDocumentPosition(this.m_pSelectElement)?4&this.m_pInputElement.compareDocumentPosition(this.m_pTextAreaElement)?(e=this.m_pInputElement,this.m_nInputIndex++,this.AccessInputElement(this.m_nInputIndex)):(e=this.m_pTextAreaElement,this.m_nTextAreaIndex++,this.AccessTextAreaElement(this.m_nTextAreaIndex)):4&this.m_pSelectElement.compareDocumentPosition(this.m_pTextAreaElement)?(e=this.m_pSelectElement,this.m_nSelectIndex++,this.AccessSelectElement(this.m_nSelectIndex)):(e=this.m_pTextAreaElement,this.m_nTextAreaIndex++,this.AccessTextAreaElement(this.m_nTextAreaIndex)):this.m_pSelectElement&&!this.m_pTextAreaElement?4&this.m_pInputElement.compareDocumentPosition(this.m_pSelectElement)?(e=this.m_pInputElement,this.m_nInputIndex++,this.AccessInputElement(this.m_nInputIndex)):(e=this.m_pSelectElement,this.m_nSelectIndex++,this.AccessSelectElement(this.m_nSelectIndex)):!this.m_pSelectElement&&this.m_pTextAreaElement?4&this.m_pInputElement.compareDocumentPosition(this.m_pTextAreaElement)?(e=this.m_pInputElement,this.m_nInputIndex++,this.AccessInputElement(this.m_nInputIndex)):(e=this.m_pTextAreaElement,this.m_nTextAreaIndex++,this.AccessTextAreaElement(this.m_nTextAreaIndex)):this.m_pSelectElement||this.m_pTextAreaElement||(e=this.m_pInputElement,this.m_nInputIndex++,this.AccessInputElement(this.m_nInputIndex));else if(this.m_pSelectElement)this.m_pTextAreaElement?4&this.m_pSelectElement.compareDocumentPosition(this.m_pTextAreaElement)?(e=this.m_pSelectElement,this.m_nSelectIndex++,this.AccessSelectElement(this.m_nSelectIndex)):(e=this.m_pTextAreaElement,this.m_nTextAreaIndex++,this.AccessTextAreaElement(this.m_nTextAreaIndex)):(e=this.m_pSelectElement,this.m_nSelectIndex++,this.AccessSelectElement(this.m_nSelectIndex));else{if(!this.m_pTextAreaElement)return!1;e=this.m_pTextAreaElement,this.m_nTextAreaIndex++,this.AccessTextAreaElement(this.m_nTextAreaIndex)}return e}catch(e){return logStringMessage("error in GetNext: "+e),null}},CRfHtmlInputIterator.prototype.BuildForm=function(e){try{return this.Build2(e),this.m_pForm=e,!0}catch(e){return logStringMessage("ERROR in CRfHtmlInputIterator.BuildForm: "+e),!1}},CRfHtmlInputIterator.prototype.BuildFormMoz=function(e){try{this.m_nSelectCount=0,this.m_nInputCount=0,this.m_nTextAreaCount=0;for(var t=e.elements,i=[],n=0;n<t.length;++n)i.push(t[n]);i.sort(function(e,t){return 3-(6&e.compareDocumentPosition(t))});for(var r=0,s=i.length;r<s;r++)"input"==i[r].tagName.toLowerCase()?(i[r].sourceIndex=r,this.pInputsArr[this.pInputsArr.length]=i[r]):"select"==i[r].tagName.toLowerCase()?(i[r].sourceIndex=r,this.pSelectsArr[this.pSelectsArr.length]=i[r]):"textarea"==i[r].tagName.toLowerCase()&&(i[r].sourceIndex=r,this.pTextAreaArr[this.pTextAreaArr.length]=i[r]);this.m_nInputCount=this.pInputsArr.length,this.m_nSelectCount=this.pSelectsArr.length,this.m_nTextAreaCount=this.pTextAreaArr.length,logStringMessage("CRfHtmlInputIterator.BuildFormMoz.  INPUT="+this.pInputsArr.length+"  SELECT="+this.pSelectsArr.length+"  TEXTAREA="+this.pTextAreaArr.length),this.m_nSize=this.m_nInputCount+this.m_nTextAreaCount+this.m_nSelectCount,this.Reset()}catch(e){logStringMessage("ERROR  in CRfHtmlInputIterator.BuildFormMoz. "+e)}},CRfHtmlInputIterator.prototype.Build3=function(e){try{this.m_nSelectCount=0,this.m_nInputCount=0,this.m_nTextAreaCount=0;var t=[];if(this.pInputsColl=e.getElementsByTagName("input"),this.pInputsColl){this.m_nInputCount=this.pInputsColl.length;for(var i=0;i<this.m_nInputCount;i++)t.push(this.pInputsColl[i])}if(this.pSelectsColl=e.getElementsByTagName("select"),this.pSelectsColl){this.m_nSelectCount=this.pSelectsColl.length;for(var n=0;n<this.m_nSelectCount;n++)t.push(this.pSelectsColl[n])}if(this.pTextAreaColl=e.getElementsByTagName("textarea"),this.pTextAreaColl){this.m_nTextAreaCount=this.pTextAreaColl.length;for(var r=0;r<this.m_nTextAreaCount;r++)t.push(this.pTextAreaColl[r])}t.sort(function(e,t){return 3-(6&e.compareDocumentPosition(t))});var s=0;for(i=t.length;s<i;s++)"input"==t[s].tagName.toLowerCase()?(t[s].sourceIndex=s,this.pInputsArr[this.pInputsArr.length]=t[s]):"select"==t[s].tagName.toLowerCase()?(t[s].sourceIndex=s,this.pSelectsArr[this.pSelectsArr.length]=t[s]):"textarea"==t[s].tagName.toLowerCase()&&(t[s].sourceIndex=s,this.pTextAreaArr[this.pTextAreaArr.length]=t[s]);logStringMessage("CRfHtmlInputIterator.Build3.  INPUT="+this.pInputsArr.length+"  SELECT="+this.pSelectsArr.length+"  TEXTAREA="+this.pTextAreaArr.length),this.m_nSize=this.m_nInputCount+this.m_nTextAreaCount+this.m_nSelectCount,this.Reset()}catch(e){logStringMessage("ERROR in CRfHtmlInputIterator.Build2:"+e)}},RfPosition.prototype.Clone=function(e){this.m_nOffsetParentSI=e.m_nOffsetParentSI,this.m_x=e.m_x,this.m_y=e.m_y,this.m_width=e.m_width,this.m_height=e.m_height,this.m_pOffsetParent=e.m_pOffsetParent},RfPosition.prototype.toString=function(){var e="NULL";return this.m_pOffsetParent&&(e="[ TAG:'"+this.m_pOffsetParent.tagName+"' ",e+=" ID:'"+this.m_pOffsetParent.id+"' ]"),"X="+this.m_x+" Y="+this.m_y+" WIDTH="+this.m_width+" HEIGHT="+this.m_height+" PARENT="+e};var SUFFIX_UNLISTEDVALUE_SET="_-UserDef-_",EGroupType={enGROUP_TYPE_STANDARD:0,enGROUP_TYPE_CUSTOM:1,enGROUP_TYPE_SUMMARY:2},EnRetCode={enRetCode_Succeeded:0,enRetCode_WrongGroup:1,enRetCode_NotExists:2,enRetCode_AlreadyExists:3,enRetCode_Single:4,enRetCode_Empty:5},CValueType={valueNormal:0,valueSelect:1,valueMultiline:2,valueSectional:3},LOAD_FLAG_NO_FORM_FILLING=1,optionYesNo=0,optionSelect=1;function RfGarbleString(e){for(var t=[],i=0;i<e.length;i++)t+=String.fromCharCode(e.charCodeAt(i)^37*i-85&255);return t}function A2S(e){return String.fromCharCode.apply(null,e)}function TBitComb(e,t,i,n){this.m_aBitCombination=[n||0,i||0,t||0,e||0]}TBitComb.prototype.SetBit=function(e){var t=31&e,i=1<<t,n=e>>5;this.m_aBitCombination[n]|=i,logStringMessage("nBitPos:"+e+" right_part:"+t+" right_part_final:"+i+"  arr_index:"+n+"\n"+this.toString())},TBitComb.prototype.not=function(){return new TBitComb(~this.m_aBitCombination[3],~this.m_aBitCombination[2],~this.m_aBitCombination[1],~this.m_aBitCombination[0])},TBitComb.prototype.and=function(e){return new TBitComb(this.m_aBitCombination[3]&e.m_aBitCombination[3],this.m_aBitCombination[2]&e.m_aBitCombination[2],this.m_aBitCombination[1]&e.m_aBitCombination[1],this.m_aBitCombination[0]&e.m_aBitCombination[0])},TBitComb.prototype.IsNull=function(){return 0==(this.m_aBitCombination[0]|this.m_aBitCombination[1]|this.m_aBitCombination[2]|this.m_aBitCombination[3])},TBitComb.prototype.toString=function(){return"<<TBitComb>> :"+this.m_aBitCombination},TBitComb.prototype.TestMask=function(e){for(var t=0,i=eBC_SIZE_DW-1;i>=0;--i)t|=this.m_aBitCombination[i]&e.m_aBitCombination[i];return 0!=t};var BITCOM_YESNO_MASK=new TBitComb(4278190080,0,0,0),BITCOM_SELECTION_MASK=BITCOM_YESNO_MASK.not();function IsBitCombMatch(e,t){return!BITCOM_SELECTION_MASK.and(e).and(t).IsNull()&&BITCOM_YESNO_MASK.and(e).and(t.not()).IsNull()}function StringFile(e){this.str=e,this.ptr=0,this.m_Id=Math.floor(10001*Math.random())}StringFile.prototype.loadList=function(e){for(var t=[],i=this.readInt(),n=0;n<i;n++)t[n]=e(this);return t},StringFile.prototype.readByte=function(){return this.str.charCodeAt(this.ptr++)},StringFile.prototype.readBool=function(){return!!this.readByte()},StringFile.prototype.readWord=function(){return(this.readByte()<<0)+(this.readByte()<<8)},StringFile.prototype.readInt=function(){return(this.readWord()<<0)+(this.readWord()<<16)},StringFile.prototype.read=function(e){return this.ptr+=e,this.str.substring(this.ptr-e,this.ptr)},StringFile.prototype.readStringLength=function(){var e=this.readByte();if(e<255)return e;var t=this.readWord();if(65534==t)throw{message:"ReadStringLength: UNICODE string prefix"};return t<65535?t:this.readInt()},StringFile.prototype.readStringUTF8Garbled=function(){var e=this.readStringLength();return e?A2S(Utf8ToUtf16(RfGarbleString(this.read(e)))):""},StringFile.prototype.loadStringList=function(){return this.loadList(function(e){return e.readStringUTF8Garbled()})},StringFile.prototype.readBitComb=function(){for(var e=new TBitComb,t=0;t<eBC_SIZE_DW;t++)e.m_aBitCombination[t]=this.readInt();return e},StringFile.prototype.toString=function(){return"<<StringFile>>  ID:"+this.m_Id+" file_POS:"+this.ptr};var gStaticRules=null;function getStaticRules(){if(gStaticRules)return gStaticRules;function e(e){var t=new CFieldRule;if(t.m_lsSubstrings=e.loadStringList(),t.m_Precision=e.readByte(),t.m_bReductionComputed=e.readBool(),t.m_lsdSubstringsReduced=e.loadList(loadMatchStringData),t.m_nWordsCount=e.readInt(),t.m_Precision)for(var i=0;i<t.m_lsSubstrings.length;i++)t.m_lsSubstrings[i]="="+t.m_lsSubstrings[i];return t}var t=new StringFile(window.atob(RFB_RULES));return gStaticRules=t.loadList(function(t){var i=new CFieldNameRules;return i.m_BitComb=t.readBitComb(),i.m_sFieldName=t.readStringUTF8Garbled(),i.m_nPartNumber=t.readInt(),i.m_bValueMatch=t.readBool(),i.m_lRules=t.loadList(e),i})}function CFieldRule(e,t){if(this.m_Precision=CPrecision.precisionSubstring,this.m_bReductionComputed=!1,this.m_lsSubstrings=[],this.m_lsdSubstringsReduced=[],this.m_nWordsCount=0,1!=arguments.length)return 2==arguments.length?(this.m_Precision=CPrecision.precisionSubstring,this.m_bReductionComputed=!1,this.m_nWordsCount=0,void this.InitStandard(e,t)):void 0}function CFieldNameRules(e,t,i){if(this.m_BitComb=new TBitComb,this.m_sFieldName="",this.m_nPartNumber=0,this.m_bValueMatch=!1,this.m_lRules=[],3==arguments.length)return this.m_bValueMatch=!1,this.m_nPartNumber=t,this.m_sFieldName=e,void(this.Country=i)}CFieldRule.prototype.GetWordsCount=function(){return this.m_bReductionComputed||this.ComputeReduction(),this.m_nWordsCount},CFieldRule.prototype.ComputeReduction=function(){try{this.m_lsdSubstringsReduced.length=0,this.m_nWordsCount=0;for(var e=0;e<this.m_lsSubstrings.length;e++){var t=new CMatchStringData(this.m_lsSubstrings[e]);""!=t.GetStringData().GetWhole()&&(t.GetStringData().GetWordsCount()>this.m_nWordsCount&&(this.m_nWordsCount=t.GetStringData().GetWordsCount()),this.m_lsdSubstringsReduced[this.m_lsdSubstringsReduced.length]=t)}this.m_bReductionComputed=!0}catch(e){logStringMessage("ERROR in CFieldRule::ComputeReduction "+e.message,!0)}},CFieldRule.prototype.GetSubstringsReduced=function(){return this.m_bReductionComputed||this.ComputeReduction(),this.m_lsdSubstringsReduced},CFieldRule.prototype.GetPrecision=function(){return this.m_Precision},CFieldRule.prototype.InitStandard=function(e,t){this.m_bReductionComputed=!1,this.m_Precision=t,this.m_lsSubstrings=e,this.m_lsSubstrings.length&&(this.m_lsSubstrings[0]=this.m_lsSubstrings[0].toLowerCase())},CFieldRule.prototype.toString=function(){return"##CFieldRule##  m_bReductionComputed="+this.m_bReductionComputed+"  _Precision="+this.m_Precision+" m_lsSubstrings="+this.m_lsSubstrings+" m_nWordsCount="+this.m_nWordsCount+"  VALUE='"+this.m_lsSubstrings[0]+"'"},CFieldNameRules.prototype.toString=function(){return"<<CFieldNameRules>> for  FIELD_NAME='"+this.m_sFieldName+"  m_nPartNumber="+this.m_nPartNumber+"  m_bValueMatch="+this.m_bValueMatch+" BitComb:"+this.m_BitComb+"'  RULES.COUNT:"+this.m_lRules.length};var gStaticOptions=null;function COptionVariant(){this.m_sInternalName="",this.m_sLangCode=""}function COption(){this.m_sName="",this.m_Type=0,this.m_lsVariants=[]}function loadOptionVariant(e){var t=new COptionVariant;return t.m_sInternalName=e.readStringUTF8Garbled(),t.m_sLangCode=e.readStringUTF8Garbled(),t}function loadOption(e){var t=new COption;return t.m_sName=e.readStringUTF8Garbled(),t.m_Type=e.readInt(),t.m_lsVariants=e.loadList(loadOptionVariant),t}function getStaticOptions(){if(gStaticOptions)return gStaticOptions;var e=RFB_OPTIONS,t=new StringFile(window.atob(e));return gStaticOptions=t.loadList(loadOption)}COptionVariant.prototype.getDisplayName=function(){return this.m_sInternalName},COptionVariant.prototype.toString=function(){return"<<COptionVariant>>  NAME='"+this.m_sInternalName+"' Lang_Code = "+this.m_sLangCode},COption.prototype.toString=function(){return"<<COption>>  OPTION_NAME='"+this.m_sName+"' Type="+this.m_Type+"  Number of variants="+this.m_lsVariants.length};var gStaticFields=null;function loadTitleStringData(e){var t={};return t.m_sWhole=e.readStringUTF8Garbled(),t.m_sNormalized=e.readStringUTF8Garbled(),t.m_sInsideBrackets=e.readStringUTF8Garbled(),t.m_bBracketsStructureIsCorrect=e.readByte(),t.m_bBracketsEncountered=e.readByte(),t.m_nWordsCount=e.readWord(),t}function loadMatchStringData(e){var t={};return t.m_sdString=loadTitleStringData(e),t.m_sNameReduced=e.readStringUTF8Garbled(),t.m_bNameOnly=e.readBool(),t.m_bExactMatch=e.readBool(),t}function CFieldsCodePage(){this.m_nCodePage=0,this.m_BitComb=null}function CIdentityGroup(){this.m_sName="",this.m_sDisplayName="",this.m_GroupBitComb=null,this.m_lFields=[]}function getStaticFields(){if(gStaticFields)return gStaticFields;function e(e,t){var i=t||new CIdentityGroup;return i.m_sName=e.readStringUTF8Garbled(),i.m_sDisplayName=e.readStringUTF8Garbled(),i.m_GroupBitComb=e.readBitComb(),i}function t(e){var t=new CSection;return t.m_eType=e.readByte(),t.m_sValue=e.readStringUTF8Garbled(),t.m_nSize=e.readInt(),t}function i(e){var t=new CPart;return t.m_eType=e.readByte(),t.m_nSize=e.readInt(),t.m_sValueName=e.readStringUTF8Garbled(),t.m_nPartNumber=e.readInt(),t}function n(e){var t={};return t.m_sMainValue=e.readStringUTF8Garbled(),t.m_lsValues=e.loadStringList(),t}function r(e){var t={};return t.m_eType=e.readByte(),t.m_sValue=e.readStringUTF8Garbled(),t.m_nPartNumber=e.readInt(),t}function s(e){var s=new CFieldFormat;return s.m_sCaption=e.readStringUTF8Garbled(),s.m_VType=e.readInt(),s.m_lsdMatches=e.loadList(loadMatchStringData),s.m_nMaxLength=e.readInt(),s.m_nMaxLines=e.readInt(),s.m_nMaxLineLength=e.readInt(),s.m_lOptions=e.loadList(n),s.m_Spec=function(e){var n=new CSectionSpec;return n.m_fInputFormat=e.loadList(t),n.m_lPartitionings=e.loadList(function(e){return e.loadList(i)}),n}(e),s.m_sdMainMatch=loadMatchStringData(e),s.m_bTextOnly=e.readBool(),s.m_bSelectOnly=e.readBool(),s.m_bNumberOnly=e.readBool(),s.m_lFormula=e.loadList(r),s}function a(e){var t=new CIdentityField;return t.m_sGroupName=e.readStringUTF8Garbled(),t.m_nFieldIndex=e.readInt(),t.m_FieldFormat=s(e),t}var o=new StringFile(window.atob(RFB_FIELDS));return(gStaticFields={}).codePages=o.loadList(function(e){var t=new CFieldsCodePage;return t.m_nCodePage=e.readInt(),t.m_BitComb=e.readBitComb(),t}),gStaticFields.fieldSet=function(e){var t=[],i=e.readInt();logStringMessage("*identities.js*  getStaticFields.loadFieldSet  number of CIdentityField's="+i);for(var n=0;n<i;n++){var r=e.readBitComb(),s=e.readStringUTF8Garbled(),o=a(e);o.FieldName=s,o.bitComb=r,t.push(o)}return t}(o),gStaticFields.standardGroups=o.loadList(function(t){var i=new CIdentityGroup;return i.m_lFields=t.loadStringList(),e(t,i),i}),gStaticFields.summaryGroup=e(o),gStaticFields.customGroup=e(o),gStaticFields}function CMatchStringData(e){if(this.m_sdString=new CTitleStringData,this.m_sNameReduced="",this.m_bNameOnly=!1,this.m_bExactMatch=!1,1==arguments.length)try{this.m_bNameOnly=!1,this.m_bExactMatch=!1,(e=e.trim()).length>=2&&"@"==e[0]&&(this.m_bNameOnly=!0,e=(e=e.substr(1)).trimLeft()),e.length>=1&&"="==e[0]&&(this.m_bExactMatch=!0,e=(e=e.substr(1)).trimLeft()),this.m_sdString=new CTitleStringData(e),e=this.m_sdString.GetWhole();for(var t=0;t<e.length;t++)if(!RfIsCharAlphaNum(e[t])){var i=e.substr(0,t),n=e.substr(t+1);e=i+n,t--}return void(this.m_sNameReduced=e)}catch(e){logStringMessage("ERROR in CMatchStringData::ctor(1) "+e.toString())}}function CStringMatch(e,t,i,n,r,s,a,o){this.m_bValid=!1,this.m_bValueMatch=!1,this.m_nWordsCount=0,this.m_nTailLength=0,this.m_pField=null}function CSelOption(){this.m_sMainValue="",this.m_lsValues=[]}function CSectionSpec(e){this.m_fInputFormat=[],this.m_lPartitionings=[]}CFieldsCodePage.prototype.toString=function(){return"<<CFieldsCodePage>>  CodePage='"+this.m_nCodePage+"' BitComb="+this.m_BitComb},CIdentityGroup.prototype.toString=function(){return"<<CIdentityGroup>>  NAME='"+this.m_sName+"' DISPLAY='"+this.m_sDisplayName+"' FIELDS:"+this.m_lFields+" Bits:"+this.m_GroupBitComb},CIdentityGroup.prototype.clone=function(){var e=new CIdentityGroup;return e.m_sName=this.m_sName,e.m_sDisplayName=this.m_sDisplayName,e.m_GroupBitComb=this.m_GroupBitComb,e.m_lFields=copyArray(this.m_lFields),e},CMatchStringData.prototype.GetNameReduced=function(){return this.m_sNameReduced},CMatchStringData.prototype.GetNameOnly=function(){return this.m_bNameOnly},CMatchStringData.prototype.GetExactMatch=function(){return this.m_bExactMatch},CMatchStringData.prototype.GetStringData=function(){return this.m_sdString},CMatchStringData.prototype.GetStringRepresentation=function(){var e="";return(this.m_bNameOnly||"true"==this.m_bNameOnly)&&(e+="@"),(this.m_bExactMatch||"true"==this.m_bExactMatch)&&(e+="="),e+=this.m_sdString.GetWhole()},CMatchStringData.prototype.Clear=function(){this.m_bNameOnly=!1,this.m_bExactMatch=!1,this.m_sNameReduced="",this.m_sdString.Clear()},CMatchStringData.prototype.toString=function(){return"<<CMatchStringData>>  m_bNameOnly="+this.m_bNameOnly+" m_bExactMatch="+this.m_bExactMatch+"  m_sNameReduced='"+this.m_sNameReduced+"'  m_sdString="+this.m_sdString},CStringMatch.prototype.setParameters=function(e,t,i,n,r,s,a,o,l){if(this.m_bValid=!1,this.m_bValueMatch=!1,this.m_nWordsCount=0,this.m_nTailLength=0,this.m_pField=null,3==e){this.m_bValueMatch=!0;var m=t[0],_=[];switch(m.GetType()){case RfFieldType.RfFieldSelect:_=m.GetSelectOptions();break;case RfFieldType.RfFieldRadio:m.GetRadioTitles(_);break;default:return}var d=i.getFields(),u=n.GetCurrentInstanceName(d),f=n.GetValue(d,u,{bComputed:!1,pbEmpty:null,info:null}),p=[];if((R=n.GetFieldFormat()).GetType()==CValueType.valueSelect)for(var h=new Set,g=R.GetOptions(),c=g.length,C=0;C<c;C++){var F=g[C];h.has(F.m_sMainValue)||(h.add(F.m_sMainValue),p.push(F.m_sMainValue));for(var S=0;S<F.m_lsValues.length;S++)h.has(F.m_lsValues[S])||(h.add(F.m_lsValues[S]),p.push(F.m_lsValues[S]))}var b=ChooseSelectOption(f,"",p,_,!1,!0,l);return this.m_bValid=b>=0,void(this.m_bValid&&logStringMessage(" CStringMatch RuleMatch byValue: nChosenOption="+b+" sMainValue="+f))}if(4==e){if(n){var R;if((R=n.GetFieldFormat()).GetIsCustom())(T=new CStringMatch).InitNonReduced(R.GetMainMatchString(),s,a,o,l),T.isBetter(this)&&(this.m_bValid=T.m_bValid,this.m_bValueMatch=T.m_bValueMatch,this.m_nWordsCount=T.m_nWordsCount,this.m_nTailLength=T.m_nTailLength,this.m_pField=T.m_pField);for(C=0;C<R.GetMatchesList().length;C++){var T;(T=new CStringMatch).InitNonReduced(R.GetMatchesList()[C],s,a,o,l),T.isBetter(this)&&(this.m_bValid=T.m_bValid,this.m_bValueMatch=T.m_bValueMatch,this.m_nWordsCount=T.m_nWordsCount,this.m_nTailLength=T.m_nTailLength,this.m_pField=T.m_pField)}return}if(r)return void this.Init(r.m_bReductionComputed?r.m_lsdSubstringsReduced:r.GetSubstringsReduced(),s,r.m_Precision,a,o,r.m_nWordsCount,l)}},CStringMatch.prototype.IsValid=function(){return this.m_bValid},CStringMatch.prototype.Init=function(e,t,i,n,r,s,a){this.m_nTailLength=-1,this.m_bValid=!0,this.m_nWordsCount=s;for(var o=e.length,l=0;l<o;++l){var m=e[l],_=0;if(n){if(m.m_bNameOnly){if(!r){this.m_bValid=!1;break}}else if(r){this.m_bValid=!1;break}_=this.StringCorresponds(m.m_sNameReduced,t.m_sNameReduced,i,n,a)}else _=this.SubstringCorresponds(m.m_sdString,t.m_sdString,i,n,a);if(_<0){this.m_bValid=!1;break}(_<this.m_nTailLength||this.m_nTailLength<0)&&(this.m_nTailLength=_)}},CStringMatch.prototype.SubstringCorresponds=function(e,t,i,n,r){return this.StringCorresponds(e.m_bBracketsEncountered?e.m_sWhole:e.m_sNormalized,e.m_bBracketsEncountered?t.m_sWhole:t.m_sNormalized,i,n,r)},CStringMatch.prototype.StringCorresponds=function(e,t,i,n,r){if(""==e||""==t||"$"==e[0])return-1;var s=e.toLowerCase(),a=t.toLowerCase();switch(i){case CPrecision.precisionSubstring:var o,l=-1;if((o=s.indexOf(""))>=0&&o<s.length-1){var m=!1;r&&(m=RfIsStringHieroglyph(e))&&(s=s.split(" ").join(""),a=a.split(" ").join(""));var _,d=s.substr(0,o),u=s.substr(o+1),f=0;(_=a.indexOf(d))>=0&&(f=a.indexOf(u,_+d.length))>=0&&(l=a.length-f,m&&(this.m_nWordsCount=f+u.length-_),logStringMessage("  RuleMatch: matched '"+e+"' to '"+a+"'"),logStringMessage("    bNoWords="+m+" m_nWordsCount="+this.m_nWordsCount+" nBestTail="+l))}else{var p=!1,h=-1;for(r&&(p=RfIsStringHieroglyph(e))&&(s=s.split(" ").join(""),a=a.split(" ").join(""));(h=a.indexOf(s,h+1))>=0;)(p||n||(h<=0||!RfIsCharAlphaNum(a.charAt(h-1)))&&(h+s.length>=a.length||!RfIsCharAlphaNum(a.charAt(h+s.length))))&&(l=a.length-h-s.length,p&&(this.m_nWordsCount=s.length));l>=0&&(logStringMessage("  RuleMatch: found '"+e+"' in "+a),logStringMessage("  bNoWords1="+p+" bIsName="+n+" m_nWordsCount="+this.m_nWordsCount+" nBestTail="+l))}return l;case CPrecision.precisionExact:var g=a==s?0:-1;if(g>=0){var c=!1;r&&(c=RfIsStringHieroglyph(e))&&(s=s.split(" ").join(""),a=a.split(" ").join(""),this.m_nWordsCount=s.length),logStringMessage("  RuleMatch: '"+e+"' == '"+a+"' bNoWords2 = "+c+" bIsName = "+n+" m_nWordsCount = "+this.m_nWordsCount)}return g}return-1},CStringMatch.prototype.InitNonReduced=function(e,t,i,n,r){try{var s=CPrecision.precisionSubstring;if(e.GetNameOnly()?!i||!n:i&&n)return;e.GetExactMatch()&&(s=CPrecision.precisionExact);var a=[];a.push(e),this.Init(a,t,s,i,n,e.GetStringData().GetWordsCount(),r)}catch(e){logStringMessage("ERROR in CStringMatch::InitNonReduced: "+e.message,!1)}},CStringMatch.prototype.isBetter=function(e){return this.m_bValid&&(!e.m_bValid||!this.m_bValueMatch&&(e.m_bValueMatch||this.m_nWordsCount>e.m_nWordsCount||this.m_nWordsCount==e.m_nWordsCount&&this.m_nTailLength<e.m_nTailLength)||this.m_bValueMatch&&!e.m_bValueMatch&&!e.m_pField)},CStringMatch.prototype.Clone=function(e){this.m_bValid=e.m_bValid,this.m_bValueMatch=e.m_bValueMatch,this.m_nWordsCount=e.m_nWordsCount,this.m_nTailLength=e.m_nTailLength,this.m_pField=e.m_pField},CStringMatch.prototype.toString=function(){return"CStringMatch OBJECT. m_bValid="+this.m_bValid+" m_bValueMatch="+this.m_bValueMatch+"  m_nWordsCount="+this.m_nWordsCount+"  m_nTailLength="+this.m_nTailLength},CSelOption.prototype.toString=function(){return"###CSelOption###. m_sMainValue="+this.m_sMainValue+" ITEMS="+this.m_lsValues.length},CSectionSpec.prototype.Clear=function(){this.m_fInputFormat.length=0,this.m_lPartitionings.length=0},CSectionSpec.prototype.toString=function(){return"<<<CSectionSpec>>> SECTIONS="+this.m_fInputFormat.length+"\n"+this.m_fInputFormat+"\t\t\t\t\t\tPARTS="+this.m_lPartitionings.length+"\n"+this.m_lPartitionings};var CEntryType={Literal:0,Variable:1};function CEntry(e,t,i){return this.m_eType=CEntryType.Literal,this.m_nPartNumber=0,this.m_sValue="",1==arguments.length?(this.m_eType=CEntryType.Literal,this.m_sValue=e,void(this.m_nPartNumber=0)):3==arguments.length?(this.m_eType=e,this.m_sValue=t,void(this.m_nPartNumber=i)):2==arguments.length?(this.m_eType=e,this.m_sValue=t,void(this.m_nPartNumber=-1)):void 0}function CSection(e){if(this.m_sValue="",this.m_nSize=0,this.m_eType=0,0==arguments.length)return this.m_eType=CSectionType.Literal,void(this.m_nSize=0);1!=arguments.length||(isNaN(e)?(this.m_eType=CSectionType.Literal,this.m_nSize=0,this.m_sValue=e):(this.m_eType=CSectionType.Variable,this.m_nSize=e))}function CPart(e,t){return this.m_sValueName="",this.m_nPartNumber=0,this.m_nSize=0,this.m_eType=0,0==arguments.length?(this.m_eType=CPartType.Number,this.m_nSize=0,void(this.m_nPartNumber=0)):1==arguments.length?(this.m_eType=CPartType.Number,this.m_nSize=e,void(this.m_nPartNumber=0)):2==arguments.length?(this.m_eType=CPartType.Variable,this.m_sValueName=e,this.m_nSize=0,void(this.m_nPartNumber=t)):void 0}function COptionNamePair(){this.m_sMainValue="",this.m_sDisplayName=""}function CFieldFormat(){this.m_VType=CValueType.valueNormal,this.m_bIsCustom=!1,this.m_sCaption="",this.m_lsdMatches=[],this.m_bTextOnly=!1,this.m_bSelectOnly=!1,this.m_bNumberOnly=!1,this.m_nMaxLength=-1,this.m_nMaxLines=-1,this.m_nMaxLineLength=-1,this.m_lFormula=[],this.m_lOptions=[],this.m_Spec=new CSectionSpec,this.m_sdMainMatch=new CMatchStringData}CEntry.prototype.toString=function(){return"###CEntry###. m_eType="+this.m_eType+" m_nPartNumber="+this.m_nPartNumber+" m_sValue="+this.m_sValue},CSection.prototype.toString=function(){return"<#CSection#>  m_sValue='"+this.m_sValue+"'  m_nSize='"+this.m_nSize+"'  m_eType='"+this.m_eType+"'\n"},CPart.prototype.toString=function(){return"<#CPart#>  m_sValueName='"+this.m_sValueName+"'  m_nPartNumber='"+this.m_nPartNumber+"'  m_nSize='"+this.m_nSize+"' \n"},CFieldFormat.prototype.toString=function(){for(var e=this.m_bTextOnly?" TEXT_ONLY ":"",t=this.m_bSelectOnly?" SELECT_ONLY ":"",i=this.m_bNumberOnly?" NUMBER_ONLY ":"",n=-1!=this.m_nMaxLength?" MAX_LENGTH:"+this.m_nMaxLength:"",r=-1!=this.m_nMaxLines?" MAX_LINES:"+this.m_nMaxLines:"",s=-1!=this.m_nMaxLineLength?" MAX_LINE_LENGTH:"+this.m_nMaxLineLength:"",a=this.m_bIsCustom?" CUSTOM ":"",o="",l=0;l<this.m_lsdMatches.length;++l)o+="\n"+this.m_lsdMatches[l];return"<<CFieldFormat>> CAPTION='"+this.m_sCaption+"'"+e+t+i+n+a+r+s+"  m_VType:"+this.m_VType+"\n\t\t\tMAIN_MATCH:"+this.m_sdMainMatch+"\n\t\t\tMATCHES:"+o+"\n\t\t\tSPECS:"+this.m_Spec},CFieldFormat.prototype.GetOptions=function(){return this.m_lOptions},CFieldFormat.prototype.Clear=function(){try{this.m_VType=CValueType.valueNormal,this.m_bIsCustom=!1,this.m_bTextOnly=!1,this.m_bSelectOnly=!1,this.m_bNumberOnly=!1,this.m_sCaption="",this.m_lsdMatches.length=0,this.m_nMaxLength=-1,this.m_nMaxLines=-1,this.m_nMaxLineLength=-1,this.m_lOptions.length=0,this.m_lFormula.length=0,this.m_Spec.Clear(),this.m_sdMainMatch.Clear()}catch(e){logStringMessage("ERROR in CFieldFormat::Clear"+e.message,!0)}},CFieldFormat.prototype.FormatValue=function(e,t){try{if(0==this.m_Spec.m_fInputFormat.length)return logStringMessage("  FormatValue: no format, value not changed: "+e),e;var i=40;if(t&&t.GetType()==RfFieldType.RfFieldText){var n=t.GetInputTextElem();if(n){var r=n.getAttribute("size");r&&""!=r||(r=n.size?n.size:-1),r>=0&&r<i&&(i=r);var s=n.getAttribute("maxLength");(s=s&&""!=s?parseInt(s):-1)>=0&&s<i&&(i=s)}}i||(i=40);var a="";if(a=this.FormatValueTry(e,!0,!1),logStringMessage("  FormatValue: sValue="+e+" field_length="+i+" sResult="+a),i>=0&&a.length>i){for(var o=!1,l=0;l<this.m_Spec.m_fInputFormat.length;l++){var m=this.m_Spec.m_fInputFormat[l];m.m_eType==CSectionType.Literal&&"|"==m.m_sValue[0]&&(o=!0)}o?(a=this.FormatValueTry(e,!0,!0)).length>i&&(a=this.FormatValueTry(e,!1,!0)):a=this.FormatValueTry(e,!1,!1)}return a}catch(e){return logStringMessage("ERROR in CFieldFormat::FormatValue"+e.message,!1),""}},CFieldFormat.prototype.FormatValueTry=function(e,t,i){try{logStringMessage("  FormatValueTry: sValue="+e+" bIncludeLiterals="+t+" bBreak="+i+" this.m_Spec.m_fInputFormat="+this.m_Spec.m_fInputFormat);for(var n="",r=e,s=!0,a=!0,o=0,l=!1,m=0;m<this.m_Spec.m_fInputFormat.length;m++){var _=this.m_Spec.m_fInputFormat[m],d="";switch(parseInt(_.m_eType)){case 0:if(i&&"|"==_.m_sValue[0]){l=!0;break}var u;if(t)-1!=(u=(d=_.m_sValue).indexOf("|"))&&(d=d.substring(u+1)),-1!=(u=d.indexOf("!"))&&(d=d.substring(u+1)),o=n.length;break;case 1:d=(d=r.substr(0,_.m_nSize)).trimRight();var f=Math.min(r.length,_.m_nSize);r=r.substring(f),""==d||IsSpace(d)||(a=!1,o=-1)}if(l)break;IsSpace(d)?s||(n+=d,s=!0):(n+=d,s=!1)}return a&&(n=""),o>=0&&(n=n.substr(0,o)),n}catch(e){return logStringMessage("ERROR in CFieldFormat::FormatValueTry "+e.message,!1),""}},CFieldFormat.prototype.SetMatchesList=function(e){this.m_lsdMatches=e},CFieldFormat.prototype.GetMatchesList=function(){return this.m_lsdMatches},CFieldFormat.prototype.GetType=function(){return this.m_VType},CFieldFormat.prototype.SetType=function(e){this.m_VType=e.m_VType,this.m_bIsCustom=e.m_bIsCustom,this.m_nMaxLength=e.m_nMaxLength,this.m_nMaxLines=e.m_nMaxLines,this.m_nMaxLineLength=e.m_nMaxLineLength,this.m_lOptions=e.m_lOptions,this.m_Spec=e.m_Spec,this.m_sdMainMatch=e.m_sdMainMatch,e.m_bTextOnly&&(this.m_bTextOnly=!0),e.m_bSelectOnly&&(this.m_bSelectOnly=!0),e.m_bNumberOnly&&(this.m_bNumberOnly=!0)},CFieldFormat.prototype.SetFormula=function(e){this.m_lFormula=e.m_lFormula},CFieldFormat.prototype.IsFormulaEmpty=function(){return 0==this.m_lFormula.length},CFieldFormat.prototype.GetComputable=function(){return!this.IsFormulaEmpty()},CFieldFormat.prototype.GetMaxLength=function(){return this.m_nMaxLength},CFieldFormat.prototype.SetCaption=function(e){this.m_sCaption=e},CFieldFormat.prototype.GetCaption=function(){return this.m_sCaption},CFieldFormat.prototype.GetDisplayTitle=function(e){return""==this.m_sCaption?e:this.m_sCaption},CFieldFormat.prototype.IsInfoField=function(e){var t=this.GetDisplayTitle(e);return t.length>=2&&(":"==t[0]||":"==t[1]||";"==t[0]||";"==t[1])},CFieldFormat.prototype.GetMainMatchString=function(){return this.m_sdMainMatch},CFieldFormat.prototype.DeleteAllMatches=function(){this.m_lsdMatches.length=0},CFieldFormat.prototype.AddMatch=function(e){var t=new CMatchStringData(e);""!=t.GetStringData().GetWhole()&&this.m_lsdMatches.push(t)},CFieldFormat.prototype.SetMatchesString=function(e){this.m_lsdMatches.length=0;if(e&&""!=e)for(var t=e.split(";"),i=0;i<t.length;++i)this.AddMatch(t[i])},CFieldFormat.prototype.SetCustom=function(e,t){this.m_bIsCustom=!0,this.m_sdMainMatch=new CMatchStringData(e),this.SetMatchesString(t)},CFieldFormat.prototype.SetTypeMultiline=function(e,t){null==e&&(e=-1),null==t&&(t=-1),this.m_VType=CValueType.valueMultiline,this.m_nMaxLines=e,this.m_nMaxLineLength=t},CFieldFormat.prototype.GetIsCustom=function(){return this.m_bIsCustom},CFieldFormat.prototype.GetSpec=function(){return this.m_Spec},CFieldFormat.prototype.GetBestPartitioning=function(e){try{for(var t=this.GetSpec(),i=null,n=0,r=0;r<t.m_lPartitionings.length;r++){var s=t.m_lPartitionings[r];if(s.length>n&&s.length<=e&&(i=s,n=s.length),n==e)break}return i}catch(e){return logStringMessage("ERROR in CFieldFormat::GetBestPartitioning "+e.message,!1),null}},CFieldFormat.prototype.Satisfies=function(e,t){try{if(this.m_bTextOnly&&(e.GetType()==RfFieldType.RfFieldSelect||e.GetType()==RfFieldType.RfFieldRadio||e.GetType()==RfFieldType.RfFieldCheckbox))return!1;if(this.m_bSelectOnly&&e.GetType()!=RfFieldType.RfFieldSelect&&e.GetType()!=RfFieldType.RfFieldRadio&&e.GetType()!=RfFieldType.RfFieldCheckbox)return!1;if(e.GetType()==RfFieldType.RfFieldSelect&&(t.indexOf("Date Of Birth")>=0||t.indexOf("Card Expires")>=0)){var i=this.m_lOptions.length,n=e.GetSelectOptions().length;if(i>=12&&i<=14){if(!(n>=12&&n<=16))return logStringMessage("CFieldFormat::Satisfies: Month NOT: nSelIdent="+i+" nSelOnl="+n),!1}else if(i>=31&&i<=32&&!(n>=30&&n<=36))return logStringMessage("CFieldFormat::Satisfies: Month NOT: nSelIdent="+i+" nSelOnl="+n),!1}if(this.m_bNumberOnly)switch(e.GetType()){case RfFieldType.RfFieldSelect:case RfFieldType.RfFieldRadio:var r=[];e.GetType()==RfFieldType.RfFieldRadio&&e.GetRadioTitles(r);for(var s=e.GetType()==RfFieldType.RfFieldRadio?r:e.GetSelectOptions(),a=0,o=0;o<s.length;o++)if(isNaN(s[o])&&++a>1)return!1;break;case RfFieldType.RfFieldCheckbox:return!1}return!0}catch(e){return logStringMessage("ERROR in CFieldFormat::Satisfies "+e.message,!1),!1}},CFieldFormat.prototype.GetMatchesString=function(){for(var e="",t=0;t<this.m_lsdMatches.length;t++)e&&(e+="; "),e+=this.m_lsdMatches[t].GetStringRepresentation();return e},CFieldFormat.prototype.assign=function(e){return this.m_VType=e.m_VType,this.m_bIsCustom=e.m_bIsCustom,this.m_sCaption=e.m_sCaption,this.m_nMaxLineLength=e.m_nMaxLineLength,this.m_bTextOnly=e.m_bTextOnly,this.m_bSelectOnly=e.m_bSelectOnly,this.m_bNumberOnly=e.m_bNumberOnly,this.m_nMaxLength=e.m_nMaxLength,this.m_nMaxLines=e.m_nMaxLines,this.m_lsdMatches=copyArray(e.m_lsdMatches),this.m_lFormula=copyArray(e.m_lFormula),this.m_lOptions=copyArray(e.m_lOptions),this.m_Spec=e.m_Spec,this.m_sdMainMatch=e.m_sdMainMatch,this},CFieldFormat.prototype.clone=function(){return(new CFieldFormat).assign(this)};var CFieldValue=function(){this.m_bComputed=!1,this.m_bEmpty=!1,this.m_sValue="",this.m_pSelectedOption=null};function CIdentityField(){this.m_sGroupName="",this.m_FieldFormat=new CFieldFormat,this.m_nFieldIndex=0,this.m_mFieldValues={},this.bitComb=new TBitComb,this.FieldName="",this.m_bComputing=!1,this.m_nIndex=Math.floor(10001*Math.random())}function CIdentityFieldSet(e){this.CGroupInstances=function(){this.m_mInstances={},this.m_sDefaultInstanceName=DEF_INSTANCE,this.m_mInstances[DEF_INSTANCE]=!0,this.m_nIndex=Math.floor(10001*Math.random()),this.GetCurrentInstanceName=function(){return this.m_sDefaultInstanceName},this.SetDefaultInstanceName=function(e){try{return this.m_sDefaultInstanceName=e,EnRetCode.enRetCode_Succeeded}catch(e){return logStringMessage("ERROR in CGroupInstances::SetDefaultInstanceName "+e.message,!0),0}},this.getInstances=function(){var e=[];for(var t in this.m_mInstances)e.push(t.toString());return e},this.toString=function(){return"<-### [CGroupInstances] OBJECT.  ID:"+this.m_nIndex+"  DEFAULT INST_NAME: "+this.m_sDefaultInstanceName+" ###->"}},this.CExtraField=function(e,t){this.m_sFieldName="",this.m_sFieldValue="",2==arguments.length&&(this.m_sFieldName=e,this.m_sFieldValue=t)};try{if(e)for(var t in e)logStringMessage("*identities.js*   CIdentityFieldSet ctor \nOPTION='"+t+"'  VALUE='"+e[t]+"'");else logStringMessage("*identities.js*   CIdentityFieldSet ctor NO OPTIONS!");this.m_mOptionValues=e||{},this.m_mStandardFields=[],this.m_lStandardGroups=[],this.m_summaryGroup=null,this.m_customGroup=null,this.m_aCustomFields=[],this.m_mGroupInstances={},this.m_lAllRules=[],this.m_lUnlistedValues=[],this.m_nAddIndex=0,this.m_nIndex=Math.floor(10001*Math.random()),this.mIndexes={},this.nMaxIndex=0;for(var i=this.GetRequiredBits(),n=getStaticFields(),r=n.fieldSet,s=0;s<r.length;s++){if(IsBitCombMatch((f=r[s]).bitComb,i))if(this.m_mStandardFields[f.FieldName]){var a=this.m_mStandardFields[f.FieldName].clone(),o=f.m_nFieldIndex<a.m_nFieldIndex,l=o?f.clone():a.clone(),m=o?a.clone():f.clone();l.GetFieldFormat().IsFormulaEmpty()&&l.m_FieldFormat.SetFormula(m.GetFieldFormat()),""==l.GetFieldFormat().GetCaption()&&l.m_FieldFormat.SetCaption(m.GetFieldFormat().GetCaption()),l.GetFieldFormat().GetType()==CValueType.valueNormal&&l.GetFieldFormat().GetMaxLength()<0&&l.m_FieldFormat.SetType(m.GetFieldFormat()),l.GetFieldFormat().GetMatchesList().length||l.m_FieldFormat.SetMatchesList(m.GetFieldFormat().GetMatchesList()),this.mIndexes[m.m_nFieldIndex]=void 0,this.m_mStandardFields[m.m_nFieldIndex]=void 0,this.m_mStandardFields[l.FieldName]=l,this.m_mStandardFields[l.m_nFieldIndex]=l,this.mIndexes[l.m_nFieldIndex]=l.FieldName,this.nMaxIndex<l.m_nFieldIndex&&(this.nMaxIndex=l.m_nFieldIndex)}else{var _=f.clone();_.m_nFieldIndex=f.m_nFieldIndex,this.m_mStandardFields[_.FieldName]=_,this.m_mStandardFields[_.m_nFieldIndex]=_,this.mIndexes[f.m_nFieldIndex]=f.FieldName,this.nMaxIndex<f.m_nFieldIndex&&(this.nMaxIndex=f.m_nFieldIndex)}}var d=n.standardGroups;for(s=0;s<d.length;s++){var u=d[s];IsBitCombMatch(u.m_GroupBitComb,i)&&(u=u.clone(),logStringMessage("*** ADD Group to current identity:\n"+u),this.m_lStandardGroups[u.m_sName]=u,this.m_lStandardGroups.push(u),this.m_mGroupInstances[u.m_sName]=this.m_mGroupInstances[u.m_sName]||new this.CGroupInstances)}for(s=0;s<this.m_mStandardFields.length;s++){var f;(f=this.m_mStandardFields[s])&&this.m_lStandardGroups[f.m_sGroupName]&&this.m_lStandardGroups[f.m_sGroupName].m_lFields.push(f.FieldName)}IsBitCombMatch(n.summaryGroup.m_GroupBitComb,i)&&(this.m_summaryGroup=n.summaryGroup.clone()),IsBitCombMatch(n.customGroup.m_GroupBitComb,i)&&(this.m_customGroup=n.customGroup.clone());var p=getStaticRules();this.m_lAllRules=p.filter(function(e){return IsBitCombMatch(e.m_BitComb,i)})}catch(e){logStringMessage("Error in CIdentityFieldSet::constructor : "+e.message,!1)}}CFieldValue.prototype={assign:function(e){return this.m_bComputed=e.m_bComputed,this.m_bEmpty=e.m_bEmpty,this.m_sValue=e.m_sValue,this.m_pSelectedOption=e.m_pSelectedOption,this},clone:function(){return(new CFieldValue).assign(this)}},CIdentityField.prototype.assign=function(e){return this.m_sGroupName=e.m_sGroupName,this.m_nFieldIndex=e.m_nFieldIndex,this.m_FieldFormat=e.m_FieldFormat.clone(),this.m_mFieldValues=cloneObject(e.m_mFieldValues),this.bitComb=e.bitComb,this.FieldName=e.FieldName,this.m_bComputing=e.m_bComputing,this.m_nIndex=e.m_nIndex,this},CIdentityField.prototype.clone=function(){return(new CIdentityField).assign(this)},CIdentityField.prototype.toString=function(){return"<<CIdentityField>>  m_sGroupName='"+this.m_sGroupName+"' NAME='"+this.FieldName+"'  m_bComputing="+this.m_bComputing+" ID="+this.m_nIndex+" INDEX="+this.m_nFieldIndex+" Bits:"+this.bitComb+"\n\t\tFormat:"+this.m_FieldFormat},CIdentityField.prototype.ComputeValue=function(e,t,i){try{if(this.m_bComputing)return;this.m_bComputing=!0,logStringMessage("  ComputeValue: ");for(var n="",r=0;r<this.m_FieldFormat.m_lFormula.length;r++){var s=this.m_FieldFormat.m_lFormula[r];logStringMessage(" type="+s.m_eType+" value="+s.m_sValue+" part="+s.m_nPartNumber);var a="";switch(s.m_eType){case 0:if(a=s.m_sValue,r>0){if(""==n&&""!=a){Array.isArray(a)||(a=[a]);a.every(not(isPunctuationSign))||(a="")}var o=this.m_FieldFormat.m_lFormula[r+1];if(!o)break;if(1==o.m_eType){if(!(m=e.LookupStandard(o.m_sValue)))continue;var l=m.GetValue(e,t,{bComputed:!1,pbEmpty:null,info:null});l&&""!=l||(logStringMessage("ComputeValue: empty literal "+a),a="")}}break;case 1:!0;var m,_=s.m_sValue;if(!(m=e.LookupStandard(_))){logStringMessage("VARIABLE. CANNOT FIND FIELD="+s.m_sValue);continue}if(""!=(a=m.GetValue(e,t))&&!1,s.m_nPartNumber>=0){var d=s.m_nPartNumber;if(d>=22e3){var u=22001==d||22003==d;if(d>=22002){var f=0;for(f=a.length-1;f>=0&&!IsCharSpaceRF(a.charCodeAt(f));f--);if(f>0&&f<a.length&&!isNaN(a[f+1])){var p=a[f+1];parseInt(p)>=0&&parseInt(p)<=9&&(a=u?a.substr(f+1):a.substr(0,f))}}else if(""!=a&&a[0]>="0"&&a[0]<="9"){f=0;for(f=0;f<a.length&&!IsCharSpaceRF(a.charCodeAt(f));f++);a=u?f+1>=a.length?"":a.substr(f+1):a.substr(0,f)}var h=(a=a.trim()).lastIndexOf(",");-1!=h&&h==a.length-1&&(a=a.substring(0,a.length-1))}else if(d>=2e4){var g=(d-2e4)%1e3,c=d>=21e3,C=a.indexOf(String.fromCharCode(g));logStringMessage("pos="+C+" bRight="+c+" breaker="+g),C>=0?a=c?a.substr(C+1):a.substr(0,C):c&&(a=""),a=a.trim()}else if(d>=100){d-=100;var F=parseInt(d/100),S=parseInt(d%100);0==F&&0==S||(F<a.length?(a=a.substr(F,S),this.m_FieldFormat.m_VType==CValueType.valueSectional&&0==F&&(a=this.m_FieldFormat.FormatValue(a,i))):a=""),a=(a=a.trim()).split(" ").join("")}else if(m.m_FieldFormat.m_VType==CValueType.valueSectional){var b=m.m_FieldFormat.GetSpec().m_lPartitionings[0],R=!1;d>=10&&(R=!0,d-=10);for(var T=0,N=(F=0,0);N<b.length;N++){var y=b[N];if(0==y.m_eType){if(T==d){var I=R?a.length-F:y.m_nSize;a=F<a.length?a.substr(F,I):"";break}T++,F+=y.m_nSize}}a=a.trim()}}else m.m_FieldFormat.m_VType==CValueType.valueSelect&&(a=RfStringIdToLocalized("lang-ignored",_,a,null)),m.m_FieldFormat.m_VType==CValueType.valueSectional&&(a=m.m_FieldFormat.FormatValue(a,i))}n+=a}this.SetComputedFieldValue(t,n,!1),logStringMessage("after FOR. m_sComputedValue="+n),this.m_bComputing=!1}catch(e){logStringMessage("ERROR in CIdentityField::ComputeValue "+e.message,!1)}},CIdentityField.prototype.GetValue=function(e,t,i){try{var n=null;if(i&&(n=i.info),this.m_FieldFormat.GetComputable()){var r=this.m_mFieldValues[t.toString()];r&&r.m_bComputed||this.ComputeValue(e,t,n)}var s="",a=t||DEF_INSTANCE,o=this.m_mFieldValues[a.toString()];return null!=o&&(s=o.m_sValue),s}catch(e){return logStringMessage("ERROR in CIdentityField::GetValue "+e.message,!1),""}},CIdentityField.prototype.GetCurrentInstanceName=function(e){try{if(this.m_FieldFormat.GetIsCustom())return"";var t={sInstanceName:""};return e.GetCurrentInstanceName(this.m_sGroupName,t)!=EnRetCode.enRetCode_Succeeded?"":t.sInstanceName}catch(e){return logStringMessage("ERROR in CIdentityField::GetCurrentInstanceName "+e.message,!1),""}},CIdentityField.prototype.GetFieldFormat=function(){return this.m_FieldFormat},CIdentityField.prototype.GetGroupName=function(){return this.m_sGroupName},CIdentityField.prototype.Clear=function(){try{this.m_FieldFormat.Clear(),this.m_mFieldValues={},this.m_sGroupName="",this.m_bComputing=!1,this.m_nFieldIndex=0}catch(e){logStringMessage("ERROR in CIdentityField::Load "+e.message,!1)}},CIdentityField.prototype.GetPresentValueFromScript=function(e){try{for(var t="";0<e.length;){if(-1==e.indexOf("%",0))if(-1==e.indexOf("$",0))if(-1==e.indexOf("\\",0)){t+=e.substr(0);break}t=e;break}return t}catch(e){return logStringMessage("ERROR in CIdentityField::GetPresentValueFromScript "+e.message,!1),""}},CIdentityField.prototype.GetSelectedOption=function(e){var t=e||DEF_INSTANCE,i=this.m_mFieldValues[t];return i?i.m_pSelectedOption:null},CIdentityField.prototype.SetFieldValue=function(e,t,i){try{if(this.m_FieldFormat.GetComputable())return;var n=t;i&&(n=this.GetPresentValueFromScript(n)),t=t.trimLeft(),this.SetComputedFieldValue(e,n,""==n)}catch(e){logStringMessage("ERROR in CIdentityField::SetFieldValue "+e.message,!1)}},CIdentityField.prototype.SetComputedFieldValue=function(e,t,i){try{var n=e||DEF_INSTANCE,r=this.m_mFieldValues[n];r||(r=new CFieldValue,this.m_mFieldValues[n.toString()]=r);this.m_mFieldValues[n.toString()];if(r.m_sValue=t,r.m_bComputed=!0,r.m_bEmpty=i,this.m_FieldFormat.m_VType==CValueType.valueSelect){r.m_pSelectedOption=null;for(var s=0;s<this.m_FieldFormat.m_lOptions.length;s++){var a=this.m_FieldFormat.m_lOptions[s];if(a.m_sMainValue.toLowerCase()==t.toLowerCase()){r.m_pSelectedOption=a;break}}}}catch(e){logStringMessage("ERROR in CIdentityField::SetComputedFieldValue "+e.message,!1)}},CIdentityFieldSet.prototype.logFieldSetFields=function(e,t){for(var i=e.codePages,n="",r=0;r<i.length;r++){var s=IsBitCombMatch(i[r].m_BitComb,t);n+="\n"+i[r],s&&(n+=" === MATCH ===")}logStringMessage("*identities.js*  FIELDS CODEPAGES from intellect="+n);var a=e.fieldSet;for(r=0;r<a.length;r++)"App Upload"==a[r].m_sGroupName&&"\n"+a[r];var o=e.standardGroups,l="";for(r=0;r<o.length;r++)l+="\n"+o[r];logStringMessage("*identities.js*  StandartGroups from intellect="+l);var m=e.summaryGroup;logStringMessage("*identities.js*  SUMMARY GROUP from intellect=\n"+m);var _=e.customGroup;logStringMessage("*identities.js*  CUSTOM GROUP from intellect=\n"+_)},CIdentityFieldSet.prototype.ClearCustomFields=function(){this.m_aCustomFields.length=0},CIdentityFieldSet.prototype.AddCustom=function(e,t,i,n){try{logStringMessage("*identities.js* CIdentityFieldSet.AddCustom  sName='"+e+"' sMatchStrings='"+t+"' sFieldValue:"+i);var r=new CIdentityField;r.FieldName=e;this.GetCustomGroup();return this.m_customGroup&&""!=this.m_customGroup.m_sName?(r.m_sGroupName="Custom",n&&r.m_FieldFormat.SetTypeMultiline(),r.m_FieldFormat.SetCustom(e,t),r.SetFieldValue("",i,!0)):(r.m_FieldFormat.SetCustom("",""),r.SetFieldValue("","",!0)),logStringMessage("*identities.js* CIdentityFieldSet.AddCustom  RESULT=\n"+r),this.m_aCustomFields.push(r)}catch(e){logStringMessage("####-Error-#### in CIdentityFieldSet::AddCustom : "+e.message,!1)}},CIdentityFieldSet.prototype.GetCustomGroup=function(){return logStringMessage("*identities.js* CIdentityFieldSet.GetCustomGroup  this.m_customGroup="+this.m_customGroup+"\nFIELD_SET:"+this),this.m_customGroup},CIdentityFieldSet.prototype.GetCustomValuesCount=function(){return this.m_aCustomFields.length},CIdentityFieldSet.prototype.GetCustomField=function(e){return this.m_aCustomFields[e]},CIdentityFieldSet.prototype.toString=function(){return"[CIdentityFieldSet] OBJECT. ID:"+this.m_nIndex},CIdentityFieldSet.prototype.getCountry=function(){return this.m_mOptionValues["World Regions"]},CIdentityFieldSet.prototype.setCountry=function(e){this.m_mOptionValues["World Regions"]=e},CIdentityFieldSet.prototype.LookupOptionValue=function(e){return this.m_mOptionValues[e]||""},CIdentityFieldSet.prototype.GetRequiredBits=function(){for(var e=new TBitComb,t=0,i=120,n=getStaticOptions(),r=0;r<n.length;r++){var s=n[r],a=this.LookupOptionValue(s.m_sName);if(logStringMessage("CIdentityFieldSet.GetRequiredBits   sOptionValue:"+a+" FOR OPTION:"+s),s.m_Type==optionYesNo)a&&(e.SetBit(i),logStringMessage("CIdentityFieldSet.GetRequiredBits  change TBitComb:"+e+"\ncurBitYesNo="+i)),i++;else for(var o=0;o<s.m_lsVariants.length;o++)s.m_lsVariants[o].m_sInternalName==a&&(e.SetBit(t),logStringMessage("CIdentityFieldSet.GetRequiredBits  change TBitComb:"+e+"\ncurBitSel="+t)),t++}return e.TestMask(BITCOM_SELECTION_MASK)||(e.SetBit(0),logStringMessage("!!! Reading an identity without world region option, set it to default.")),e},CIdentityFieldSet.prototype.Clear=function(){try{this.m_mStandardFields=[],this.m_aCustomFields.length=0,this.m_lStandardGroups=[],this.m_mGroupInstances={},this.m_lUnlistedValues=[],this.m_nAddIndex=0,this.m_SummaryGroup.Clear(),this.m_CustomGroup.Clear()}catch(e){logStringMessage("ERROR in CIdentityFieldSet::Clear "+e.message,!0)}},CIdentityFieldSet.prototype.AddStandardFieldValue=function(e,t,i,n){try{var r=n||"",s=i||"",a=t;"Birth Day"==e&&1==a.length&&a[0]>="0"&&a[0]<="9"&&(a="0"+a);var o=this.LookupStandard(e);if(!o)return;var l=o.m_FieldFormat.IsInfoField(e),m=o.m_FieldFormat.GetComputable();if(l||m)return;if(""==r)r=o.m_sGroupName;else if(r!=o.m_sGroupName)return;var _=this.m_mGroupInstances[o.m_sGroupName.toString()];if(!_)return void logStringMessage("AddStandardFieldValue: can not find instances for group "+o.m_sGroupName);o.SetFieldValue(s,a,!0),_.m_mInstances[s]||(logStringMessage("######### AddStandardFieldValue.   instance is not in group yet add instance as non-default: "+s),_.m_mInstances[s]=!0)}catch(e){logStringMessage("ERROR in CIdentityFieldSet::AddStandardFieldValue "+e.message,!0)}},CIdentityFieldSet.prototype.AddInstanceForGroup=function(e,t){var i=this.m_mGroupInstances[e];i?i.m_mInstances[t]||(logStringMessage("CIdentityFieldSet.AddInstanceForGroup   instance is not in group yet add instance as non-default: "+t),i.m_mInstances[t]=!0):logStringMessage("CIdentityFieldSet.AddInstanceForGroup: can not find instances for group='"+e+"'")},CIdentityFieldSet.prototype.GetInstancesForGroup=function(e){try{return e in this.m_mGroupInstances?this.m_mGroupInstances[e].getInstances():[]}catch(e){logStringMessage("ERROR in CIdentityFieldSet::GetDefaultInstanceName "+e.message,!0)}},CIdentityFieldSet.prototype.SetDefaultInstanceName=function(e,t){try{e in this.m_mGroupInstances&&(logStringMessage("CIdentityFieldSet.SetDefaultInstanceName. GROUP:"+e+" INSTANCE:"+t+" ID: "+this.m_nIndex),this.m_mGroupInstances[e].SetDefaultInstanceName(t))}catch(e){logStringMessage("ERROR in CIdentityFieldSet::SetDefaultInstanceName "+e.message,!0)}},CIdentityFieldSet.prototype.GetCurrentInstanceName=function(e,t){try{var i=this.m_mGroupInstances[e.toString()];return null==i||null==i?EnRetCode.enRetCode_WrongGroup:(t.sInstanceName=i.GetCurrentInstanceName(),EnRetCode.enRetCode_Succeeded)}catch(e){return logStringMessage("ERROR in CIdentityFieldSet::GetCurrentInstanceName "+e.message,!0),0}},CIdentityFieldSet.prototype.LookupStandard=function(e){return e in this.m_mStandardFields?this.m_mStandardFields[e]:null};var COptionPhonePrefixMode={PHONEPREFIX_UNDEFINED:-1,PHONEPREFIX_NONE:0,PHONEPREFIX_NATIONALPREFIX:1,PHONEPREFIX_COUNTRYCODE:2},IDEFTITYOPTION_PHONEPREFIX="Phone prefix mode";function CIdentity(e){this.m_FieldSet=e?new CIdentityFieldSet(e):null,this.m_nIndex=Math.floor(10001*Math.random()),this.m_sxmlData=""}function CTitleStringData(e){if(this.m_sWhole="",this.m_sNormalized="",this.m_sInsideBrackets="",this.m_bBracketsStructureIsCorrect=!0,this.m_bBracketsEncountered=!1,this.m_nWordsCount=0,1==arguments.length)try{this.m_bBracketsStructureIsCorrect=!0,this.m_bBracketsEncountered=!1,this.m_nWordsCount=0;var t=e?e.length:0,i=0;for(i=0;i<t&&IsCharSpaceRF(e.charCodeAt(i));++i);if(i>=t)return;for(var n=!1,r=0,s=!0,a=0;i<t;){var o="";switch(0!=a?(o=a,a=0):o=e.charAt(i++).toLowerCase().charCodeAt(0),o>65118&&(o=CharNormalWidth(o)),o){case 226:case 228:case 227:case 225:case 229:case 224:case 261:o=97;break;case 233:case 232:case 234:case 281:case 283:o=101;break;case 237:case 239:case 304:case 305:o=105;break;case 243:case 244:case 248:case 333:case 246:o=111;break;case 241:case 324:o=110;break;case 250:case 252:case 367:o=117;break;case 231:case 263:case 269:o=99;break;case 322:o=108;break;case 223:o=115,a=115;break;case 253:o=121;break;case 287:o=103;break;case 345:o=114;break;case 347:case 351:case 353:o=115;break;case 378:case 380:case 382:o=122;break;case 39:if(i<t&&"s"==e.charAt(i).toLowerCase()){i++;continue}o=32}var l=String.fromCharCode(o);if(RfIsCharAlphaNum(l)){(n||s)&&this.m_nWordsCount++,s&&(s=!1);var m=r>0?this.m_sInsideBrackets:this.m_sNormalized;n&&(""!=m&&(m+=" "),this.m_sWhole+=" ",n=!1),this.m_sWhole+=l,m+=l,r>0?this.m_sInsideBrackets=m:this.m_sNormalized=m}else switch(n=!0,l){case"(":case"[":""!=this.m_sWhole&&(this.m_sWhole+=" "),this.m_sWhole+="(",r++,this.m_bBracketsEncountered=!0;break;case")":case"]":""!=this.m_sWhole&&(this.m_sWhole+=" "),this.m_sWhole+=")",--r<0&&(this.m_bBracketsStructureIsCorrect=!1),this.m_bBracketsEncountered=!0}}n&&(this.m_sWhole+=" "),0!=r&&(this.m_bBracketsStructureIsCorrect=!1)}catch(e){logStringMessage("ERROR in CTitleStringData ctor"+e)}}function RfIsElemVisible(e,t,i){try{if(!e)return logStringMessage("RfIsElemVisible. pElem=NULL -> return false"),!1;var n=null;if("undefined"!=typeof window?n=window:void 0!==e.ownerDocument&&e.ownerDocument&&(n=e.ownerDocument.defaultView),!n)return logStringMessage("RfIsElemVisible. local_window=NULL -> return false"),!1;var r=e.tagName;if(!r||""==r||"undefined"==r)return logStringMessage("RfIsElemVisible. TAG=NULL -> return false"),!1;if(t.sTagName=r.toLowerCase(),t.sId=e.getAttribute("id"),t.sId&&"undefined"!=t.sId||(t.sId=""),"button"==t.sTagName){(o=e.getAttribute("name"))&&""!=o||(o=RFNAME_NONAME),t.sName=o.toLowerCase();var s=e.getAttribute("type")||"";if(t.sType=s.toLowerCase(),"hidden"==t.sType)return logStringMessage("RfIsElemVisible. sType==--hidden--   TAG=BUTTON"),!1}else if("input"==t.sTagName){(o=e.getAttribute("name"))&&""!=o||(o=RFNAME_NONAME),t.sName=o.toLowerCase();s=e.getAttribute("type")||"";if(t.sType=s.toLowerCase(),"hidden"==t.sType)return logStringMessage("RfIsElemVisible. TAG="+t.sTagName+" NAME="+t.sName+"  type=-hidden--  SKIP"),!1;if(e.disabled)return logStringMessage("RfIsElemVisible. TAG="+t.sTagName+" type=-disabled--  SKIP"),!1;switch(t.sType){case"text":case"password":if(e.readOnly)return logStringMessage("RfIsElemVisible. readonly INPUT->  SKIP"),!1;break;case"radio":case"checkbox":case"submit":case"button":case"reset":case"image":case"file":case"color":break;case"number":case"email":case"name":case"username":case"textbox":case"nickname":case"tel":case"search":if(e.readOnly)return logStringMessage("RfIsElemVisible. readonly INPUT->  SKIP"),!1;t.sType="text";break;case"":if(e.readOnly)return logStringMessage("RfIsElemVisible. readonly INPUT->  SKIP"),!1;if(RfIsEventSetForElement(e,"click")){var a=e.ownerDocument;if(a&&-1!=a.URL.indexOf("hospicepharmacia.com")&&RfIsActionButtonCaption(e.id)>0){t.sType="button",logStringMessage("RfIsElemVisible. EXCEPTION: Input with empty type. Set as button and accept it!");break}}logStringMessage("RfIsElemVisible. Input with empty type. Set as text and accept it!"),t.sType="text";break;default:if(e.readOnly)return logStringMessage("RfIsElemVisible. readonly INPUT->  SKIP"),!1;logStringMessage("RfIsElemVisible. Unknown input type "+t.sType+". Set as text  and accept it!"),t.sType="text"}}else if("textarea"==t.sTagName){if(e.disabled)return logStringMessage("RfIsElemVisible. Disabled TEXTAREA-> return  SKIP"),!1;if(e.readOnly)return logStringMessage("RfIsElemVisible. Readonly TEXTAREA -> return SKIP"),!1;(o=e.getAttribute("name"))&&""!=o||(o=RFNAME_NONAME),t.sName=o.toLowerCase(),logStringMessage("RfIsElemVisible. Found*** TEXTAREA with NAME='"+t.sName+"' ID='"+t.sId+"' Accept it!")}else if("select"==t.sTagName){if(e.disabled)return logStringMessage("RfIsElemVisible. Disabled select-> return  FALSE"),!1;var o;(o=e.getAttribute("name"))&&""!=o||(o=RFNAME_NONAME),t.sName=o.toLowerCase(),logStringMessage("RfIsElemVisible. Found*** SELECT with NAME='"+t.sName+"' ID='"+t.sId+"' Accept it!")}else if("body"==t.sTagName)return logStringMessage("RfIsElemVisible. BODY!!!"),!0;var l={bCountFields:i,pElem:e,bInvisibleButCanChange:t.bInvisibleButCanChange,local_window:n};return RfIsElemVisibleInStyleSheets(l)?(t.bInvisibleButCanChange=l.bInvisibleButCanChange,!0):(t.bInvisibleButCanChange=l.bInvisibleButCanChange,!1)}catch(e){return logStringMessage("RfIsElemVisible: "+e),!1}}function RfIsElemVisibleInStyleSheets(e){var t=e.pElem;if(e.bCountFields)return!!t.offsetWidth||(e.bInvisibleButCanChange=!0,!1);var i=e.local_window.getComputedStyle(t),n=i.getPropertyValue("visibility").toLowerCase(),r=t.tagName.toLowerCase();if("visible"!==n)return"input"==r&&"submit"==t.type.toLowerCase()||"a"==r&&t.form&&RfIsActionButtonCaption(t.textContent)>0||(e.bInvisibleButCanChange=!0),!1;var s=i.getPropertyValue("display");if("none"===s&&"input"===r){var a=t.parentElement;if(a&&"label"===a.tagName.toLowerCase())return e.pElem=a,e.pRealVisibleElement=a,RfIsElemVisibleInStyleSheets(e);var o=t.nextElementSibling;if(t.id&&o&&"label"===o.tagName.toLowerCase()&&o.htmlFor===t.id)return e.pElem=o,e.pRealVisibleElement=o,RfIsElemVisibleInStyleSheets(e)}for(var l=i.getPropertyValue("position"),m=!0;t;){if("none"===s)return e.bInvisibleButCanChange=!0,!1;if(t=t.parentElement){if(i=e.local_window.getComputedStyle(t),m&&("relative"===l||"static"===l)&&"hidden"===i.getPropertyValue("overflow")&&0===t.getBoundingClientRect().height)return e.bInvisibleButCanChange=!0,!1;s=i.getPropertyValue("display"),m=!1}}return!0}function RfCountCaption(e,t,i,n,r){try{if(logStringMessage("RfCountCaption: caption="+e+" type="+t+" bAuxiliary="+i+" caption_type="+n+" lCaptionList="+r),t!=RfFieldType.RfFieldRadio&&t!=RfFieldType.RfFieldCheckbox&&""!=e.m_sCaption){var s=e.m_sCaption;if(-1!=r.indexOf(e.m_nElement))return void logStringMessage("RfCountCaption1: FOUND "+e.m_nElement);var a=s.length;a>=2&&"("==s[0]&&")"==s[a-1]?i||s.length>=2&&"("==s[0]&&")"==s[a-1]&&(s=(s=s.substr(1,a-2)).trim(),e.m_sCaption=s,r.push(e.m_nElement),logStringMessage("RfCountCaption1: add to "+n+" : "+e.m_nElement)):(logStringMessage("RfCountCaption2: add to "+n+" : "+e.m_nElement),r.push(e.m_nElement))}}catch(e){logStringMessage("ERROR in RfCountCaption: "+e)}}function RfMaxIntersect(e,t){e=(e=e.toLowerCase()).split(" ").join(""),t=(t=t.toLowerCase()).split(" ").join("");var i=Math.max(e.length,t.length);logStringMessage(">>>RfMaxIntersect: s1='"+e+"' s2='"+t+"'");for(var n=3;n<=i;n++){for(var r=!1,s=0;s<e.length-n+1;s++){for(var a=0;a<t.length-n+1&&(e.substr(s,n)==t.substr(a,n)&&(logStringMessage("  found nMatchLen="+n+" i1="+s+" i2="+a),r=!0),!r);a++);if(r)break}if(!r)return 3==n?0:n-1;if(n==i)return n}return 0}function RfMakeCaptionUsed(e,t){try{return""!=e.m_sCaption&&(-1==t.indexOf(e.m_nElement)?(logStringMessage("Add object in RfUseCaption: "+e.m_nElement),t.push(e.m_nElement),!0):(logStringMessage("  RfUseCaption: "+e.m_nElement+" already used"),e.m_sCaption="",e.m_nElement=null,e.m_nNodeSI=-1,e.m_Position=null,!1))}catch(e){return logStringMessage("ERROR in RfMakeCaptionUsed: "+e),!1}}function RfLastWord(e){var t=e.sentence,i=t.length;for(i--;i>=0&&IsCharSpaceRF(t.charCodeAt(i));i--);for(var n="";i>=0&&!IsCharSpaceRF(t.charCodeAt(i));i--)n=t[i]+n;for(i--;i>=0&&IsCharSpaceRF(t.charCodeAt(i));i--);return t=t.substr(0,i+1),e.sentence=t,n}function RfCoverPosns(e,t,i){RfNormalizePosns1(e,t);var n=Math.min(e.m_x,t.m_x),r=Math.min(e.m_y,t.m_y),s=Math.max(e.m_x+e.m_width,t.m_x+t.m_width),a=Math.max(e.m_y+e.m_height,t.m_y+t.m_height);i.m_x=n,i.m_y=r,i.m_width=s-n,i.m_height=a-r}function RfNormalizePosns1(e,t){try{if(logStringMessage("  >RfNormalizePosns: L="+e+"   R="+t),e.m_pOffsetParent==t.m_pOffsetParent)logStringMessage("  <RfNormalizePosns1: parent eq\n");else if(e.m_pOffsetParent&&t.m_pOffsetParent&&4&e.m_pOffsetParent.compareDocumentPosition(t.m_pOffsetParent)){for(;t.m_pOffsetParent&&e.m_pOffsetParent&&2&t.m_pOffsetParent.compareDocumentPosition(e.m_pOffsetParent);){var i=new RfPosition;RfGetNodePosn(t.m_pOffsetParent,i),t.m_x+=i.m_x,t.m_y+=i.m_y,t.m_pOffsetParent=i.m_pOffsetParent,logStringMessage("  RfNormalizePosns: move R up to "+t)}for(;e.m_pOffsetParent&&t.m_pOffsetParent&&2&e.m_pOffsetParent.compareDocumentPosition(t.m_pOffsetParent);){var n=new RfPosition;RfGetNodePosn(e.m_pOffsetParent,n),e.m_x+=n.m_x,e.m_y+=n.m_y,e.m_pOffsetParent=n.m_pOffsetParent,logStringMessage("  RfNormalizePosns: move L up to "+e)}logStringMessage("  <RfNormalizePosns LR: L="+e+" R="+t)}else{for(;e.m_pOffsetParent&&t.m_pOffsetParent&&2&e.m_pOffsetParent.compareDocumentPosition(t.m_pOffsetParent);){n=new RfPosition;RfGetNodePosn(e.m_pOffsetParent,n),e.m_x+=n.m_x,e.m_y+=n.m_y,e.m_pOffsetParent=n.m_pOffsetParent,logStringMessage("  RfNormalizePosns: move R up to "+e)}for(;t.m_pOffsetParent&&e.m_pOffsetParent&&2&t.m_pOffsetParent.compareDocumentPosition(e.m_pOffsetParent);){i=new RfPosition;RfGetNodePosn(t.m_pOffsetParent,i),t.m_x+=i.m_x,t.m_y+=i.m_y,t.m_pOffsetParent=i.m_pOffsetParent,logStringMessage("  RfNormalizePosns: move L up to "+t)}logStringMessage("  <RfNormalizePosns RL: R=["+t+"] L=["+e+"]")}}catch(i){logStringMessage("RfNormalizePosns1("+e+", "+t+" ) : "+i.message)}return!0}function RfIsOnNextLine(e,t){var i=e.m_height>=0?e.m_height:RF_DEFAULT_HEIGHT,n=t.m_height>=0?t.m_height:RF_DEFAULT_HEIGHT;return Math.abs(e.m_y+i-t.m_y)<RF_VERT_LINE_DIST||Math.abs(t.m_y+n-e.m_y)<RF_VERT_LINE_DIST}function RfIsOnSameLine(e,t,i){var n=e.m_height>0?e.m_height:RF_DEFAULT_HEIGHT,r=t.m_height>0?t.m_height:RF_DEFAULT_HEIGHT;return logStringMessage("+++ RfIsOnSameLine  h1="+n+" h2="+r+" posn1.m_y="+e.m_y+" posn2.m_y="+t.m_y),e.m_y<t.m_y?t.m_y<e.m_y+n:e.m_y<t.m_y+r+i}function CharNormalWidth(e){return 65131==e?64:65119==e?35:65120==e?38:9572==e?12306:e>=65281&&e<=65374?e-65248:e}function RfReadNumber(e,t){try{var i="";t.nLength=0;for(var n=!1,r=e,s=0;;){if(++s>20)break;var a=r.charAt(t.nLength);if(!a)break;var o=a.charCodeAt(0);if(a>="0"&&a<="9")n=!0;else{if("."!=a&&","!=a){if("$"==a||o==ASCII_POUND_STERLING_CHAR||o==ASCII_YEN_SIGN_CHAR||o==ASCII_CENT_SIGN_CHAR){t.nLength++;continue}break}if(!n){i=i.splice(0,i.length-1),t.nLength--;break}n=!1}i+=a,t.nLength++}for(var l="",m=!1,_=!1,d=0;d<i.length;d++)if("."==i[d]){if(!((i=i.substr(d+1)).indexOf(".")>=0||i.indexOf(",")>=0)){m||!_&&d==i.length-3||(l+=i.substr(d+1));break}if(m)return!1;_=!0}else if(","==i[d]){if(!((i=i.substr(d+1)).indexOf(".")>=0||i.indexOf(",")>=0)){_||!m&&d==i.length-3||(l+=i.substr(d+1));break}if(_)return!1;m=!0}else{if(r[t.nLength]&&("$"==r[t.nLength]||r.charCodeAt(t.nLength)==ASCII_POUND_STERLING_CHAR||r.charCodeAt(t.nLength)==ASCII_YEN_SIGN_CHAR||r.charCodeAt(t.nLength)==ASCII_CENT_SIGN_CHAR)){t.nLength++;continue}l+=i[d]}return""!=l&&(t.nResult=parseInt(l,10),"k"!=r[t.nLength]&&"K"!=r[t.nLength]||(t.nLength++,t.nResult*=1e3),!0)}catch(e){return logStringMessage("ERROR in RfReadNumber"+e),!1}}function RfDeleteSpaces(e){return e=rf_TrimString(e)}function RfNormalizePosns(e,t){return!0}function RfIsCharHieroglyph(e){var t=e.charCodeAt(0);return t>=12288&&t<57344}function RfIsStringHieroglyph(e){if("string"==typeof e){var t=e.length;if(0==t)return!1;if(1==t){var i=e.charCodeAt(0);return i>=12288&&i<57344}var n=e.charCodeAt(0),r=e.charCodeAt(t-1);if(n>=12288&&n<57344||r>=12288&&r<57344)return!0;for(var s=1;s<t-1;s++){var a=e.charCodeAt(s);if(a>=12288&&a<57344)return!0}return!1}return e.some(RfIsCharHieroglyph)}function RfIsGenericCaption(e){return"aa"==e||"ay"==e||"dag"==e||"day"==e||"dd"==e||"dia"==e||"dzien"==e||"giorno"==e||"jahr"==e||"jour"==e||"maand"==e||"mes"==e||"mese"==e||"miesiac"==e||"month"==e||"monat"==e||"mm"==e||"mes"==e||"mois"==e||"year"==e||"yy"==e||"line 1"==e||"line 2"==e}function RfShowCaption(e,t){}function RfCheckCaption(e,t,i,n,r,s,a){try{e.m_sCaption=r?e.m_sCaption+" "+n:n+" "+e.m_sCaption,e.m_Position=t,e.m_nNodeSI=i,e.m_nElement=a;var o=new CTitleStringData(e.m_sCaption);if(logStringMessage(s+" caption inc: '"+n+"' -> '"+e.m_sCaption+"'"),r){if(""!=o.GetWhole())return logStringMessage("RfCheckCaption  complete right/lower caption: break"),!1}else{var l=o.GetNormalized();if(!l)return!1;if(RfIsGenericCaption(l=rf_TrimString(l=l.toLowerCase())))return!0;if(""!=l)return logStringMessage("  complete left/upper caption: can break"),!1}return logStringMessage("  incomplete caption: we can continue"),!0}catch(e){return logStringMessage("ERROR in RfCheckCaption: "+e),!1}}function RfIsCaptionInside(e,t){return e.m_width>0&&t.m_width>0&&e.m_height>0&&t.m_height>0&&e.m_x>=t.m_x&&e.m_y>=t.m_y&&e.m_x+e.m_width<=t.m_x+t.m_width&&e.m_y+e.m_height<=t.m_y+t.m_height}function RfIsOnSameVert(e,t){var i=e.m_width>=0?e.m_width:RF_DEFAULT_WIDTH,n=t.m_width>=0?t.m_width:RF_DEFAULT_WIDTH,r=Math.max(e.m_x,t.m_x),s=Math.min(e.m_x+i,t.m_x+n);return logStringMessage("+++ RfIsOnSameVert xc1="+r+" xc2="+s+" w1="+i+" w2="+n+" posn1.m_x="+e.m_x+" posn2.m_x="+t.m_x),i<30?2.3*(s-r)>=Math.min(i,n):2*(s-r)>=Math.min(i,n)}function GetTextNodePosition(e,t){return!1}function rf_TrimString(e){return e?e=e.split(" ").join(""):""}function RfNormalizeSelectValue(e,t,i,n){try{var r=new CTitleStringData(e=e.trim());n&&RfIsStringHieroglyph(e)&&r.DeleteAllSpaces(),t&&(t[t.length]=r),i&&(i[i.length]=r.m_sWhole)}catch(e){logStringMessage("RfNormalizeSelectValue error: "+e)}}CIdentity.prototype.GetNumberOfCustomValues=function(){return this.getFields().GetCustomValuesCount()},CIdentity.prototype.getCountry=function(){return this.getFields().getCountry()},CIdentity.prototype.setCountry=function(e){this.getFields().setCountry(e)},CIdentity.prototype.setFields=function(e){this.m_FieldSet=e},CIdentity.prototype.getFields=function(){return this.m_FieldSet},CIdentity.prototype.toString=function(){return"<-### [CIdentity] OBJECT.  ID:"+this.m_nIndex+" COUNTRY: "+this.getCountry()+" FIELDSET: "+this.m_FieldSet+"  ###->"},CIdentity.prototype.AddInstanceForGroup=function(e,t){this.getFields().AddInstanceForGroup(e,t)},CIdentity.prototype.AddStandardFieldValue=function(e,t,i,n){this.getFields().AddStandardFieldValue(e,t,i,n)},CIdentity.prototype.AddCustomFieldValue=function(e,t,i,n){this.getFields().AddCustom(e,t,i,n)},CIdentity.prototype.GetPhonePrefixMode=function(){var e=this.LookupOptionValue(IDEFTITYOPTION_PHONEPREFIX);return-1==e?COptionPhonePrefixMode.PHONEPREFIX_NONE:"0"==e?COptionPhonePrefixMode.PHONEPREFIX_NONE:"1"==e?COptionPhonePrefixMode.PHONEPREFIX_NATIONALPREFIX:"2"==e?COptionPhonePrefixMode.PHONEPREFIX_COUNTRYCODE:COptionPhonePrefixMode.PHONEPREFIX_NONE},CIdentity.prototype.SetOptionValue=function(e,t){this.m_FieldSet.m_mOptionValues[e]=t},CIdentity.prototype.LookupOptionValue=function(e){return void 0===this.m_FieldSet.m_mOptionValues[e]?-1:this.m_FieldSet.m_mOptionValues[e]},CIdentity.prototype.SetPhonePrefixMode=function(e){var t=this.GetPhonePrefixMode();if(e!=t){var i="";switch(e){case COptionPhonePrefixMode.PHONEPREFIX_NONE:i="0";break;case COptionPhonePrefixMode.PHONEPREFIX_NATIONALPREFIX:i="1";break;case COptionPhonePrefixMode.PHONEPREFIX_COUNTRYCODE:i="2"}this.SetOptionValue(IDEFTITYOPTION_PHONEPREFIX,i)}return t},CIdentity.prototype.GetPhonePrefixCurrent=function(){return this.GetPhonePrefixSpecified(this.GetPhonePrefixMode())},CIdentity.prototype.GetPhonePrefixSpecified=function(e){var t="",i="";switch(e){case COptionPhonePrefixMode.PHONEPREFIX_NATIONALPREFIX:i="National Prefix Present";break;case COptionPhonePrefixMode.PHONEPREFIX_COUNTRYCODE:i="Country Code Present";break;default:return t}var n=this.getFields().LookupStandard(i);return n?t=n.GetValue(this.m_FieldSet,n.GetCurrentInstanceName(this.m_FieldSet)):t},CIdentity.prototype.assign=function(e){return this.m_FieldSet=e.m_FieldSet,this.m_sxmlData=e.m_sxmlData,this},CIdentity.prototype.clone=function(){return(new CIdentity).assign(this)},CIdentity.prototype.equals=function(){return!1},CIdentity.prototype.Filling7=function(e,t,i,n,r,s,a){var o=!1,l=new CStringMatch,m=new CStringMatch;if(t)for(var _=this.getFields().GetCustomValuesCount(),d=0;d<_;d++){var u=this.getFields().GetCustomField(d),f=u.GetFieldFormat().GetMainMatchString();""!=f.GetStringData().GetWhole()&&(m.setParameters(4,null,null,u,null,i,n,e,a),m.isBetter(l)&&(s.sFieldName=f.GetStringRepresentation(),l.Clone(m),s.pResult=u,o=!0))}else for(var p=this.getFields(),h=p.m_lAllRules,g=h.length,c=0;c<g;c++)for(var C=h[c],F=!1,S=C.m_lRules,b=S.length,R=C.m_sFieldName,T=p.LookupStandard(R),N=0;N<b;){if(0!=N||F)m.setParameters(4,null,null,null,S[N],i,n,e,a),N++;else{if(F=!0,!C.m_bValueMatch||n||!T)continue;m.setParameters(3,r,this,T,null,null,!1,!1,a)}if(m.m_bValid){if(T&&!this.Correspond(T,R,r)){logStringMessage("  --BetterMatch killed by Correspond\n");continue}m.m_pField=T,m.isBetter(l)?(l.Clone(m),o=!0,s.sFieldName=R,s.pResult=T,logStringMessage("    $$BetterRule: field_name="+R+" rule="+R)):logStringMessage("    ..NotBetter\n")}}return o},CIdentity.prototype.Correspond=function(e,t,i){var n=e.GetFieldFormat(),r=n.GetType();switch(logStringMessage("    CIdentity::Correspond: type="+r+" sFieldName="+t),r){case CValueType.valueNormal:case CValueType.valueSelect:var s=i[0];if(!n.Satisfies(s,t))return!1;break;case CValueType.valueMultiline:for(var a=0;a<i.length;a++){s=i[a];if(!n.Satisfies(s,t))return!1}break;case CValueType.valueSectional:var o=n.GetBestPartitioning(i.length);if(!o){if(!n.Satisfies(i[0],t))return!1;break}for(var l=0;l<o.length;l++){s=i[l];var m=o[l];switch(m.m_eType){case 0:if(!n.Satisfies(s,t))return!1;if(s.GetType()==RfFieldType.RfFieldTextArea)return!1;break;case 1:var _=this.getFields().LookupStandard(m.m_sValueName);if(!_||!_.GetFieldFormat().Satisfies(s,t))return!1;if(s.GetType()==RfFieldType.RfFieldTextArea)return!1}}}return!0},CIdentity.prototype.FindCaptionMatching=function(e,t,i){var n=new CMatchStringData(e),r=RfIsStringHieroglyph(e);return this.Filling7(!1,!1,n,!1,t,i,r)},CIdentity.prototype.Filling=function(e,t,i){try{logStringMessage("+++ CIdentity.Filling: trying to find rule for name='"+e.GetName()+"'");var n=e.GetName(),r=new CMatchStringData(n),s=RfIsStringHieroglyph(n);if(this.Filling7(!0,!0,r,!0,t,i,s))return logStringMessage("+++ CIdentity.Filling: 1 STEP Filling7 returns = TRUE"),!0;logStringMessage("+++ CIdentity.Filling: 1 STEP Filling7 returns FALSE. CUSTOM=TRUE, NAME_ONLY=FALSE, sFieldName="+n);var a=e.GetTitle(),o=this.getFields().GetCustomValuesCount();if(logStringMessage("Filling: title to match='"+a+"'"),o>0){if(e.placeholder){var l=new CMatchStringData(e.placeholder),m=RfIsStringHieroglyph(e.placeholder);if(this.Filling7(!1,!0,l,!1,t,i,m))return!0}var _=new CMatchStringData(a),d=RfIsStringHieroglyph(a);if(this.Filling7(!1,!0,_,!1,t,i,d)||this.Filling7(!1,!0,r,!0,t,i,s))return logStringMessage("+++ CIdentity.Filling: CUSTOM_FIELDS STEP Filling7 returns = TRUE"),!0;logStringMessage("+++ CIdentity.Filling: CUSTOM_FIELDS STEP Filling7 returns = FALSE")}if(e.placeholder){var u=RfTranslateWords(e.placeholder),f=u.replace(new RegExp("[\\s+/]","g"),"").toLowerCase();if(a&&("mmyy"===f||"mmjj"===f||"kkvv"===f||"mmaa"===f)){var p=RfTranslateWords(a+" "+e.placeholder);if(this.FindCaptionMatching(p,t,i))return!0}if(this.FindCaptionMatching(u,t,i)){if(a&&("Year"===i.sFieldName||"YY"===i.sFieldName||"Month"===i.sFieldName||"Day"===i.sFieldName||"Generic Number"===i.sFieldName||"Generic PIN"===i.sFieldName||"Generic Branch"===i.sFieldName)){p=RfTranslateWords(a+" "+e.placeholder);if(this.FindCaptionMatching(p,t,i))return!0}return!0}}if((a=RfTranslateWords(a)).length>0&&176===a.charAt(a.length-1).charCodeAt(0)&&(a=(a=a.substring(0,a.length-1)).trimRight()),this.FindCaptionMatching(a,t,i))return!0;var h=n.lastIndexOf("/");h>=0&&(n=n.substr(h+1),logStringMessage("Filling: field are shortened to='"+n+"'")),(h=n.lastIndexOf("."))>=0&&(n=n.substr(h+1),logStringMessage("Filling: field are shortened to='"+n+"'"));var g=new CMatchStringData(n=RfTranslateWords(n));s=RfIsStringHieroglyph(n);var c=this.Filling7(!1,!1,g,!0,t,i,s);if(logStringMessage("+++ CIdentity.Filling: 4 STEP Filling7 returns = "+c),c)return!0;if(e.defaultValue){var C=RfTranslateWords(e.defaultValue);if(this.FindCaptionMatching(C,t,i))return!0}return logStringMessage("CIdentity.Filling: NOT FOUND rule for name='"+e.GetName()+"'"),!1}catch(e){return logStringMessage("ERROR in CIdentity::Filling "+e.message,!1),!1}},CIdentity.prototype.CustomHasNoConflicts=function(e){var t=[],i=0,n=new CFieldRule([e.m_sdString.GetWhole()],e.GetExactMatch()?CPrecision.precisionExact:CPrecision.precisionSubstring),r=!1,s=this.m_FieldSet.m_lAllRules;for(var a in s){var o=s[a];r=!1,sRuleFieldName=o.m_sFieldName;var l=this.m_FieldSet.LookupStandard(sRuleFieldName);if(l)if(l.GetValue(this.m_FieldSet,l.GetCurrentInstanceName(this.m_FieldSet)))for(var m in o.m_lRules){var _=o.m_lRules[m].GetSubstringsReduced();for(var d in _){var u=_[d],f=new CStringMatch;if(f.setParameters(4,null,null,null,n,u,!0,!1,!1),f.IsValid()){var p=o.m_sFieldName;if(t.push(p),r=!0,++i>=5)return t.push("..."),t}if(r)break}if(r)break}}return i>0?t:void 0},CTitleStringData.prototype.Clear=function(){this.m_sWhole="",this.m_sNormalized="",this.m_sInsideBrackets="",this.m_bBracketsStructureIsCorrect=!0,this.m_bBracketsEncountered=!1,this.m_nWordsCount=0},CTitleStringData.prototype.GetNormalized=function(){return this.m_sNormalized},CTitleStringData.prototype.GetInsideBrackets=function(){return this.m_sInsideBrackets},CTitleStringData.prototype.GetWhole=function(){return this.m_sWhole},CTitleStringData.prototype.GetWordsCount=function(){return this.m_nWordsCount},CTitleStringData.prototype.GetBracketsEncountered=function(){return this.m_bBracketsEncountered},CTitleStringData.prototype.GetBracketsStructureIsCorrect=function(){return this.m_bBracketsStructureIsCorrect},CTitleStringData.prototype.toString=function(){return"<<CTitleStringData>>  WHOLE='"+this.m_sWhole+"'  \nNormalized="+this.m_sNormalized+" InsideBrackets ="+this.m_sInsideBrackets+"\nWORDS="+this.m_nWordsCount+"  BracketsEncountered = "+this.m_bBracketsEncountered+"  BracketsStructureIsCorrect="+this.m_bBracketsStructureIsCorrect},CTitleStringData.prototype.DeleteAllSpaces=function(){this.m_sWhole=RfDeleteSpaces(this.m_sWhole),this.m_sNormalized=RfDeleteSpaces(this.m_sNormalized),this.m_sInsideBrackets=RfDeleteSpaces(this.m_sInsideBrackets)};var reDataAlpha=new RegExp("[\\u0030-\\u0039\\u0041-\\u005a\\u0061-\\u007a\\u00b0-\\u00b0\\u00b2-\\u00b3\\u00b9-\\u00ba\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u01f5\\u01fa-\\u0217\\u0250-\\u02a8\\u0386-\\u0386\\u0388-\\u038a\\u038c-\\u038c\\u038e-\\u03a1\\u03a3-\\u03ce\\u03d0-\\u03d6\\u03da-\\u03da\\u03dc-\\u03dc\\u03de-\\u03de\\u03e0-\\u03e0\\u03e2-\\u03f3\\u0401-\\u040c\\u040e-\\u044f\\u0451-\\u045c\\u045e-\\u0481\\u0490-\\u04c4\\u04c7-\\u04c8\\u04cb-\\u04cc\\u04d0-\\u04eb\\u04ee-\\u04f5\\u04f8-\\u04f9\\u0531-\\u0556\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0621-\\u063a\\u0641-\\u064a\\u0660-\\u0669\\u0671-\\u06b7\\u06ba-\\u06be\\u06c0-\\u06ce\\u06d0-\\u06d3\\u06d5-\\u06d5\\u06f0-\\u06f9\\u0905-\\u0939\\u0958-\\u0961\\u0966-\\u096f\\u0985-\\u098c\\u098f-\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2-\\u09b2\\u09b6-\\u09b9\\u09dc-\\u09dd\\u09df-\\u09e1\\u09e6-\\u09f1\\u0a05-\\u0a0a\\u0a0f-\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32-\\u0a33\\u0a35-\\u0a36\\u0a38-\\u0a39\\u0a59-\\u0a5c\\u0a5e-\\u0a5e\\u0a66-\\u0a6f\\u0a85-\\u0a8b\\u0a8d-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2-\\u0ab3\\u0ab5-\\u0ab9\\u0ae0-\\u0ae0\\u0ae6-\\u0aef\\u0b05-\\u0b0c\\u0b0f-\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32-\\u0b33\\u0b36-\\u0b39\\u0b5c-\\u0b5d\\u0b5f-\\u0b61\\u0b66-\\u0b6f\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99-\\u0b9a\\u0b9c-\\u0b9c\\u0b9e-\\u0b9f\\u0ba3-\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb5\\u0bb7-\\u0bb9\\u0be7-\\u0bf2\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c60-\\u0c61\\u0c66-\\u0c6f\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cde-\\u0cde\\u0ce0-\\u0ce1\\u0ce6-\\u0cef\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d28\\u0d2a-\\u0d39\\u0d60-\\u0d61\\u0d66-\\u0d6f\\u0e01-\\u0e4e\\u0e50-\\u0e59\\u0e81-\\u0e82\\u0e84-\\u0e84\\u0e87-\\u0e88\\u0e8a-\\u0e8a\\u0e8d-\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5-\\u0ea5\\u0ea7-\\u0ea7\\u0eaa-\\u0eab\\u0ead-\\u0eae\\u0ed0-\\u0ed9\\u0edc-\\u0edd\\u0f20-\\u0f33\\u0f40-\\u0f47\\u0f49-\\u0f69\\u0f90-\\u0f95\\u0f97-\\u0f97\\u0f99-\\u0fad\\u0fb1-\\u0fb7\\u0fb9-\\u0fb9\\u10a0-\\u10c5\\u10d0-\\u10f6\\u1100-\\u1159\\u115f-\\u11a2\\u11a8-\\u11f9\\u1e00-\\u1e9b\\u1ea0-\\u1ef9\\u1f00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59-\\u1f59\\u1f5b-\\u1f5b\\u1f5d-\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2070-\\u2070\\u2074-\\u2079\\u2080-\\u2089\\u249c-\\u24e9\\u2564-\\u2564\\u3005-\\u3005\\u3012-\\u3012\\u3041-\\u3094\\u309b-\\u309e\\u30a1-\\u30fa\\u30fc-\\u30fe\\u3105-\\u312c\\u3131-\\u318e\\u4e00-\\u9fa5\\uac00-\\ud7a3\\uf900-\\ufa2d\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1f-\\ufb36\\ufb38-\\ufb3c\\ufb3e-\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe6b-\\ufe6b\\ufe80-\\ufefc\\uff10-\\uff19\\uff20-\\uff3a\\uff41-\\uff5a\\uff66-\\uff9f\\uffa1-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc\\ufffd]");function RfIsCharAlphaNum(e){return reDataAlpha.test(e)||""==e||"#"==e||"&"==e||"@"==e}function IsSpace(e){try{if(""==e)return!0;if("string"==typeof e){for(var t=0;t<e.length;t++)if(!IsCharSpaceRF(e.charCodeAt(t)))return!1;return!0}return e.every(IsCharSpaceRF)}catch(e){logStringMessage("ERROR in IsSpace: "+e)}}var reCharSpace=new RegExp("[\\u0009-\\u000D\\u0020\\u00A0\\u2000-\\u200B\\u3000\\uFEFF]");function IsCharSpaceRF(e){return reCharSpace.test(String.fromCharCode(e))}function RfStringIdToLocalized(e,t,i,n){try{var r="RI_";""!=t&&(r+=t+"_"),r=(r+=i).split(" ").join("_"),logStringMessage("StringIdToLocalized: lookup '"+r+"'");var s=StringIdToLocalizedArray[r];return s||i}catch(e){return i}}var StringIdToLocalizedArray={RI_State_Or_Province_Alaska:"AK",RI_State_Or_Province_Alabama:"AL",RI_State_Or_Province_Arkansas:"AR",RI_State_Or_Province_Arizona:"AZ",RI_State_Or_Province_California:"CA",RI_State_Or_Province_Colorado:"CO",RI_State_Or_Province_Connecticut:"CT",RI_State_Or_Province_District_of_Columbia:"DC",RI_State_Or_Province_Delaware:"DE",RI_State_Or_Province_Florida:"FL",RI_State_Or_Province_Georgia:"GA",RI_State_Or_Province_Hawaii:"HI",RI_State_Or_Province_Iowa:"IA",RI_State_Or_Province_Idaho:"ID",RI_State_Or_Province_Illinois:"IL",RI_State_Or_Province_Indiana:"IN",RI_State_Or_Province_Kansas:"KS",RI_State_Or_Province_Kentucky:"KY",RI_State_Or_Province_Louisiana:"LA",RI_State_Or_Province_Massachusetts:"MA",RI_State_Or_Province_Maryland:"MD",RI_State_Or_Province_Maine:"ME",RI_State_Or_Province_Michigan:"MI",RI_State_Or_Province_Minnesota:"MN",RI_State_Or_Province_Missouri:"MO",RI_State_Or_Province_Mississippi:"MS",RI_State_Or_Province_Montana:"MT",RI_State_Or_Province_North_Carolina:"NC",RI_State_Or_Province_North_Dakota:"ND",RI_State_Or_Province_Nebraska:"NE",RI_State_Or_Province_New_Hampshire:"NH",RI_State_Or_Province_New_Jersey:"NJ",RI_State_Or_Province_New_Mexico:"NM",RI_State_Or_Province_Nevada:"NV",RI_State_Or_Province_New_York:"NY",RI_State_Or_Province_Ohio:"OH",RI_State_Or_Province_Oklahoma:"OK",RI_State_Or_Province_Oregon:"OR",RI_State_Or_Province_Pennsylvania:"PA",RI_State_Or_Province_Rhode_Island:"RI",RI_State_Or_Province_South_Carolina:"SC",RI_State_Or_Province_South_Dakota:"SD",RI_State_Or_Province_Tennessee:"TN",RI_State_Or_Province_Texas:"TX",RI_State_Or_Province_Utah:"UT",RI_State_Or_Province_Virginia:"VA",RI_State_Or_Province_Vermont:"VT",RI_State_Or_Province_Washington:"WA",RI_State_Or_Province_Wisconsin:"WI",RI_State_Or_Province_West_Virginia:"WV",RI_State_Or_Province_Wyoming:"WY",RI_State_Or_Province_AA:"AA",RI_State_Or_Province_AE:"AE",RI_State_Or_Province_AP:"AP",RI_State_Or_Province_American_Samoa:"AS",RI_State_Or_Province_Guam:"GU",RI_State_Or_Province_Northern_Mariana_Is:"MP",RI_State_Or_Province_Puerto_Rico:"PR",RI_State_Or_Province_Palau:"PW",RI_State_Or_Province_Virgin_Island:"VI",RI_State_Or_Province_Australian_Capital_Terr:"ACT",RI_State_Or_Province_New_South_Wales:"NSW",RI_State_Or_Province_Northern_Territory:"NT",RI_State_Or_Province_Queensland:"QLD",RI_State_Or_Province_South_Australia:"SA",RI_State_Or_Province_Tasmania:"TAS",RI_State_Or_Province_Victoria:"VIC",RI_State_Or_Province_Western_Australia:"WA",RI_Group_Person:"Person",RI_Title:"Title",RI_Title_Mr:"Mr",RI_Title_Mrs:"Mrs",RI_Title_Ms:"Ms",RI_Title_Dr:"Dr",RI_Title_Prof:"Prof",RI_Title_Engr:"Engr",RI_Name:"Name",RI_First:"First",RI_Middle:"Mi",RI_Last:"Last",RI_Inset:"Inset",RI_Last2:"Last2",RI_Alphabet_Name:"Alphabet",RI_Roman_Name:"Roman",RI_Suffix:"Suffix",RI_Name_Suffix_Jr:"Jr.",RI_Name_Suffix_Sr:"Sr.",RI_Income:"Income",RI_Driver_License_Number:"Driver Lic",RI_Driver_License:"Driver License",RI_Expires:"Expires",RI_Number:"Number",RI_Social_Security_Number:"Soc Sec No",RI_National_Insurance_Number:"NI Number",RI_National_Health_Service_Number:"NHS Number",RI_ID_Card_Type:"ID Card Type",RI_ID_Card_Number:"ID Card Number",RI_Personal_ID:"Personal ID",RI_Tax_ID:"Tax ID",RI_Fiscal_Code:"Fiscal Code",RI_Person_Cadastre:"Person Cadastre",RI_General_Register:"GR",RI_Dispatching_Agency:"Dispatching agency"},lookup_table={a:"",adres:"address",adress:"address",adresse:"address",addresse:"address",ausst:"issue",ausstellung:"issue",datum:"date",the:"",la:"",und:" and ","&":" and ",et:" and ",nom:"name",nome:"name",nimi:"name","#":"number",nr:" number ",num:" number ",nummer:"number",numer:"number",numero:"number","n":"number","n":"number","1":" 1 ","2":" 2 ",one:" 1 ",two:" 2 ",three:" 3 ",four:" 4 ",five:" 5 ",dag:"day",hausnummer:" hausnr ",huisnummer:" hausnr ",huisnr:" hausnr ",straat:" strasse ",postleitzahl:" plz ",through:" thru ",kaart:"card",kartyaszam:"card number",licence:"license",maned:"month",mobil:" mobile ",mobiel:"mobile",mobiele:"mobile",mobielnummer:"mobile number",movil:"mobile",ocupacion:"occupation",organisation:"organization",tel:" phone ",phn:"phone","phone#":"phone number",telephone:"phone",telephones:"phones",telephon:"phone",telefon:"phone",telefone:"phone",telefonico:"phone",telefono:"phone",telefoon:"phone",telefoonnummer:"phone",telefonunuz:"phone",tlf:"phone",puhelin:"phone",telefoonummer:"phone number",secundario:" second ",secondary:" second ",plaats:" city",geslacht:"sex",geschlecht:"sex",voornaam:"first name ",achternaam:"last name",emailadres:"email",areacode:"area code",mastercard:"master card",dept:"department",koti:"home",kotiin:"home",privado:"home",oficina:"work",tyo:"work",tyohon:"work",osoite:"address",utlopsdato:"expiration date",kortholder:"cardholder",cellphone:"cell phone"};function RfTranslateWords(e){try{if(""==e)return"";e=e.toLowerCase();for(var t="",i=0,n=0;i<e.length;){for(;i<e.length&&!RfIsCharAlphaNum(e[i]);i++);var r="";if(i!=n){var s=i==e.length?i-n+1:i-n;r=e.substr(n,s)}for(n=i;i<e.length&&RfIsCharAlphaNum(e[i]);++i);var a="";if(i==n){t+=r;break}s=i==e.length?i-n+1:i-n;a=e.substr(n,s),n=i;lookup_table[a];t+=r+(null==lookup_table[a]?a:lookup_table[a])}return e=t}catch(t){return logStringMessage("RfTranslateWords error: "+t.message,!1),e}}function isPunctuationSign(e){return" "==e||"."==e||","==e||"-"==e||";"==e||":"==e||"!"==e||"?"==e}function RfIsTextAccumulationTag(e){return"a"==e||"b"==e||"big"==e||"cite"==e||"em"==e||"font"==e||"i"==e||"kbd"==e||"legend"==e||"s"==e||"small"==e||"strong"==e||"span"==e||"sub"==e||"sup"==e||"tt"==e||"u"==e||"var"==e||"wbr"==e}function RfIsCaptionEmpty(e){if(!e)return!0;var t=new CTitleStringData(e).GetWhole();return 0==(t=(t=t.toString()).trim()).length||1==t.length&&!RfIsCharAlphaNum(t[0])}function RfGoInside(e,t){try{if(!e)return logStringMessage("  RfGoInside. node=null -> exit."),!1;if(e.nodeType==EnNodeType.TEXT_NODE)return logStringMessage("  RfGoInside. NODE_TEXT -> exit."),!1;var i=new RfPosition;RfGetNodePosn(e,i);var n=e.tagName;if(n||(n="!"),"br"==(n=n.toLowerCase()))return t.bTextBreak=!0,!0;if("font"==n||"b"==n);else if(!RfIsPosnVisible(i))return logStringMessage("  RfGoInside: do not go into invisible node. posn = "+i),t.bDidNotGoInside=!0,!1;return"select"==n?(logStringMessage("  RfGoInside: do not go into SELECT\n"),t.bDidNotGoInside=!0,!1):"textarea"==n?(logStringMessage("  RfGoInside: do not go into TEXTAREA\n"),t.bDidNotGoInside=!0,!1):(RfIsTextBreakTag(n)&&(logStringMessage("  RfGoInside.  obj_ref.bTextBreak=true"),t.bTextBreak=!0),!0)}catch(e){return logStringMessage("ERROR in RfGoInside: "+e),!1}}function RfIsTextBreakTag(e){return"p"==e||"label"==e||"br"==e||"tr"==e||"td"==e||"tbody"==e||"table"==e||"listing"==e}function RfGetNextNode(e,t,i,n,r){try{if(logStringMessage("RfGetNextNode: bGoRight="+e+" nDomNodes="+r.nDomNodes+" bDidNotGoInside="+n+" nLastSIFound="+t),r.bTextBreak=!1,e)for(var s=r.pCurNode,a=r.pCurNode;;){if((m=a).nodeType==EnNodeType.ELEMENT_NODE){var o=i[m];if(null==o?o=0:o++,i[m]=o,o>14){if(logStringMessage("  GetNextNode: already visited "+m+", go to parent"),r.nLevel--,!(m=m.parentNode))return logStringMessage(" GetNextNode: no parent 1"),void(r.pCurNode=null);a=m;continue}if(s==m&&0==r.nDomNodes)if(RfGoInside(m,u={bDidNotGoInside:n,bTextBreak:r.bTextBreak})&&(a=m.firstChild,logStringMessage("  GetNextNode: RfGoInside return TRUE. Get firstChild for "+m+"  CHILD="+a),a))return r.nLevel++,r.pCurNode=a,void logStringMessage("  GetNextNode: drill down to first child. pNode="+a+"  TAG:"+a.tagName+" level="+r.nLevel)}if(a=m.nextSibling){if(a.nodeType==EnNodeType.ELEMENT_NODE||a.nodeType==EnNodeType.COMMENT_NODE)return logStringMessage("  GetNextNode: go to next sibling. FOR "+m+" nextSibling IS="+a+"  TAG:"+a.tagName+" TYPE="+a.nodeType),void(r.pCurNode=a);if(a.nodeType==EnNodeType.TEXT_NODE){var l=a.nodeValue;if((l=l.trim()).length>0)return logStringMessage("  GetNextNode: go to next sibling. FOR "+m+" nextSibling IS="+a+"  TAG:"+a.tagName+" TYPE="+a.nodeType),void(r.pCurNode=a);if(a=a.nextSibling)return logStringMessage("  GetNextNode: go to next sibling. FOR "+m+" nextSibling IS="+a+"  TAG:"+a.tagName+" TYPE="+a.nodeType),void(r.pCurNode=a)}}if(logStringMessage("  GetNextNode: go to parent 2"),r.nLevel--,!(a=m.parentNode))return logStringMessage("  no parent exit"),void(r.pCurNode=null)}else{var m;if(!(m=r.pCurNode))return void logStringMessage("  GetPrevNode: null node, get out\n");logStringMessage("  GetPrevNode: now at "+m),r.pCurNode=null;var _=m.previousElementSibling,d=m.previousSibling;if(logStringMessage("GetPrevNode prevNode="+d+" prevSiblElem="+_),d)if(logStringMessage("  GetPrevNode: go to PREVIOUS SIBLING = "+d+" NodeType = "+d.nodeType+" tagName = "+d.tagName+" bTextBreak = "+r.bTextBreak),RfGoInside(d,u={bDidNotGoInside:n,bTextBreak:r.bTextBreak}))for(n=u.bDidNotGoInside,r.bTextBreak=u.bTextBreak;;){var u={bDidNotGoInside:n,bTextBreak:r.bTextBreak};(m=d)&&m.tagName&&"iframe"==m.tagName.toLowerCase()?(logStringMessage("  RfGetNextNode. IFRAME workaround..."),d=m.lastChild&&m.lastChild.nodeType==EnNodeType.TEXT_NODE?null:m.lastChild):d=m.lastChild;m.lastElementChild;if(!d){r.pCurNode=m;break}if(!RfGoInside(d,u)){r.bTextBreak=u.bTextBreak,r.pCurNode=d;break}if(r.bTextBreak=u.bTextBreak,r.nLevel++,logStringMessage("  GetPrevNode: drill to last child. level="+r.nLevel),r.nLevel>=RF_LEVEL_START+50)return void(r.pCurNode=null)}else r.pCurNode=d;else logStringMessage("  GetPrevNode: go to PARENT"),r.nLevel--,r.pCurNode=m.parentNode}}catch(e){logStringMessage("ERROR in RfGetNextNode: "+e)}}function RfGetAndProcessNextNode(e){try{e.pDoc;var t=e.bGoRight,i=e.nLastSIFound,n=(e.nHtmlNodes,e.lElementVisits),r=e.posNode,s=e.bDidNotGoInside,a=e.bTextBreak,o=e.sLabel;e.bBrBeforeText;e.pPrevNode=e.pCurNode;for(var l=0;;){if(++l>100){logStringMessage("BREAK!!!");break}var m={bTextBreak:a,nLevel:e.nLevel,pCurNode:e.pCurNode,nDomNodes:e.nDomNodes};if(RfGetNextNode(t,i,n,s,m),e.pCurNode=m.pCurNode,e.nLevel=m.nLevel,e.nDomNodes=m.nDomNodes,e.bTextBreak=m.bTextBreak,!m.pCurNode)return void logStringMessage("   RfGetAndProcessNextNode. AFTER. NODE=null. return");if(m.pCurNode.nodeType==EnNodeType.ELEMENT_NODE||m.pCurNode.nodeType==EnNodeType.COMMENT_NODE){m.pCurNode.nodeType==EnNodeType.COMMENT_NODE&&(m.pCurNode.tagName="!"),e.pHTMLelem=m.pCurNode;var _=t?i+1:i-1;if(e.nLastSIFound=_,e.bDidNotGoInside=!1,e.sTagName=e.pHTMLelem.tagName,e.sTagName=e.sTagName.toLowerCase(),e.nDomNodes=0,e.nHtmlNodes++,e.nHtmlNodes>=RF_MAX_NODES_VISITED)return logStringMessage("   "+o+": too many nodes, get out\n"),void(e.pCurNode=null);if(RfGetNodePosn(e.pHTMLelem,r),e.sTagName,logStringMessage(o+": walked to html: #="+e.nLastSIFound+" tag="+e.sTagName+" lev="+e.nLevel+" pos="+r),"font"==e.sTagName||"br"==e.sTagName);else if(!RfIsPosnVisible(r)){logStringMessage("    skip invisible node\n");continue}if("img"==e.sTagName){var d=e.pHTMLelem.width;try{if(d&&parseInt(d)>=25){var u=e.pHTMLelem.getAttribute("alt");e.sText=u}}catch(e){}}return void(RfIsSpaces(e.sText)||logStringMessage("  image added text '"+e.sText+"'"))}e.pHTMLelem=null,e.nDomNodes++;var f=!0,p=e.pCurNode.parentNode;if(p&&p.nodeType==EnNodeType.ELEMENT_NODE){var h="undefined"!=typeof window?window:p.ownerDocument.defaultView;if(!h)return logStringMessage("RfGetAndProcessNextNode. local_window=NULL -> return false"),!1;var g={bCountFields:!1,pElem:p,bInvisibleButCanChange:!1,local_window:h};f=RfIsElemVisibleInStyleSheets(g);var c=new RfPosition;f&&(g.pRealVisibleElement&&(p=g.pRealVisibleElement),rf_GetNodePosn(p,c),(c.m_x+c.m_width<0||c.m_y+c.m_height<0)&&(logStringMessage("  --too big negative offset %s, skip it \n"+c),f=!1))}if(f){if(e.sText=m.pCurNode.nodeValue,m.pCurNode.previousSibling&&m.pCurNode.previousSibling.nodeType==EnNodeType.ELEMENT_NODE&&"br"==m.pCurNode.previousSibling.tagName.toLowerCase()&&(e.bBrBeforeText=!0),e.sText){e.sText=e.sText.split("\t").join(""),e.bBrBeforeText&&(e.sText=e.sText.split("\n").join(""));var C=!1;" "==e.sText[0]&&" "!=e.sText[1]&&(C=!0),e.sText=e.sText.trim(),e.sText.length&&C&&(e.sText=" "+e.sText)}logStringMessage("TEXT NODE nodeValue='"+m.pCurNode.nodeValue+"'")}return logStringMessage(o+": walked to domN: lev="+e.nLevel+" text='"+e.sText+"'  BREAK_LINE_BEFORE="+e.bBrBeforeText),void(GetTextNodePosition(m.pCurNode,r)&&logStringMessage("exact domN posn="+r))}}catch(e){logStringMessage("ERROR in RfGetAndProcessNextNode: "+e)}}function RfIsPosnVisibleStrict(e){return e.m_x>=0&&e.m_y>=0&&(e.m_width>0||e.m_height>0)}function RfIsPosnVisible(e){return(e.m_x!=RF_BAD_OFFSET||e.m_y!=RF_BAD_OFFSET)&&(e.m_width>0||e.m_height>0)}function RfIsSpaces(e){if(!e||""==e)return!0;for(var t=0;t<e.length;++t)if(" "!=e.charAt(t))return!1;return!0}function RfTrimCaption(e){try{return""==e?"":1!=(e=(e=new CTitleStringData(e).GetWhole()).trim()).length||RfIsCharAlphaNum(e[0])?"###"==e||"####"==e?"":e:(logStringMessage("RfTrimCaption: drop "+e),"")}catch(e){return logStringMessage("ERROR in RfTrimCaption: "+e),""}}function RfGetNodePosn(e,t){try{t.m_pOffsetParent=e.offsetParent,t.m_pOffsetParent&&(t.m_pOffsetParent=t.m_pOffsetParent,t.m_y=e.offsetTop,t.m_x=e.offsetLeft,t.m_width=e.offsetWidth,t.m_height=e.offsetHeight)}catch(e){logStringMessage("RfGetNodePosn error: "+e)}}function not(e){return function(t){return!e(t)}}function Mid(e,t,i){if(t<0||i<0)return"";var n,r=String(e).length;return n=t+i>r?r:t+i,String(e).substring(t,n)}function CField(e,t,i,n,r,s,a){try{this.m_sName=e||"",this.m_sCaption=t||"",this.m_sId=i||"",this.m_sValue=r||"",this.m_nOrderIndex=0,this.m_field_type=s||RfFieldType.RfField_None,this.m_bUsed=!1,this.m_bDefaultValue=a||!1}catch(e){logStringMessage("CField constructor error: "+e)}}function CPasscard(){this.m_sMatchURL="",this.m_sGotoURL="",this.m_lFields=[],this.m_bLoaded=0,this.m_bAllParsed=0,this.m_sNote="",this.m_NamesIndexes={},this.m_nNonemptyTextFields=0,this.m_nChangedTextFields=0,this.m_nPasswordFields=0,this.m_nNonemptyPasswordFields=0,this.m_bFirstPasswordField=0,this.m_sxmlData=""}function CFilledFormInfo(e,t){this.m_nFillableFields=0,this.m_nPasswordFields=0,this.m_pFormUnknown=null,2==arguments.length&&(this.m_nFillableFields=e,this.m_nPasswordFields=t)}function CSubmitFormInfo(e){if(this.m_sTagName="",this.m_sType="",this.m_sName="",this.m_sNavigateUrl="",this.m_bNavOnlyLink=!1,this.m_bDefiniteSubmit=!1,this.m_nXrel=-1,this.m_nYrel=-1,this.m_sClickText="",this.m_sClickCaption="",this.m_sClickImgUrl="",1==arguments.length){logStringMessage("CSubmitFormInfo. arguments.length:"+arguments.length+"  sInput:"+e);var t={i:0};this.m_nYrel=RfReadIntFromString(e,t,":",-1),this.m_nXrel=RfReadIntFromString(e,t,":",-1);var i=RfReadStringFromString(e,t,":");null!=i&&(this.m_sClickText=i);var n=RfReadStringFromString(e,t,":");null!=n&&(this.m_sClickImgUrl=n),this.m_bNavOnlyLink=RfReadIntFromString(e,t,":",0);var r=RfReadStringFromString(e,t,":");r&&(this.m_sClickCaption=r),this.m_sClickCaption=this.m_sClickCaption.replace("%3A",":"),this.m_sClickCaption=this.m_sClickCaption.replace("%25","%"),logStringMessage("this.m_nYrel:"+this.m_nYrel+"  this.m_nXrel:"+this.m_nXrel+" this.m_sClickText:"+this.m_sClickText+" this.m_sClickImgUrl:"+this.m_sClickImgUrl+" this.m_bNavOnlyLink:"+this.m_bNavOnlyLink+" this.m_sClickCaption:"+this.m_sClickCaption)}}function rf_GetNodePosn(e,t){try{if(t.m_width=rf_GetObjectWidth(e),t.m_height=rf_GetObjectHeight(e),e.offsetParent)for(t.m_pOffsetParent=e.offsetParent;e;)-1==t.m_x&&0==e.offsetLeft&&(t.m_x=0),-1==t.m_y&&0==e.offsetTop&&(t.m_y=0),t.m_x+=e.offsetLeft,t.m_y+=e.offsetTop,e=e.offsetParent;else e.x&&e.y&&(t.m_x+=e.x,t.m_y+=e.y,t.m_pOffsetParent=e.offsetParent);return!0}catch(e){logStringMessage("rf_GetNodePosn error: "+e)}}function rf_GetObjectWidth(e){try{var t=0;return e.offsetWidth?t=e.offsetWidth:e.clip&&e.clip.width?t=e.clip.width:e.style&&e.style.pixelWidth&&(t=e.style.pixelWidth),parseInt(t)}catch(e){return logStringMessage("rf_GetObjectWidth error: "+e),0}}function rf_GetObjectHeight(e){try{var t=0;return e.offsetHeight?t=e.offsetHeight:e.clip&&e.clip.height?t=e.clip.height:e.style&&e.style.pixelHeight&&(t=e.style.pixelHeight),parseInt(t)}catch(e){return logStringMessage("rf_GetObjectHeight error: "+e),0}}function RfReadStringFromString(e,t,i){try{var n=e.indexOf(i,t.i);if(n>=0){var r=Mid2(e,t.i,n-t.i);return t.i=n+1,r}return t.i<e.length&&(r=Mid2(e,t.i,e.length),t.i=e.length),r}catch(e){logStringMessage("RfReadStringFromString: "+e)}}function RfReadIntFromString(e,t,i,n){try{for(var r,s=0;t.i<e.length&&(r=parseInt(e[t.i]),!isNaN(r));)s=10*s+r,t.i++;return t.i==e.length||t.i<e.length&&e[t.i]==i?(t.i++,s):n}catch(e){logStringMessage("RfReadIntFromString: "+e)}}function Mid2(e,t,i){if(t<0||i<0)return"";var n,r=String(e).length;return n=t+i>r?r:t+i,String(e).substring(t,n)}CField.prototype.attach=function(e){return this.m_sName=e.m_sName,this.m_sCaption=e.m_sCaption,this.m_sId=e.m_sId,this.m_sValue=e.m_sValue,this.m_nOrderIndex=e.m_nOrderIndex,this.m_field_type=e.m_field_type,this.m_bUsed=e.m_bUsed,this.m_bDefaultValue=e.m_bDefaultValue,this},CField.prototype.clone=function(){return(new CField).attach(this)},CField.prototype.equals=function(e){return!!e&&(this.m_sName==e.m_sName&&this.m_sCaption==e.m_sCaption&&this.m_sId==e.m_sId&&this.m_sValue==e.m_sValue&&this.m_nOrderIndex==e.m_nOrderIndex&&this.m_field_type==e.m_field_type&&this.m_bUsed==e.m_bUsed&&this.m_bDefaultValue==e.m_bDefaultValue)},CField.prototype.getName=function(){return this.m_sName},CField.prototype.getValue=function(){return this.m_sValue},CField.prototype.toString=function(){var e=this.m_field_type;return this.m_field_type==RfFieldType.RfFieldText?e="TEXT":this.m_field_type==RfFieldType.RfFieldPassword?e="PASSWORD":this.m_field_type==RfFieldType.RfFieldCheckbox?e="CHECKBOX":this.m_field_type==RfFieldType.RfFieldTextArea?e="TEXT_AREA":this.m_field_type==RfFieldType.RfFieldSelect?e="SELECT":this.m_field_type==RfFieldType.RfFieldRadioCheck&&(e="RADIO"),"<<CField>> NAME:"+this.m_sName+" CAPTION:"+this.m_sCaption+" VALUE:"+this.m_sValue+" TYPE:"+e+" DEF_VALUE:"+this.m_bDefaultValue+" ORDER_IND:"+this.m_nOrderIndex+" ID:"+this.m_sId},CPasscard.prototype.toString=function(){return"<<CPasscard>>  this.m_bFirstPasswordField='"+this.m_bFirstPasswordField+"'  this.m_nNonemptyPasswordFields='"+this.m_nNonemptyPasswordFields+"' this.m_nPasswordFields='"+this.m_nPasswordFields+"' this.m_nChangedTextFields='"+this.m_nChangedTextFields+"' this.m_nNonemptyTextFields='"+this.m_nNonemptyTextFields+"' FIELDS='"+this.m_lFields.length+"'"},CPasscard.prototype.LoadOnline=function(e){try{for(var t=$(e).find("field"),i=0;i<t.length;++i){var n=t[i],r=n.getAttribute("name"),s=0,a=r.indexOf("[");if(-1!=a){var o=r.substring(0,a);s=parseInt(r.substr(a+1,1)),r=o}this.AddField7(r,"","",s,n.textContent,n.getAttribute("type"),!1)}return this.m_bLoaded=!0,!0}catch(e){return void logStringMessage("Error in CPasscard::LoadOnline "+e.toString(),!0)}},CPasscard.prototype.GetLoaded=function(){return this.m_bLoaded},CPasscard.prototype.AddField7=function(e,t,i,n,r,s,a){try{var o=0;o=""==n?this.GetNextOrderIndex(e):n,logStringMessage("***AddField7.  sName:'"+e+"'  ID='"+i+"'  nOrderIndex:'"+o+"'  sValue:'"+r+"'  field_type:'"+s+"' DefaultValue:'"+a+"'");var l=new CField;l.m_sName=e,l.m_sCaption=t,l.m_sId=i,l.m_nOrderIndex=parseInt(o),l.m_sValue=r,l.m_field_type=s,l.m_bDefaultValue=!!a,this.m_lFields.push(l)}catch(e){logStringMessage("Error in CPasscard::LoadValues "+e.toString(),!0)}},CPasscard.prototype.GetNextOrderIndex=function(e){try{var t=0;e=e.toLowerCase();var i=this.m_NamesIndexes[e];return null!=i?(t=parseInt(i)+1,this.m_NamesIndexes[e]=t):this.m_NamesIndexes[e]=0,t}catch(e){return logStringMessage("CPasscard.GetNextOrderIndex error: "+e),0}},CPasscard.prototype.ClearPC=function(e){try{e||(e=1),e>=1&&(this.m_sMatchURL="",this.m_sGotoURL="",this.m_bAllParsed=!1,this.m_bLoaded=!1),e>=0&&(this.m_lFields.length=0,this.m_nNonemptyTextFields=0,this.m_nChangedTextFields=0,this.m_nPasswordFields=0,this.m_nNonemptyPasswordFields=0,this.m_bFirstPasswordField=!1)}catch(e){return void logStringMessage("Error in CPasscard::ClearPC "+e.toString(),!0)}},CPasscard.prototype.HasFieldValues=function(){return this.m_bLoaded&&this.m_bAllParsed},CPasscard.prototype.AddSpecialField=function(e,t,i,n){this.AddField7(e,"","","",t,i,n)},CPasscard.prototype.GetTwoField=function(e){try{e.bHasUserid=!1,e.bHasPassword=!1;for(var t=0;t<this.m_lFields.length;t++){var i=this.m_lFields[t];if(i.m_field_type==RfFieldType.RfFieldPassword&&i.m_sValue!=RF_ANY_VALUE_HERE&&i.m_sValue!=RF_DEFAULT_VALUE_HERE){e.bHasPassword=!0,e.sPasswordValue=i.m_sValue;for(var n=t;n>=0;n--){var r=this.m_lFields[n];if((r.m_field_type==RfFieldType.RfFieldText||r.m_field_type==RfFieldType.RfField_None||r.m_field_type==RfFieldType.RfFieldTextArea||r.m_field_type==RfFieldType.RfFieldSelect)&&r.m_sValue!=RF_ANY_VALUE_HERE&&r.m_sValue!=RF_DEFAULT_VALUE_HERE){e.bHasUserid=!0,e.sUseridValue=r.m_sValue;break}}return!0}}return!1}catch(e){return logStringMessage("CPasscard.GetTwoField error: "+e),!1}},CPasscard.prototype.FillingSetUsed=function(e,t,i){try{for(var n=-1,r=!0,s=0;s<this.m_lFields.length;s++){if((RFNAME_NONAME===e.sName||""===e.sName)&&""!==e.sId&&e.sId===this.m_lFields[s].m_sId)return e.sValue=this.m_lFields[s].m_sValue,this.m_lFields[s].m_bUsed=!0,!0;if(this.m_lFields[s].m_sName===e.sName&&(""!==e.sName&&e.sName!==RFNAME_NONAME||this.m_lFields[s].m_field_type==i)&&this.m_lFields[s].m_nOrderIndex==t)return e.sValue=this.m_lFields[s].m_sValue,this.m_lFields[s].m_bUsed=!0,!0;e.sId&&e.sId===this.m_lFields[s].m_sId&&(n>=0?r=!1:n=s)}return!!(n>=0&&r)&&(e.sValue=this.m_lFields[n].m_sValue,this.m_lFields[n].m_bUsed=!0,!0)}catch(e){return logStringMessage("CPasscard.FillingSetUsed error: "+e),!1}},CPasscard.prototype.IsTwoField=function(){try{for(var e=0;e<this.m_lFields.length;e++){var t=this.m_lFields[e];if(t.m_sName==RFNAME_PASSWORD||t.m_sName==RFNAME_USERID)return!0}return!1}catch(e){return logStringMessage("CPasscard.IsTwoField error: "+e),!1}},CPasscard.prototype.Filling=function(e){try{for(var t=0;t<this.m_lFields.length;t++){var i=this.m_lFields[t];if(i.m_sName==e.sName&&(""!=e.sName&&e.sName!=RFNAME_NONAME||i.m_field_type==e.eType)&&i.m_nOrderIndex==e.nOrderIndex)return e.sValue=i.m_sValue,!0}return!1}catch(e){return logStringMessage("CPasscard.IsTwoField error: "+e),!1}},CPasscard.prototype.HasAnyValueHere=function(){try{for(var e=0;e<this.m_lFields.length;e++){if(this.m_lFields[e].m_sValue==RF_ANY_VALUE_HERE)return!0}return!1}catch(e){return logStringMessage("CPasscard.HasAnyValueHere error: "+e),!1}},CPasscard.prototype.HasLoginTip=function(){try{for(var e=0;e<this.m_lFields.length;e++){if(this.m_lFields[e].m_sName==RFNAME_LOGINTIP)return!0}return!1}catch(e){return logStringMessage("CPasscard.HasLoginTip error: "+e),!1}},CPasscard.prototype.GetButtonToClick=function(e){try{var t={};return t.sName=RFNAME_SUBMIT,t.nOrderIndex=0,t.eType=RfFieldType.RfField_None,t.sValue="",this.Filling(t)?(e.button_to_click=new CSubmitFormInfo(t.sValue),!0):(e.button_to_click=new CSubmitFormInfo,!1)}catch(e){return logStringMessage("CPasscard.GetButtonToClick error: "+e),!1}},CPasscard.prototype.HasDuplicatePassword=function(e,t){try{t=!1;for(var i=0;i<this.m_lFields.length;i++){var n=this.m_lFields[i];if(n.m_field_type==RfFieldType.RfFieldPassword&&""!=n.m_sValue&&n.m_sValue!=RF_DEFAULT_VALUE_HERE&&n.m_sValue!=RF_ANY_VALUE_HERE){if(t||n.m_bDefaultValue||(t=!0),""!=e&&n.m_sValue==e)return!0;e=n.m_sValue}}return!1}catch(e){return logStringMessage("CPasscard.HasDuplicatePassword error: "+e),!1}},CPasscard.prototype.NoPasswords=function(e){try{for(var t=0,i=0;i<this.m_lFields.length;i++){var n=this.m_lFields[i];n.m_field_type!=RfFieldType.RfFieldPassword&&n.m_sName!=RFNAME_PASSWORD||(e?""!=n.m_sValue&&n.m_sValue!=RF_DEFAULT_VALUE_HERE&&n.m_sValue!=RF_ANY_VALUE_HERE&&t++:t++)}return t}catch(e){return logStringMessage("ERROR in CPasscard.NoPasswords : "+e),0}},CPasscard.prototype.SetButtonToClick=function(e){var t=e.m_sClickCaption.replace(":","%3A");t=t.replace("%","%25");var i=e.m_bNavOnlyLink&&"false"!=e.m_bNavOnlyLink?1:0,n=e.m_nYrel+":"+e.m_nXrel+":"+e.m_sClickText+":"+e.m_sClickImgUrl+":"+i+":"+t;return logStringMessage("CPasscard.SetButtonToClick :"+n),this.AddSpecialField(RFNAME_SUBMIT,n,RfFieldType.RfField_None,!1),!0},CPasscard.prototype.SetHasFieldValues=function(){this.m_bLoaded=!0,this.m_bAllParsed=!0},CPasscard.prototype.SetTwoField=function(e,t){this.AddSpecialField(RFNAME_USERID,e,RfFieldType.RfFieldText,!1),this.AddSpecialField(RFNAME_PASSWORD,t,RfFieldType.RfFieldPassword,!1)},CPasscard.prototype.SetPasswordOnly=function(e){this.AddSpecialField(RFNAME_PASSWORD,e,RfFieldType.RfFieldPassword,!1)},CPasscard.prototype.SetNewAccount=function(){this.AddSpecialField(RFNAME_NEWACCOUNT,"*",RfFieldType.fField_None,!1)},CPasscard.prototype.FindNoteField=function(){for(var e=0;e<this.m_lFields.length;e++){var t=this.m_lFields[e];if(t.m_sName==RFNAME_NOTE||t.m_sName==RFNAME_NOTEOLD)return e}return-1},CPasscard.prototype.GetNoteText=function(){var e=this.FindNoteField();if(!(e<0)){var t=this.m_lFields[e];if(t.m_sValue)return t.m_sValue}},CPasscard.prototype.SetNoteText=function(e){var t=this.FindNoteField();t>=0?this.m_lFields[t].m_sValue=e:this.AddField7(RFNAME_NOTE,"","",0,e,RfFieldType.RfField_None,!1)},CPasscard.prototype.SetBookmark=function(e){this.m_sMatchURL="{Bookmark}",this.ClearPC(0),this.SetNoteText(e)},CPasscard.prototype.SetLoginTip=function(e){this.AddField7(RFNAME_LOGINTIP,"","",0,e,RfFieldType.RfFieldText,!1)},CPasscard.prototype.IsNewAccount=function(){try{var e={};return e.sName=RFNAME_NEWACCOUNT,e.nOrderIndex=0,e.eType=RfFieldType.RfField_None,e.sValue="",!!this.Filling(e)}catch(e){return logStringMessage("CPasscard.IsNewAccount error: "+e),!1}},CPasscard.prototype.IsBasicAuth=function(){try{var e={};return e.sName=RFNAME_BASICAUTH,e.nOrderIndex=0,e.eType=RfFieldType.RfField_None,e.sValue="",!!this.Filling(e)}catch(e){return logStringMessage("CPasscard.IsBasicAuth: "+e),!1}},CPasscard.prototype.GetBlocking=function(){if(!this.HasFieldValues())return 0;if(this.m_lFields.length>=5)return 0;for(var e=0,t=0;t<this.m_lFields.length;t++){var i=this.m_lFields[t];i.m_sName==RFNAME_NOAUTOFILL?(e|=RF_BLOCKING_PASSCARD,i.m_sValue&&(e|=RF_BLOCK_FILL_PASSCARD|RF_BLOCK_FILL_IDENTITY)):i.m_sName==RFNAME_NOAUTOFILLFROMIDENTITY?(e|=RF_BLOCKING_PASSCARD,i.m_sValue&&(e|=RF_BLOCK_FILL_IDENTITY)):i.m_sName==RFNAME_NOAUTOFILLFROMPASSCARD?(e|=RF_BLOCKING_PASSCARD,i.m_sValue&&(e|=RF_BLOCK_FILL_PASSCARD)):i.m_sName==RFNAME_NOAUTOSAVE&&(e|=RF_BLOCKING_PASSCARD,i.m_sValue&&(e|=RF_BLOCK_SAVE))}return e},CSubmitFormInfo.prototype.ConvertToString=function(){return this.m_nYrel+":"+this.m_nXrel+":"+this.m_sClickText+":"+this.m_sClickImgUrl+":"+(this.m_bNavOnlyLink?1:0)+":"+this.m_sClickCaption},CSubmitFormInfo.prototype.IsDefined=function(){return this.m_nXrel>=0||this.m_nYrel>=0||""!=this.m_sClickText||""!=this.m_sClickImgUrl},CSubmitFormInfo.prototype.toString=function(){return" <<CSubmitFormInfo  TEXT:'"+this.m_sClickText+"' TAG:'"+this.m_sTagName+"'  TYPE:'"+this.m_sType+"' NAME:'"+this.m_sName+"' NavURL:'"+this.m_sNavigateUrl+"'  ImgURL:'"+this.m_sClickImgUrl+"' CAPTION:'"+this.m_sClickCaption+"' m_nXrel:'"+this.m_nXrel+"' m_nYrel:'"+this.m_nYrel+"' >>"};var EnButtonMatchLevel={enNone:0,enPossibleSubmit:1,enDefiniteSubmit:2,enMatchingSubmit:3};function CRfClickButtonCoords(){this.m_nSubmitButtonsFound=-1,this.m_bToEnter=!1,this.m_pClickButton=null,this.m_pSubmitForm=null,this.m_enResult=EnResultCode.enSuccess,this.m_enMatchLevel=EnButtonMatchLevel.enNone}function RfFindAndClickSubmitButton(e,t,i){try{logStringMessage("+++RfFindAndClickSubmitButton ENTRY. pDoc="+e+"  clicked_button="+t+" filled_forms="+i);var n=new CRfClickButtonCoords;return RfFindSubmitButton(e,t,i,n),1!=n.m_nSubmitButtonsFound?(n=null,!1):(RfClickSubmitButton(e,n),n=null,!0)}catch(e){logStringMessage("RfFindAndClickSubmitButton: "+e)}}function RfFindSubmitButton(e,t,i,n){try{logStringMessage("+++RfFindSubmitButton ENTRY click_button="+t),n.m_nSubmitButtonsFound=0;var r=e.forms.length;if(0==this.nFormsCount)return logStringMessage("RfFindSubmitButton. nFormsCount ==0"),void(n.m_enResult=EnResultCode.enFoundNoButtons);logStringMessage("+++RfFindSubmitButton Total nFormsCount:"+r+" FilledForms:"+i.length);for(var s=i.length,a=!1,o=0;o<s;o++){(L=(P=i[o]).m_pFormUnknown)&&(logStringMessage("+++RfFindSubmitButton pForm:"+L),P.m_nPasswordFields>0?a||(logStringMessage("==AutoSubmit: set password m_pSubmitForm = "+L),n.m_pSubmitForm=L,a=!0):a||(logStringMessage("==AutoSubmit: set non-password m_pSubmitForm = "+L),n.m_pSubmitForm=L))}var l=!0;0!=i.length||t.m_bNavOnlyLink||(n.m_enResult=EnResultCode.enFilledNoForms,logStringMessage("RfFindSubmitButton regular form submit passcard. Try to found Submit button in regular Document"),l=!1);var m=i.length>1,_=null,d=-1,u=-1,f=null,p=!1,h=null;n.m_bToEnter=!1;var g,c=null,C=!1,F=(t.ConvertToString(),!1);try{g=e.createEvent("KeyboardEvent")}catch(e){}if(g&&void 0===g.initKeyEvent&&(F=!0,t.m_sClickText&&"-"==t.m_sClickText[0]&&(t.m_sClickText="",t.m_nYrel=-1,t.m_nXrel=-1)),g_isfirefox&&a&&e.URL.indexOf("wellsfargo.com")>=0&&(t.m_sClickText="-password-"),t.m_sClickText&&"-"==t.m_sClickText[0]&&!F){var S;if(logStringMessage("+++AutoSubmitEnter: look for ENTER field in INPUT fields\n"),n.m_bToEnter=!0,!s)return void logStringMessage("RfFindSubmitButton. filledcount ==0");for(var b=0;b<s;b++){if(S=(P=i[b]).m_pFormUnknown){if(logStringMessage("AutoSubmitEnter: check form="+S),!(L=S)){logStringMessage("!!!AutoSubmit: cannot get form\n");continue}if(!(w=new CRfHtmlInputIterator(!0)).BuildForm(L)){logStringMessage("!!!AutoSubmit: no build collection\n");continue}}else{if(logStringMessage("AutoSubmitEnter: check document="+e),(w=new CRfHtmlInputIterator).Build2(e),!w){logStringMessage("!!!AutoSubmit: no build collection\n");continue}if(0==w.GetSizeofArray()){logStringMessage("!!!AutoSubmit: no build collection\n");continue}}}for(var R=w.GetSizeofArray(),T=0;T<R;T++){if(!(Y=w.GetNext()))break;if(logStringMessage("  AutoSubmitEnter: index="+T+" field="+Y),!S)if(Y.form){logStringMessage("      SubmitButtonStart: under-FORM field already visited\n");continue}var N={bCheckClickable:!1,bCheckEnterable:!0,bChangeableInvisibleMeansVisible:!0,bForceAutoSave:!1,bInvisibleButCanChange:!1},y=new CSubmitFormInfo;if(0!=RfIsElementClickable(Y,N,y)&&("-text-"==t.m_sClickText&&"-text-"==y.m_sClickText||"-password-"==t.m_sClickText&&"-password-"==y.m_sClickText)){if(_){var I=Math.abs(y.m_nYrel-t.m_nYrel),E=Math.abs(y.m_nXrel-t.m_nXrel);logStringMessage("      SubmitEnter: 2nd or later match by button text or img url: nYdiffNew="+I+" nXdiffNew="+E+" nYdiff="+u+" nXdiff="+d),E+I<d+u?(logStringMessage("      SubmitEnter: BETTER than the best match\n"),_=Y,u=I,d=E):logStringMessage("      SubmitEnter: NOT better than the best match\n")}else{u=Math.abs(y.m_nYrel-t.m_nYrel),d=Math.abs(y.m_nXrel-t.m_nXrel);logStringMessage("      SubmitEnter: first match by button text or img url: nYdiffNew='"+u+"' nXdiffNew='"+d+"'"),_=Y}if(u<RF_MIN_BUTTON_DISTANCE&&d<RF_MIN_BUTTON_DISTANCE||-1==t.m_nYrel){logStringMessage("      SubmitEnter: clicked-field found, break\n");break}}}}else{logStringMessage("+++AutoSubmitButton: look for SUBMIT button in HTML elements\n");var v=[];v=e.getElementsByTagName("*"),logStringMessage("+++RfFindSubmitButton Constructing pAll for mozilla, safari, chrome!  COUNT="+v.length);for(var M=[],A=(r=0,0);A<v.length;A++)if(void 0!==v[A].tagName&&"undefined"!=v[A].tagName)if("form"==v[A].tagName.toLowerCase()){for(var x=!1,O=0;O<i.length;O++){var P,L=(P=i[O]).m_pFormUnknown;if(v[A]==L){x=!0;break}}x&&(v[A].sourceIndex=A,M.push(v[A]))}else v[A].sourceIndex=A;r=M.length,l||(logStringMessage("Set forms count to 1"),r=1);var k=!0;0==r&&(l=!1,r=1,k=!1);for(b=0;b<r;b++){var D=1;if(l){var w,V=M[b];if(D=V.sourceIndex,!V)continue;if(!(w=new CRfHtmlInputIterator(!0)).BuildForm(V))continue;V.sourceIndex&&(D=V.sourceIndex)}logStringMessage("+++RfFindSubmitButton All: "+v.length+" StartIndex:"+D);for(var B=D-1,G=0,U=!1,H=!1,Y=null,W=B;W<v.length;W++)if(Y=v[++B]){logStringMessage("RfFindSubmitButton. TEST ELEMENT ### TAG:"+Y.tagName+"  Index:"+B+"  ID:"+Y.id);var j=new CSubmitFormInfo,z={bCheckClickable:!0,bCheckEnterable:!1,bChangeableInvisibleMeansVisible:!0,bForceAutoSave:!0,bInvisibleButCanChange:!1},K=RfIsElementClickable(Y,z,j);if(logStringMessage("RfFindSubmitButton*** TAG='"+Y.tagName+"'  Index:"+B+"   rc:"+K+"   button_info.m_sType='"+j.m_sType+"' \nbMetChangedTextField:"+U+" click_button.m_bNavOnlyLink="+t.m_bNavOnlyLink+"  button_info.m_bNavOnlyLink="+j.m_bNavOnlyLink),U||"text"!=j.m_sType&&"password"!=j.m_sType||(logStringMessage("RfFindSubmitButton. "+Y.tagName+"  Index:"+B+"   rc:"+K+"   button_info.m_sType:"+j.m_sType+" \n bMetChangedTextField:"+U+"  pElem.value='"+Y.value+"'  pElem.defaultValue='"+Y.defaultValue+"'  ID="+Y.getAttribute("id")),(U=RfCheckForChangedValues(Y.getAttribute("title"),Y.defaultValue,Y.value,B))&&logStringMessage("@@@@@@@@@ bMetChangedTextField!!!")),(K>=1||j.m_bNavOnlyLink)&&U&&!z.bInvisibleButCanChange&&j.m_sClickText&&""!=j.m_sClickText&&1!=j.m_sClickText.length&&(logStringMessage("nClickableFields++ : "+G),++G>=40)){logStringMessage("SubmitButton: 40 or more clickables passed, break\n nElemIx:"+B);break}if(2==K)logStringMessage("rc=2"),c?C=!0:c=Y;else if(0==K){if(b!=r-1&&B>D&&"form"==j.m_sTagName&&k){logStringMessage("SubmitButton: hit the next FORM, end this cycle nElemIx:"+B+"\nStartFieldIx:"+D);break}if(f&&"form"==j.m_sTagName){logStringMessage("SubmitButton: definte submit, hit the next form -- found it\n nElemIx:"+B),H=!0;break}}else if(1==K&&(t.m_bNavOnlyLink||!j.m_bNavOnlyLink)){if(g_isfirefox&&e.URL.startsWith("https://simple-note.appspot.com/"))if(!RfIsElemVisible(Y,new CRfHtmlObjectProperties))continue;if(g_isfirefox&&e.URL.startsWith("http://forum.nero.com/"))if(!RfIsElemVisible(Y,new CRfHtmlObjectProperties))continue;I=Math.abs(j.m_nYrel-t.m_nYrel),E=Math.abs(j.m_nXrel-t.m_nXrel);if(logStringMessage("RC=1. pPossibleSubmit:"+h+"  ClickableCount:"+G+" nYdiffNew: "+I+"  nXdiffNew:"+E+" \nclick_button:"+t+" \nnElemIx:"+B+" Tag:"+Y.tagName+" \nnbutton_info:"+j),""!=t.m_sClickText&&(t.m_sClickText=t.m_sClickText.toLowerCase(),t.m_sClickText=RfNormalizeButtonCaption(t.m_sClickText),j.m_sClickText&&""!=j.m_sClickText&&(j.m_sClickText=j.m_sClickText.toLowerCase())),""!=t.m_sClickText&&j.m_sClickText==t.m_sClickText||""!=t.m_sClickImgUrl&&j.m_sClickImgUrl==t.m_sClickImgUrl||""==t.m_sClickText&&""==j.m_sClickText&&!z.bInvisibleButCanChange&&0==I&&0==E&&-1!=t.m_nYrel){if(logStringMessage("1. INSIDE IF. click_button.m_sClickText:"+t.m_sClickText+"  click_button.m_sClickImgUrl:"+t.m_sClickImgUrl+" nElemIx:"+B+" click_button.m_nYrel:"+t.m_nYrel),_)E+I<=d+u?j.m_nXrel>0&&j.m_nYrel>0&&(logStringMessage("SubmitButton: NOT WORSE than the best match\n nElemIx:"+B),_=Y,u=I,d=E):logStringMessage("SubmitButton: WORSE than the best match\n nElemIx:"+B);else{if(u=I,d=E,g_isfirefox&&e.URL.startsWith("http://forum.nero.com/")&&I>RF_MIN_BUTTON_DISTANCE&&E>RF_MIN_BUTTON_DISTANCE)continue;logStringMessage("SubmitButton: first match by button text or img url\n nElemIx:"+B),_=Y}if(u<RF_MIN_BUTTON_DISTANCE&&d<RF_MIN_BUTTON_DISTANCE&&"a"!=j.m_sTagName&&"tr"!=j.m_sTagName&&"td"!=j.m_sTagName&&"div"!=j.m_sTagName&&"span"!=j.m_sTagName){logStringMessage("SubmitButton: clicked-button found, break\n"),H=!0;break}}if(U&&!z.bInvisibleButCanChange&&(f?RfIsActionButtonCaption(j.m_sClickText)>0:j.m_bDefiniteSubmit||RfIsActionButtonCaption(j.m_sClickText)>0)||t.m_nYrel>=0&&t.m_nXrel>=0&&j.m_nYrel>=0&&j.m_nXrel>=0&&I<RF_MIN_BUTTON_DISTANCE&&E<RF_MIN_BUTTON_DISTANCE)if(logStringMessage("*****INSIDE pDefiniteSubmit IF ! bMetChangedTextField:"+U+"  params.bInvisibleButCanChange: "+z.bInvisibleButCanChange),null==f){if(f=Y,logStringMessage("###SubmitButton: first definite LOGIN/SUBMIT button.  nElemIx:"+B+"   Tag:"+Y.tagName+" sourceIndex:"+f.sourceIndex+"  pDefiniteSubmit="+f),!m&&!t.IsDefined()){logStringMessage("SubmitButton: final selection: definite submit on the only filled form\n nElemIx:"+B),H=!0;break}}else logStringMessage("SubmitButton: 2nd definite LOGIN/SUBMIT button, confusion\n nElemIx:"+B),p=!0;else if(RfIsActionButtonCaption(j.m_sClickText)<0)logStringMessage("SubmitButton: definetly NOT login/submit, skip\n nElemIx:"+B);else if(!h&&U&&!z.bInvisibleButCanChange){var X=j.m_sNavigateUrl,J=j.m_sClickImgUrl;X=RfNormalizeImgUrl({sValue:X,bAggressive:!0}),J=RfNormalizeImgUrl({sValue:J,bAggressive:!0}),logStringMessage("!pPossibleSubmit. button_info:"+j+" nElemIx:"+B),(RfIsActionButtonCaption(X)>0||RfIsActionButtonCaption(J)>0||RfIsActionButtonCaption(j.m_sName)>0||-1!=j.m_sClickImgUrl.indexOf("mx_ool/_.gif"))&&(logStringMessage("####--SubmitButton: POSSIBLE login/submit, store in pPossibleSubmit\n nElemIx:"+B),h=Y)}}}if(H)break}_||f||h||!c||C||(logStringMessage("AutoSubmit: no clickable buttons found, use ENTERable field\n"),f=c,n.m_bToEnter=!0)}if(null!=_)logStringMessage("AutoSubmit: return best matching button"),logStringMessage("@@@FOUND. RfFindSubmitButton  pMatchingSubmit. TAG:"+_.tagName+" Text:"+_.textContent+" Href:"+_.href+" sourceIndex="+_.sourceIndex+" NAME="+_.getAttribute("name")),n.m_pClickButton=_,n.m_enMatchLevel=EnButtonMatchLevel.enMatchingSubmit,RfComputeNodePosition(Z=new RfPosition,_)&&(n.m_pClickButton.m_nXrel=Z.m_x,n.m_pClickButton.m_nYrel=Z.m_y);else if(null!=f){p?logStringMessage("AutoSubmit: more than one definite submit button, use the 1st button"):logStringMessage("AutoSubmit: return the only definite submit button"),logStringMessage("@@@FOUND. RfFindSubmitButton  pDefiniteSubmit != null. TAG="+f.tagName+" Text="+f.textContent+" Href:"+f.href+"  sourceIndex="+f.sourceIndex),n.m_pClickButton=f,n.m_enMatchLevel=EnButtonMatchLevel.enDefiniteSubmit,RfComputeNodePosition(Z=new RfPosition,f)&&(n.m_pClickButton.m_nXrel=Z.m_x,n.m_pClickButton.m_nYrel=Z.m_y)}else if(null!=h){var Z;logStringMessage("  AutoSubmit3: using pPossibleSubmit button"),logStringMessage("@@@FOUND. RfFindSubmitButton pPossibleSubmit != null. TAG:"+h.tagName+" Text:"+h.textContent+" Href:"+h.href+"\nsourceIndex="+h.sourceIndex),n.m_pClickButton=h,n.m_enMatchLevel=EnButtonMatchLevel.enPossibleSubmit,RfComputeNodePosition(Z=new RfPosition,h)&&(n.m_pClickButton.m_nXrel=Z.m_x,n.m_pClickButton.m_nYrel=Z.m_y)}else if(i.length>1)return logStringMessage("RfFindSubmitButton @@@filled_forms.length > 1"),n.m_pSubmitForm=null,n.m_nSubmitButtonsFound=2,void(n.m_enResult=EnResultCode.enFilledTwoOrMoreForms);n.m_pClickButton||n.m_pSubmitForm?n.m_nSubmitButtonsFound=1:(n.m_nSubmitButtonsFound=0,n.m_enResult=EnResultCode.enFoundNoButtons)}catch(e){logStringMessage("ERROR IN RfFindSubmitButton: "+e)}}function RfNormalizeButtonCaption(e){if(!e||""==e)return"";return e=(e=(e=(e=(e=e.toLowerCase()).replace(new RegExp("[-_:]+","g"),"")).replace(new RegExp(reCharSpace.source,"g"),"")).trim()).substr(0,1e3)}function RfNormalizeImgUrl(e){var t=e.sValue,i=e.bAggressive;logStringMessage("    RfNormalizeImgUrl:"+t);var n=t.indexOf("://");return n>=0&&(t=t.substr(n+3)),(n=t.indexOf("/"))>=0&&(t=t.substr(n+1)),t=t.toLowerCase(),i&&((n=t.lastIndexOf("/"))>=0&&(t=t.substr(n+1)),t=(t=t.replace(new RegExp("[-_]+","g"),"")).replace(new RegExp(reCharSpace.source,"g"),"")),logStringMessage("-> "+t),t}function RfClickSubmitButton(e,t){try{if(!t.m_bToEnter&&t.m_pClickButton){if(logStringMessage("RFCLICKSUBMITBUTTON! Tag:"+t.m_pClickButton.tagName+"\npDoc.URL='"+e.URL+"'\nText: "+t.m_pClickButton.textContent+" Value:"+t.m_pClickButton.value+" sourceIndex:"+t.m_pClickButton.sourceIndex+"\nHREF:"+t.m_pClickButton.href+"\nName:"+t.m_pClickButton.name+"\nOffsetLeft:"+t.m_pClickButton.m_nXrel+"  OffsetTop:"+t.m_pClickButton.m_nYrel),e.URL.startsWith("https://www.emigrantdirect.com/"))return;if(-1!=e.URL.indexOf("partnerdirect.dell.com/sites/channel/"))return e.URL.endsWith("pp_default.aspx")&&"input"==t.m_pClickButton.tagName.toLowerCase()?void RfSendMouseEvent("click",t.m_pClickButton,e):void 0;try{RfSendMouseEvent("mouseover",t.m_pClickButton,e)}catch(e){}return RfSendMouseEvent("mousedown",t.m_pClickButton,e),RfSendMouseEvent("mouseup",t.m_pClickButton,e),e.URL.startsWith("https://www.meebo.com/")?void logStringMessage("RFCLICKSUBMITBUTTON!  Emulate MouseDown and MouseUp for meebo.com"):e.URL.startsWith("https://www.directv.com")&&(g_ischrome||g_isopera||g_isedge)?(RfSendMouseEvent("click",t.m_pClickButton.previousElementSibling.previousElementSibling,e),void logStringMessage("RFCLICKSUBMITBUTTON!  previousElementSibling2 CLICK  DIRECT_TV")):void RfSendMouseEvent("click",t.m_pClickButton,e)}if(t.m_bToEnter&&t.m_pClickButton){logStringMessage("RFCLICKSUBMITBUTTON! press ENTER in the text field. m_bToEnter=TRUE, Enter Element="+t.m_pClickButton);var i=t.m_pClickButton;try{i.focus()}catch(e){}try{var n=e.createEvent("KeyboardEvent"),r="undefined"!=typeof window?window:e.defaultView;n.initKeyEvent?(g_isfirefox&&"undefined"!=typeof unsafeWindow&&(r=unsafeWindow),n.initKeyEvent("keypress",!0,!0,r,!1,!1,!1,!1,13,0),i.dispatchEvent(n),logStringMessage("FIREFOX -> Dispatch initKeyEvent 13...")):i.form?logStringMessage("RfClickSubmitButton 2.1 pElem2.form.submit:"+i):t.m_pSubmitForm&&logStringMessage("RfClickSubmitButton 2.2 m_pSubmitForm:"+t.m_pSubmitForm)}catch(e){logStringMessage("ERROR IN  Enter-RfClickSubmitButton: "+e,!1)}}else t.m_pSubmitForm&&logStringMessage("RfClickSubmitButton  FORM 3! Tag:"+t.m_pSubmitForm.tagName+" Text: "+t.m_pSubmitForm.textContent)}catch(e){logStringMessage("ERROR IN RfClickSubmitButton: "+e)}}function RfIsElementClickable(e,t,i){try{var n=new CRfHtmlObjectProperties,r=RfIsElemVisible(e,n);return i.m_sTagName=n.sTagName,i.m_sName=n.sName,i.m_sType=n.sType,t.bInvisibleButCanChange=n.bInvisibleButCanChange,r||t.bChangeableInvisibleMeansVisible&&t.bInvisibleButCanChange?t.bCheckClickable&&RfIsButtonClickable(e,t.bForceAutoSave,i,t.bRightMouseButtonClick)?(logStringMessage("RfIsElementClickable return **1** for "+e+" Visible:"+r),1):t.bCheckEnterable&&RfIsFieldENTERable(e,i)?(logStringMessage("RfIsElementClickable return 2 for "+e),2):0:0}catch(e){logStringMessage("ERROR in RfIsElementClickable: "+e)}}function RfIsFieldENTERable(e,t){try{if("input"==t.m_sTagName&&"text"==t.m_sType)logStringMessage("    found INPUT type=TEXT\n"),t.m_sClickText="-text-";else{if("input"!=t.m_sTagName||"password"!=t.m_sType)return!1;logStringMessage("    found INPUT type=PASSWORD\n"),t.m_sClickText="-password-"}var i=new RfPosition;return!!RfComputeNodePosition(i,e)&&(t.m_nXrel=i.m_x,t.m_nYrel=i.m_y,!0)}catch(e){logStringMessage("ERROR in RfIsFieldENTERable: "+e)}}function findPosElement(e){try{for(var t=0,i=0;e;){i+=e.offsetLeft-e.scrollLeft,t+=e.offsetTop-e.scrollTop;for(var n=e.offsetParent,r=e.parentNode;r&&r!=n;r=r.parentNode)r.scrollLeft>=0&&(i-=r.scrollLeft),r.scrollTop>=0&&(t-=r.scrollTop);e=n}return{curtop:t,curleft:i}}catch(e){return logStringMessage("ERROR on findPosElement: "+e),{curtop:0,curleft:0}}}function RfComputeNodePosition(e,t){try{if(!t)return logStringMessage("++++RfComputeNodePosition  CANNOT GET ELEMENT:"+t),!1;var i=findPosElement(t);return i?(logStringMessage("++++RfComputeNodePosition  X:"+i.curleft+" Y:"+i.curtop+" ELEMENT:"+t+" obj:"+i),e.m_y=i.curtop,e.m_x=i.curleft,!0):(logStringMessage("++++findPosElement  CANNOT GET COORDINATES"),!1)}catch(e){logStringMessage("ERROR in RfComputeNodePosition: "+e)}}function RfIsEventSetForElement(e,t){try{if("data-dojo-attach-event"==t&&e.getAttribute(t)){var i=e.getAttribute(t);if(i&&-1!=i.indexOf("onClick"))return logStringMessage("RfIsEventSetForElement -> FOUND OnClick for '"+t+"'  ATTRIBUTE for element:"+e),!0}var n="on"+t;return e.getAttribute(n)?(logStringMessage("RfIsEventSetForElement -> FOUND '"+n+"'  ATTRIBUTE for element:"+e),!0):!!e[n]&&(logStringMessage("RfIsEventSetForElement -> FOUND '"+n+"'  EVENT_LISTENER for element:"+e),!0)}catch(e){return logStringMessage("ERROR in RfIsEventSetForElement: "+e),!1}}function RfIsButtonClickable(e,t,i,n){try{if(logStringMessage("RfIsButtonClickable. 1 m_sTagName:'"+i.m_sTagName+"' m_sType:'"+i.m_sType+"'  sourceIndex:'"+e.sourceIndex+"' class:'"+e.getAttribute("class")+"'"),"a"==i.m_sTagName){if(null==e)return!1;i.m_sNavigateUrl=e.href.toLowerCase();var r=!1;if(""!=i.m_sNavigateUrl&&"http"!=i.m_sNavigateUrl.substr(0,4)&&"file"!=i.m_sNavigateUrl.substr(0,4)?logStringMessage("RfIsButtonClickable Element 'A'.  Found: HREF with non-link protocol. SourceIndex="+e.sourceIndex):!n&&RfIsEventSetForElement(e,"click")?logStringMessage("     RfIsButtonClickable    found: HREF with onclick"):RfIsEventSetForElement(e,"mouseup")?logStringMessage("     RfIsButtonClickable    found: HREF with onmouseup"):RfIsEventSetForElement(e,"mousedown")?logStringMessage("     RfIsButtonClickable    found: HREF with onmousedown"):(g_ischrome||g_isopera)&&IsKnownForEventHandlers(e)?logStringMessage("     RfIsButtonClickable    found: events hidden for the Chrome plugin"):r=!0,i.m_bDefiniteSubmit=!1,F=RfNormalizeButtonCaption(F=e.textContent),i.m_sClickText=F,""==i.m_sClickText){var s=e.title;s=RfNormalizeButtonCaption(s),logStringMessage("    anchor title='"+s+"'"),i.m_sClickText=s}logStringMessage("    anchor text='"+F+"' href='"+i.m_sNavigateUrl+"'");var a=null,o=null;if(o=e.all&&(a=e.all).tags?a.tags("img"):e.getElementsByTagName("img")){for(var l="",m=o.length,_=0;_<m;_++){if(c=o[_]){var d=c.alt;""!=l&&(l+="|"),l+=RfNormalizeButtonCaption(d),l+=d,(C=c.src)&&""!=C&&(""!=i.m_sClickImgUrl&&(i.m_sClickImgUrl+="|"),C=RfNormalizeImgUrl({sValue:C,bAggressive:!1}),i.m_sClickImgUrl+=C,logStringMessage(" element images sImageAlts_0='"+l+"'"))}}logStringMessage(" element images button_info.m_sClickText='"+i.m_sClickText+"'"),""==i.m_sClickText&&(logStringMessage(" element images sImageAlts_1='"+l+"'"),i.m_sClickText=l),logStringMessage("    IMG txt='"+i.m_sClickText+"' src='"+i.m_sClickImgUrl)}if(""==i.m_sClickText){var u=e.getAttribute("class");u&&(i.m_sClickText=u.toLowerCase())}if((r||"a"==i.m_sTagName&&i.m_sNavigateUrl.indexOf("facebook.com")>0)&&!RfIsActionButtonCaption(i.m_sClickText)&&!t)return!1;i.m_bNavOnlyLink=r}else if("input"==i.m_sTagName)if("image"==i.m_sType){i.m_bDefiniteSubmit=!1;var f=e.getAttribute("alt");f=RfNormalizeButtonCaption(f),i.m_sClickText=f;var p=RfNormalizeImgUrl({sValue:p=e.src,bAggressive:!1});i.m_sClickImgUrl=p,logStringMessage("found INPUT type=IMAGE! button_info:"+i+"\nsourceIndex:"+e.sourceIndex)}else{if("submit"!=i.m_sType&&"button"!=i.m_sType)return"hidden"==i.m_sType||"text"==i.m_sType||i.m_sType,!1;i.m_bDefiniteSubmit=!0;var h=e.value;h=RfNormalizeButtonCaption(h),i.m_sClickText=h,""!=e.className&&e.className.toLowerCase()==RF_CLOSE_BUTTON_ID&&(i.m_bDefiniteSubmit=!1),logStringMessage("RfIsButtonClickable found SUBMIT! pElem.Tag:"+e.tagName+" button_info.m_sTagName: "+i.m_sTagName+" \nm_sType:"+i.m_sType+"\nsourceIndex:"+e.sourceIndex+"\nbutton_info.m_sClickText:"+i.m_sClickText)}else if("button"==i.m_sTagName){i.m_bDefiniteSubmit=!1;var g=e.textContent;g=RfNormalizeButtonCaption(g),i.m_sClickText=g,"submit"==i.m_sType&&(i.m_bDefiniteSubmit=!0),logStringMessage("found tag BUTTON: m_sClickText: "+i.m_sClickText+" m_bDefiniteSubmit:"+i.m_bDefiniteSubmit+"\nsourceIndex:"+e.sourceIndex)}else if("area"==i.m_sTagName){i.m_bDefiniteSubmit=!1;if(!e)return!1;d=RfNormalizeButtonCaption(d=e.alt),i.m_sClickText=d}else if("img"==i.m_sTagName){if(RfIsEventSetForElement(e,"click"))logStringMessage("    found: IMG with onclick\n");else if(RfIsEventSetForElement(e,"mouseup"))logStringMessage("    found: IMG with onmouseup\n");else{if(!RfIsEventSetForElement(e,"mousedown"))return!1;logStringMessage("    found: IMG with onmousedown\n")}var c;if(i.m_bDefiniteSubmit=!1,!(c=e))return!1;d=RfNormalizeButtonCaption(d=c.alt),i.m_sClickText=d;var C;p=C=c.src;i.m_sClickImgUrl=p}else{if("div"!=i.m_sTagName&&"span"!=i.m_sTagName&&"tr"!=i.m_sTagName&&"td"!=i.m_sTagName&&"table"!=i.m_sTagName&&"m"!=i.m_sTagName)return!1;var F;if(RfIsEventSetForElement(e,"click")){if((b=e.getAttribute("class"))&&(b.toLowerCase().indexOf("tabcontrol")>=0||b.toLowerCase().indexOf("fedsearch")>=0))return logStringMessage("    found: DIV with onclick, but mostlikely TabControl->exit..."),!1;var S=e.getAttribute("id");if(S&&S.toLowerCase().indexOf("parametricfilters")>=0)return logStringMessage("    found: DIV with onclick, but this is filters table->exit..."),!1;logStringMessage("    found: ELEM with onclick\n")}else if(RfIsEventSetForElement(e,"mouseup"))logStringMessage("    found: ELEM with onmouseup\n");else if(RfIsEventSetForElement(e,"mousedown")){var b;if((b=e.getAttribute("class"))&&b.toLowerCase().indexOf("yui-simple-dialog")>=0)return logStringMessage("    found: DIV with mousedown, but mostlikely yui-dialog->exit..."),!1;logStringMessage("    found: ELEM with onmousedown\n")}else if(RfIsEventSetForElement(e,"data-dojo-attach-event"))logStringMessage("    found: ELEM with DOJO toolkit onclick\n");else{if(!e.getAttribute("role")||"button"!=e.getAttribute("role"))return!1;logStringMessage("    found: ELEM with button role\n")}i.m_bDefiniteSubmit=!1,F=RfNormalizeButtonCaption(F=e.textContent),i.m_sClickText=F,logStringMessage("  found ELEM with JS: txt='"+i.m_sClickText+"'")}var R=new RfPosition;return RfComputeNodePosition(R,e)?(i.m_nXrel=R.m_x,i.m_nYrel=R.m_y,!0):(logStringMessage("RfIsButtonClickable RfComputeNodePosition return false!"),!1)}catch(e){return logStringMessage("RfIsButtonClickable: "+e),!1}}function IsKnownForEventHandlers(e){var t=e.getAttribute("href"),i=e.host,n=e.getAttribute("class");return i.indexOf("medcohealth.com")>=0&&"#"==t&&"gologin"==n}function rf_countPasswords(e){try{var t=e.getElementsByTagName("input");if(0==t.length)return logStringMessage("1 rf_countPasswords = 0"),0;for(var i=0;i<t.length;i++){var n=t[i];if(n&&"input"==n.tagName.toLowerCase()&&"password"==n.type.toLowerCase())return 1}return logStringMessage("2 rf_countPasswords = 0"),0}catch(e){logStringMessage("rf_countPasswords: "+e)}}function RfCheckForChangedValues(e,t,i,n){try{var r=!1;return e||(e=""),e.length||t.length?e.length?e.toLowerCase()!=i.toLowerCase()&&i.length&&-1==e.indexOf(i)&&(logStringMessage("bsTitleValue != bsValue. SubmitButton: found first changed text field! \nbsTitleValue: "+e+"\nbsValue:"+i+"\nnElemIx:"+n+"\nbsDefValue:"+t),r=!0):t.length&&t.toLowerCase()!=i.toLowerCase()&&(logStringMessage("bsDefValue != bsValue. SubmitButton: found first changed text field! bsTitleValue: "+e+" bsValue:"+i+"\nnElemIx:"+n+"\nbsDefValue:"+t),r=!0):e.length||t.length||i.length&&(logStringMessage("RfCheckForChangedValues. Found CHANGED text field! NEW_Value:"+i+"  nElemIx:"+n),r=!0),r}catch(e){return logStringMessage("RfCheckForChangedValues: "+e),!1}}function RfIsActionButtonCaption(e){try{return e&&""!=e?"go"==(e=e.toLowerCase())||"go!"==e||"next"==e||"ok"==e||"los"==e||(-1!=e.indexOf("access")||-1!=e.indexOf("acceso")||-1!=e.indexOf("aceptar")||-1!=e.indexOf("anmelden")&&-1==e.indexOf("neu")||-1!=e.indexOf("buttonok")||-1!=e.indexOf("connexion")||-1!=e.indexOf("connectez")||-1!=e.indexOf("continue")||-1!=e.indexOf("einloggen")||-1!=e.indexOf("enter")||-1!=e.indexOf("entra")||-1!=e.indexOf("enviar")||-1!=e.indexOf("gobutton")||-1!=e.indexOf("gobeige")||-1!=e.indexOf("inloggen")||-1!=e.indexOf("jatka")||-1!=e.indexOf("logginn")||-1!=e.indexOf("login")||-1!=e.indexOf("log in")||-1!=e.indexOf("log inn")||-1!=e.indexOf("logon")||-1!=e.indexOf("logpa")||-1!=e.indexOf("nybruger")||-1!=e.indexOf("send")||-1!=e.indexOf("signin")||-1!=e.indexOf("sign in")||-1!=e.indexOf("signon")||-1!=e.indexOf("summary")||-1!=e.indexOf("submit")||-1!=e.indexOf("validate")||-1!=e.indexOf("valider")||-1!=e.indexOf("verwerk")||-1!=e.indexOf("weiter")||-1!=e.indexOf("zaloguj")||-1!=e.indexOf("zugang")||-1!=e.indexOf("verzenden"))&&-1==e.indexOf("1sttime")&&-1==e.indexOf("agree")&&-1==e.indexOf("auto")&&-1==e.indexOf("ameritrade")&&-1==e.indexOf("clear")&&-1==e.indexOf("cookie")&&-1==e.indexOf("favorit")&&-1==e.indexOf("firsttime")&&-1==e.indexOf("forget")&&-1==e.indexOf("forgot")&&-1==e.indexOf("lookup")&&-1==e.indexOf("help")&&-1==e.indexOf("mailto")&&-1==e.indexOf("name")&&-1==e.indexOf("personali")&&-1==e.indexOf("problem")&&-1==e.indexOf("rebate")&&-1==e.indexOf("reset")&&-1==e.indexOf("speed")&&-1==e.indexOf("where")&&-1==e.indexOf("when")&&-1==e.indexOf("zip")?1:-1!=e.indexOf("autologin")||-1!=e.indexOf("cancel")||-1!=e.indexOf("clear")||-1!=e.indexOf("demo")||-1!=e.indexOf("exit")||-1!=e.indexOf("forget")||-1!=e.indexOf("forgot")||-1!=e.indexOf("hint")||-1!=e.indexOf("home")||-1!=e.indexOf("mailto")||-1!=e.indexOf("neuanmeld")||-1!=e.indexOf("nuevo")||-1!=e.indexOf("olvidaste")||-1!=e.indexOf("recordar ")||-1!=e.indexOf("remember")||-1!=e.indexOf("remind")||-1!=e.indexOf("reset")||-1!=e.indexOf("unmask")?-1:0:0}catch(e){logStringMessage("RfIsActionButtonCaption error."+e)}}function CFrameSet(){this.m_Collected=null,this.m_sCollectedTitle="",this.m_bClicked=!1,this.m_bClickedNavOnlyLink=!1,this.m_sClickedButtonCaption="",this.m_bSearched=!1,this.m_bSaveFormBusy=!1,this.m_sNavigatedURL="",this.m_bMultistepLoginIsActive=!1,this.m_sCurrentFrameSetUrl="",this.m_Frames=null,this.m_bNeedFrameReattach=!1,this.m_nCloseAttempts=0,this.m_bForceSave=!1,this.m_bAutoSave=!1,this.m_bAutoSaveHasBeenCanceled=!1,this.m_Id=Math.floor(10001*Math.random()),this.lSortedMatches=[]}CFrameSet.prototype.AddFrame=function(e,t){try{if(e){var i=new CFrameData(this);return this.m_Frames||(this.m_Frames=[]),this.m_Frames.Add(e,i),t.pFrame=i,!0}return!1}catch(e){return logStringMessage("Error in filler.js  CFrameSet::AddFrame "+e.message),!1}},CFrameSet.prototype.CanFillFromPasscard=function(){try{for(var e=0;e<this.m_Frames.length;++e){var t=this.m_Frames[e];if(t.m_nTextFields>=2&&1==t.m_nPasswordFields)return!0}return!1}catch(e){return logStringMessage("Error in filler.js CFrameSet::CanFillFromPasscard "+e.message),!1}},CFrameSet.prototype.GetTopPasscard=function(e){if("undefined"!=typeof Roboform){var t=this.GetMatchingPasscards();return e.nPasscardCount=t.m_list.length,t.m_list.length>0?t.m_list[0]:new Roboform.PasscardMatch}},CFrameSet.prototype.GetMatchingPasscards=function(e,t){if("undefined"!=typeof Roboform){e=e||new Roboform.PasscardMatchList;try{null==t&&(t=!0),e.m_list.length=0;var i=this.m_Frames.Get(top);i&&i.m_sURL&&(e=Roboform.settings.GetMatchingPasscards(i.m_sURL,e,i.m_bMain,t))}catch(e){logStringMessage("ERROR in filler.js CFrameSet::GetMatchingPasscards "+e.message)}return e}},CFrameSet.prototype.ResetLists=function(){this.lSortedMatches=[]};var VK_SHIFT=16,VK_CONTROL=17,VK_MENU=18,VK_TAB=9,VK_RETURN=13;function CFrameData(e){this.m_pFrameSet=new CFrameSet,this.formsArray=[],this.m_nTextFields=0,this.m_nPasswordFields=0,this.submittedForm=null,this.submitElement=null,this.m_bMain=!1,this.m_xHTMLInputTextElementHolder=null,this.m_bIsHTMLDocument=!1,this.m_bDisabled=!1,this.m_bInvisible=!1,this.m_bURLWasRestored=!1,this.m_sURL="",this.m_xHTMLWindowHolder=null,this.m_xHTMLDocumentHolder=null,this.m_xHTMLMapEventSink=null,this.m_FrameTimer=null,this.m_tNavigated=0,this.m_bNavigateUpdateProcessed=!1,this.m_status=rfjs_PageStatus.RfPageInitial,this.m_HighestRequestedStatus=rfjs_PageStatus.RfPageInitial,this.m_bFilling=!1,this.m_nVisibleFillableFields=-1,this.m_bFillable=!1,this.m_frc=FillRetCode.FillCodeUndefined,this.m_bAlreadyFilled=!1,this.m_nTreeSize=-1,this.m_dwTreeChanged=0,this.doc=e,null==this.doc&&(this.doc=document),this.isfakeSubmit=!1,this.isfakeOnSubmit=!1,this.sendSaveEvent=!1,this.canSubmitForm=!1,this.SubmitOccur=!1,this.submitEventOccur=!1}function RfGetPageStatus(e){return e?rfjs_PageStatus.RfPageComplete:(logStringMessage(" PageStatus: No Document\n"),rfjs_PageStatus.RfPageInitial)}function rf_getFormForElement(e,t){try{if(e.form)return e.form;for(var i=e;i;){if(!(i=i.parentElement))return null;if(i.tagName&&i.tagName.toLowerCase()==t)return i}return null}catch(e){return logStringMessage("rf_getFormForElement error: "+e),null}}function RfSavePasscardFromForm(e,t,i,n,r){try{if(logStringMessage(" RfSavePasscardFromForm >>>"),0==e.length)return logStringMessage("RfSavePasscardFromForm: no forms\n"),!1;for(var s=e.length,a=0;a<s;a++)if(i||t<0||t==a){var o=e[a];if(!o){logStringMessage("!!!RfSavePasscardFromForm: cannot get form\n");continue}var l=new CRfHtmlInputIterator;if(!l.BuildForm(o)){logStringMessage("!!!RfSavePasscardFromForm: build collection error\n");continue}var m=l.GetSizeofArray();logStringMessage("itemsCount in the Form:"+m);for(var _=0;_<m;_++){var d=l.GetNext();if(!d)break;RfSaveInputField(d,t<0||t==a,r,o,n)}}return logStringMessage("---RfSavePasscardFromForm: OK\n"),!0}catch(e){return logStringMessage("RfSavePasscardFromForm error: "+e),!1}}function RfSavePasscardFromDoc(e,t){var i=new CRfHtmlInputIterator;i.Build2(e);for(var n=i.GetSizeofArray(),r=0;r<n;r++){var s=i.GetNext();if(!s)break;RfSaveInputField(s,!0,e,null,t)}}function RfSaveInputField(e,t,i,n,r){try{var s=i.URL;logStringMessage("RfSaveInputField  >> ");var a={sTagName:"",sName:"",sType:"",sValue:"",sId:"",bInvisibleButCanChange:!1};if(!RfIsElemVisible(e,a)&&!a.bInvisibleButCanChange)return!1;if("input"==a.sTagName)if(logStringMessage("RfSaveInputField  INPUT!"),"text"==a.sType||"password"==a.sType){var o="",l=!0;if(t){if(o=c=e.value,c.length){var m=e.defaultValue;r.m_nNonemptyTextFields++;var _=!1;s&&(_=s.indexOf("instagram.com")>=0||s.indexOf("wordpress.com/log-in")>=0||s.indexOf("netflix.com/")>=0||s.indexOf("rxnt.com/RxNTDashboard")>=0||s.indexOf("healthcare.gov/login")>=0||s.indexOf("sso.godaddy.com")>=0),_||(_=RfCheckForChangedValues(e.title,e.defaultValue,e.value,0)),_&&(r.m_nChangedTextFields++,l=!1),"password"==a.sType&&(r.m_nNonemptyPasswordFields++,1==r.m_nNonemptyTextFields&&(r.m_bFirstPasswordField=!0))}"password"==a.sType&&r.m_nPasswordFields++}else o=RF_DEFAULT_VALUE_HERE;if(IsMangledID(o)){var d=!1,u=!1;if(s&&(s.indexOf("fidelity.com")>=0||s.indexOf("kovrik.com")>=0)&&(d=!0),s&&(s.indexOf("citi.com")>=0||s.indexOf("citicards.com")>=0||s.indexOf("citibank.com")>=0)&&(u=!0),d){if(logStringMessage("RfSaveInputField   bFidelity!"),n)if((f=n.elements.SSN)||(f=n.elements.ssn),f)o=c=f.value}else if(u){var f;if(logStringMessage("RfSaveInputField   bCiti!"),n)if((f=n.elements.ID)||(f=n.elements.id),f)o=c=f.getAttribute("data-value"),logStringMessage("RfSaveInputField: picked up citi.com value: '"+o+"'")}}if(s.startsWith("https://accounts.google.com")){if("text"==a.sType&&"identifier"==a.sName){a.sId="";var p=i.getElementById("profileIdentifier");p&&p.textContent&&(o=p.textContent)}"password"==a.sType&&"hiddenpassword"==a.sName&&(a.sName="password"),logStringMessage("_DoWorkaroundForSite >> *GOOGLE* url='"+s+"'")}s.startsWith("https://login.live.com")&&("text"==a.sType&&"loginfmt"==a.sName&&(a.sId=""),"password"==a.sType&&"passwd"==a.sName&&(a.sId=""),logStringMessage("_DoWorkaroundForSite >> *MS* url='"+s+"'")),r.AddField7(a.sName,"",a.sId,"",o,"password"==a.sType?RfFieldType.RfFieldPassword:RfFieldType.RfFieldText,l)}else if("checkbox"==a.sType){o="",l=!0;if(t){var h=e.defaultChecked;o=(g=e.checked)?"*":"0",h!=g&&(l=!1)}else o=RF_DEFAULT_VALUE_HERE;r.AddField7(a.sName,"",a.sId,"",o,RfFieldType.RfFieldCheckbox,l)}else{if("radio"!=a.sType)return!1;var g,c=e.value,C=(l=(h=e.defaultChecked)==(g=e.checked),a.sName+":"+c),F="";t?g&&(F="*"):F=RF_DEFAULT_VALUE_HERE,r.AddField7(C,"",a.sId,"",F,RfFieldType.RfFieldRadioCheck,l)}else if("textarea"==a.sTagName){o="",l=!0;if(t){m=e.defaultValue;(o=e.value)&&o.length&&r.m_nNonemptyTextFields++,o!=m&&(l=!1)}else o=RF_DEFAULT_VALUE_HERE;r.AddField7(a.sName,"",a.sId,"",o,RfFieldType.RfFieldTextArea,l)}else if("select"==a.sTagName){o="",l=!0;if(t)if(e.multiple){for(var S=e.length,b=0;b<S;b++){if(E=e.options[b]){var R=E.defaultSelected,T=E.selected;if(l=l&&T==R,T)o+=E.text,o+="\r\n"}}o&&o.length>2&&10==o.charCodeAt(o.length-1)&&13==o.charCodeAt(o.length-2)&&(o=o.substr(0,o.length-2))}else{var N=e.selectedIndex;if(N>=0){o=c=(E=e.options[N]).text;var y=!1,I=!1;for(S=e.length,b=0;b<S;b++){var E;if((R=(E=e.options[b]).defaultSelected)&&(I=!0,b==N)){y=!0;break}}I||(y=0==N),y||(l=!1)}}else o=RF_DEFAULT_VALUE_HERE;r.AddField7(a.sName,"",a.sId,"",o,RfFieldType.RfFieldSelect,l)}return!0}catch(e){return logStringMessage("RfSaveInputField ERROR: "+e),!1}}function IsMangledID(e){if(logStringMessage("IsMangledID >> sUserID='"+e+"'"),!e||""==e)return logStringMessage("IsMangledID sUserID='' return false"),!1;var t="",i=e.length,n=i-3;if(n<0)return logStringMessage("IsMangledID CmpLen < 0 return false"),!1;for(var r=0;r<n;r++)t+="*";if(n>0&&e.substr(0,n)==t)return logStringMessage("IsMangledID CmpLen > 0 return true case 1"),!0;for(r=n,n=i-(i<=6?1:2);r<n;r++)t+="*";return t=t.substring(0,0)+e[0]+t.substring(1),i>6&&(t=t.substring(0,1)+e[1]+t.substring(2)),n>0&&e.substr(0,n)==t&&(logStringMessage("IsMangledID CmpLen > 0 return true case 2"),!0)}function RfGetCaptionOfClickableElement(e){try{var t=e.pElem,i=e.sTagName,n=e.sType;e.sCaption;if("a"==i){var r=t.innerText||t.textContent||"";if(e.sCaption=r,""==e.sCaption){var s=t.title;e.sCaption=s}if(logStringMessage("    A caption="+e.sCaption),""==e.sCaption){var a=null,o=null;if(o=t.all&&(a=t.all).tags?a.tags("img"):t.getElementsByTagName("img")){for(var l="",m=o.length,_=0;_<m;_++){var d=o[_];if(d){var u=d.alt;""!=l&&(l+="|"),l+=u}}e.sCaption=l,logStringMessage(" RfGetCaptionOfClickableElement   A caption2 ='"+e.sCaption+"'")}}}else if("input"==i&&"image"==n){(u=t.alt)&&(e.sCaption=u),logStringMessage("    INPUT IMAGE caption="+e.sCaption)}else if("input"!=i||"submit"!=n&&"button"!=n)if("button"==i){(f=t.innerText)&&(e.sCaption=f),logStringMessage("    BUTTON caption="+e.sCaption)}else if("area"==i){(u=t.alt||"")&&(e.sCaption=u),logStringMessage("    AREA caption="+e.sCaption)}else if("img"==i){(u=t.alt||"")&&(e.sCaption=u),logStringMessage("    IMG caption="+e.sCaption)}else{if("div"!=i&&"span"!=i&&"tr"!=i&&"td"!=i&&"table"!=i)return!1;(r=t.innerText)&&(e.sCaption=r),logStringMessage("    "+i+" caption="+e.sCaption)}else{var f;(f=t.value)&&(e.sCaption=f),logStringMessage("    INPUT "+n+" caption="+e.sCaption)}return!0}catch(e){return logStringMessage("RfGetCaptionOfClickableElement ERROR: "+e),!1}}function RfCanClickedElemCauseSubmit(e,t,i,n){try{for(var r=e;r;){var s={bCheckClickable:!0,bCheckEnterable:!1};if(s.bForceAutoSave=t,s.bInvisibleButCanChange=!1,s.bChangeableInvisibleMeansVisible=!0,s.bRightMouseButtonClick=n,RfIsElementClickable(r,s,i)){logStringMessage("+YES+: clickable element found pElement tagName:"+r.tagName);var a={pElem:r,sTagName:i.m_sTagName,sType:i.m_sType,sCaption:i.m_sClickCaption};return RfGetCaptionOfClickableElement(a),i.m_sClickCaption=a.sCaption,i.submitElement=r,!0}if("input"==i.m_sTagName&&("text"==i.m_sType||"password"==i.m_sType||"radio"==i.m_sType||"checkbox"==i.m_sType))return!1;if("select"==i.m_sTagName)return!1;if("a"==i.m_sTagName)return!1;if("body"==i.m_sTagName||"html"==i.m_sTagName)return!1;r=r.parentNode}return!0}catch(e){return logStringMessage("RfCanClickedElemCauseSubmit: "+e),!1}}function CRfObjectName(e,t,i,n,r,s){return this.m_sName="",this.m_Type=RfObjectType.RFTYPE_NONE,this.m_Mode=RfObjectMode.RF_OBJ_MODE_DEF,this.m_bProtected=!1,this.m_bRetreiveData=!1,this.m_sPath="",3==arguments.length?(this.m_sName=t,this.m_Type=e,void(this.m_Mode=i)):6==arguments.length?(this.m_sName=t,this.m_Type=e,this.m_Mode=i,this.m_bProtected=n,this.m_bRetreiveData=r,void(this.m_sPath=s)):1==arguments.length?(this.m_sName=null==e.m_sName?"":e.m_sName,this.m_Type=null==e.m_Type?RfObjectType.RFTYPE_NONE:e.m_Type,void(this.m_Mode=null==e.m_Mode?RfObjectMode.RF_OBJ_MODE_DEF:e.m_Mode)):void 0}function S2A(e){for(var t=[],i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}function Utf8ToUtf16(e){return S2A(convertToUnicode(e))}function convertToUnicode(e){for(var t="",i=0,n=0,r=0,s=0;i<e.length;)(n=e.charCodeAt(i))<128?(t+=String.fromCharCode(n),i++):n>191&&n<224?(s=e.charCodeAt(i+1),t+=String.fromCharCode((31&n)<<6|63&s),i+=2):(s=e.charCodeAt(i+1),r=e.charCodeAt(i+2),t+=String.fromCharCode((15&n)<<12|(63&s)<<6|63&r),i+=3);return t}function IsClareitySafeaccess(e){return!!e&&(-1!=e.indexOf("idp.onregional.ca/idp/Authn/UserPassword")||-1!=e.indexOf("idp.miborsecurity.com/idp/Authn/UserPassword")||-1!=e.indexOf("safemls.net/idp/Authn/UserPassword"))}CFrameData.prototype.OnInputKeyDown=function(e){try{if(!rfjs_pFrameSet.m_Frames.Get(top))return}catch(e){logStringMessage("ERROR \nin CFrameData::OnInputKeyDown "+e.message)}},CFrameData.prototype.AttachAll=function(){try{this.m_bIsHTMLDocument=!1;var e="undefined"!=typeof window?window:this.doc.defaultView;if(!e)return!1;var t=e.content.document;if(!t)return logStringMessage("window.location: "+e.location),this.m_sURL=e.location,logStringMessage("AttachAll: got non-HTML frame (NULL doc/window), location: "+this.m_sURL),!0;this.m_sURL=t.URL,logStringMessage("AttachAll: Set URL: "+this.m_sURL),this.m_bIsHTMLDocument=!0;var i=t.defaultView;if(!i)return logStringMessage("!EX FD:GetPW\n CFrameData::get_parentWindow: COREDUMP caught! "+i),this.m_bDisabled=!0,!1;var n=!(!t||!i);return n?(this.m_xHTMLDocumentHolder=t,this.m_xHTMLWindowHolder=i):(logStringMessage("AttachAll: got non-HTML frame (NULL doc/window), disable it\n"),this.m_bDisabled=!0),n}catch(e){return logStringMessage("Error in CFrameData::AttachAll "+e.message),!1}},CFrameData.prototype.Initialize=function(e){this.m_bNavigateUpdateProcessed=!1,this.m_nVisibleFillableFields=this.m_nTextFields=this.m_nPasswordFields=-1,this.m_bAlreadyFilled=!1,this.m_nTreeSize=-1,this.m_dwTreeChanged=0,this.m_HighestRequestedStatus=rfjs_PageStatus.RfPageLoading,this.m_bDisabled=!1},CFrameData.prototype.IsGood=function(e){return null!=e&&null!=e||(e=!0),!0},CFrameData.prototype.GetUrl=function(){return this.m_sURL},CFrameData.prototype.GetFrameSet=function(){return this.m_pFrameSet},CFrameData.prototype.IsFrameGoodForFormFilling=function(e,t){return!0},CFrameData.prototype.ProcessSpecialURL=function(e,t,i,n,r){return!0},CFrameData.prototype.ProcessRfVerURL=function(e,t,i,n){return!0},CFrameData.prototype.AllScriptsAreLoaded=function(e,t){return!0},CFrameData.prototype.GetPageStatus=function(){return RfGetPageStatus(this.m_xHTMLDocumentHolder)},CFrameData.prototype.CollectPasscard=function(e,t,i){try{var n=new CRfClickButtonCoords;return this.DoCollectPasscard(e,t,!1,n,i)}catch(e){return logStringMessage("CFrameData.DoCollectPasscard error: "+e),!1}},CFrameData.prototype.InitiateNavigateUpdate=function(e,t){try{if(logStringMessage("+++ CFrameData.InitiateNavigateUpdate"),this.m_bFilling)return void logStringMessage("---%p NavigateUpdate: Recursive Call\n");var i=this.GetPageStatus();if(t&&(i=rfjs_PageStatus.RfPageComplete),!(i>=rfjs_PageStatus.RfPageInteractive)||this.m_bDisabled||this.m_pFrameSet.m_bAutoSave)return void logStringMessage("   %p NavigateUpdate: skip autofill: page_status= "+i+"  m_bDisabled = "+this.m_bDisabled+" m_bAutoSave = "+this.m_pFrameSet.m_bAutoSave);this.DoNavigateUpdate(i)?logStringMessage("---AutoFill: will retry: should set Timer"):this.m_bNavigateUpdateProcessed=!0}catch(e){return void logStringMessage("CFrameData.InitiateNavigateUpdate error: "+e.message)}},CFrameData.prototype.DoNavigateUpdate=function(e){try{return this.m_bDisabled?(logStringMessage("---%p DoNavigateUpdate: disabled frame"),!1):this.m_pFrameSet?!!this.m_bAlreadyFilled&&(logStringMessage("---%p DoNavigateUpdate: Already filled, get out\n"),this.m_bFillable=!0,!1):(logStringMessage("---%p DoNavigateUpdate: no frameset\n"),!1)}catch(e){return logStringMessage("CFrameData.DoNavigateUpdate error: "+e.message),!1}},CFrameData.prototype.DoCollectPasscard=function(e,t,i,n,r){try{if(logStringMessage("%%DoCollectPasscard entry  bPresskey="+e+" bInstallHandler="+t+" bSimulateClick="+i),i&&!n.m_pClickButton)return logStringMessage("---DoCollectPasscard: simulate click - button pointer is NULL"),!1;var s;i||r;var a=null;if(i)a=n.m_pClickButton,e=n.m_bToEnter,s=VK_RETURN,t=!1;else{if(!(a=r.srcElement?r.srcElement:r.target))return logStringMessage("CollectPasscard: pSource==null"),!1;if("function"==typeof a.getAttribute){var o=a.getAttribute("id");if(o==RF_SAVE_BUTTON_ID||o==RF_PASSCARD_INPUT_ID||o==RF_MP_SAVEBTN_ID||o==RF_MASTERPASS_INPUT_ID||o==RF_MASTERPASSCONFIRM_ID||o==RF_MP_CANCELBTN||o==RF_MP_CHECKBTN_ID||o==RF_MP_CANCELBTN)return!1;if(a.getAttribute("lptype"))return!1}if(e){if(!(s=r.keyCode))return logStringMessage("CollectPasscard: keycode==null"),!1;if(s==VK_MENU||s==VK_SHIFT||s==VK_CONTROL)return logStringMessage("CollectPasscard: CTRL/ALT/SHIFT pressed!"),!1}}if(this.m_pFrameSet.m_bClicked=!1,this.m_pFrameSet.m_bClickedNavOnlyLink=!1,this.m_pFrameSet.m_bForceSave=!1,this.m_pFrameSet.m_bSearched=!1,"undefined"!=typeof Roboform&&Roboform.settings.ClearGoFillGlobal(),t){var l=a.tagName;if(l&&l.length&&"input"==l.toLowerCase())if(s==VK_TAB)r.shiftKey;else this.m_xHTMLInputTextElementHolder=a}var m=new CSubmitFormInfo,_=!1,d=!1;r&&(_=r.altKey,d=r.shiftKey);var u=e?s==VK_RETURN&&d:_;if(this.m_pFrameSet.m_bForceSave=u,this.m_pFrameSet.m_bPressKey=e,e){if(s!=VK_RETURN&&!u)return logStringMessage("CollectPasscard: not ENTER pressed, skip it"),!1;this.submitElement=a;var f={bCheckClickable:!1,bCheckEnterable:!0,bChangeableInvisibleMeansVisible:!0};if(f.bForceAutoSave=u,f.bInvisibleButCanChange=!1,RfIsElementClickable(a,f,m))logStringMessage("CollectPasscard: ENTER pressed in text field\n");else{if(!RfCanClickedElemCauseSubmit(a,u,m,!1)){if(!m.m_bNavOnlyLink)return logStringMessage("CollectPasscard: not ENTERable or clickable field or link\n"),!1;this.m_pFrameSet.m_bClickedNavOnlyLink=!0}logStringMessage("CollectPasscard: not ENTERable object clicked\n")}}else{logStringMessage("DoCollectPasscard: MOUSE CLICK");var p=!1;if(r&&(r.which?p=3==r.which:r.button&&(p=2==r.button)),RfCanClickedElemCauseSubmit(a,u,m,p))logStringMessage("CollectPasscard: submittable object clicked\n"),this.submitElement=m&&m.submitElement,logStringMessage("pSource.submitElement:"+(this.submitElement&&this.submitElement.tagName));else{if(!m.m_bNavOnlyLink)return logStringMessage("CollectPasscard: not a clickable field or link\n"),!1;this.m_pFrameSet.m_bClickedNavOnlyLink=!0,logStringMessage("CollectPasscard: not submittable object clicked\n")}}this.doc.URL;var h=[];logStringMessage("Constructing pAll for browser!"),h=this.doc.getElementsByTagName("*");var g=rf_getFormForElement(a,"form");g?logStringMessage("Form founded! TAG='"+g.tagName+"'"):logStringMessage("Cannot take Form from pSource."),logStringMessage(" pAll.length:"+h.length);for(var c=[],C=0;C<h.length;C++)if(h[C]&&"undefined"!=h[C].tagName&&""!=h[C].tagName)try{"form"==h[C].tagName.toLowerCase()&&c.push(h[C])}catch(e){}c.length||logStringMessage("CollectPasscard: no forms collection\n");var F=c.length,S=new Array(F);logStringMessage("CollectPasscard: nFormsCount:"+F);var b=-1,R=0;for(R=0;R<F;R++)c[R]==g&&(b=R,logStringMessage("CollectPasscard: nLastFormClicked="+b)),S[R]=new CPasscard,RfSavePasscardFromForm(c,R,!1,S[R],this.doc),logStringMessage("Saving elements to form: "+R+" .Passcard fields: "+S[R].m_lFields.length),S[R].m_lFields.length>0&&this.formsArray.push(c[R]);if(b>=0){S[b].SetHasFieldValues();var T=!1;if(b>=0)for(var N=0;N<R;N++){var y=S[N];if(logStringMessage("p_formpasscard.m_nNonemptyPasswordFields: "+y.m_nNonemptyPasswordFields+"  p_formpasscard.m_bFirstPasswordField:"+y.m_bFirstPasswordField+"  p_formpasscard.m_nNonemptyTextFields:"+y.m_nNonemptyTextFields),y.m_nNonemptyPasswordFields>=1&&!y.m_bFirstPasswordField&&y.m_nNonemptyTextFields>=2){logStringMessage("CollectPasscard: HaveCompletePasswordForm: YES\n"),T=!0,this.formsArray.push(c[N]);break}}T||(logStringMessage("CollectPasscard: merge all forms\n"),b=-1)}var I=-1;if(b>=0){for(N=0;N<R;N++){if(N!=b)for(var E=S[N],v=0;v<E.m_lFields.length;v++){for(var M=E.m_lFields[v],A=S[b],x=0;x<A.m_lFields.length;x++){var O=A.m_lFields[x];if(O.m_sName.toLowerCase()==M.m_sName.toLowerCase()){logStringMessage("CollectPasscard: merge all: Field  "+M.m_sName+" in form: "+N+" matches same field:"+O.m_sName+" in form: "+b),I=b,b=-1;break}}if(-1==b)break}if(-1==b)break}var P=new CRfHtmlInputIterator;P.Build2(this.doc);for(var L=P.GetSizeofArray(),k=0;k<L;k++){var D=P.GetNext();if(!D)break;if(g&&4&g.compareDocumentPosition(D))break;var w=new CRfHtmlObjectProperties;if(RfIsElemVisible(D,w)||w.bInvisibleButCanChange){var V=w.sTagName,B=w.sType;if("input"==V&&"password"==B&&D&&!D.form){logStringMessage(" CollectPasscard: merge all: formless password field TAG='"+V+"' and ID='"+w.sId+"' preceed the clicked form"),b=-1,I=-1;break}}}}var G=new CPasscard;if(b>=0?(logStringMessage("CollectPasscard: gathered: form.nLastFormClicked:"+b),G=S[b]):I>=0?(logStringMessage("CollectPasscard: gathered: form "+I+" plus other frames with no values."),RfSavePasscardFromForm(c,I,!0,G,this.doc)):(logStringMessage("CollectPasscard: gathered: all forms\n"),RfSavePasscardFromDoc(this.doc,G)),G.SetButtonToClick(m),!u&&!i){if(0==G.m_nChangedTextFields)return logStringMessage("COLLECT WARNING! CollectPasscard: text fields were not changed by user. Exit from function.\n"),!1;if(0==G.m_nNonemptyPasswordFields)return logStringMessage("COLLECT WARNING! CollectPasscard: NO PASSWORD fields. Exit from function.\n"),!1}G.m_sMatchURL=this.doc.URL,logStringMessage("gatheredPasscard.m_sMatchURL="+G.m_sMatchURL),this.doc.URL||logStringMessage("!!!CollectPasscard: empty URL\n"),this.m_pFrameSet.m_sCollectedTitle=this.doc.title,this.m_pFrameSet.m_bClicked=!0;var U=a.innerText;return this.m_pFrameSet.m_sClickedButtonCaption=U,this.m_pFrameSet.m_Collected=G,this.m_pFrameSet.m_Collected.SetHasFieldValues(),this.submittedForm=g,this.m_pFrameSet.m_bClickedNavOnlyLink&&!u?!1:(u&&(G.m_bForcedSave=!0,G.m_bPressKey=e),logStringMessage("##########################   SAVE  ##########################################"),G)}catch(e){return logStringMessage("CFrameData.DoCollectPasscard error: "+e),!1}},CRfObjectName.prototype.toString=function(){var e=this.m_Type;return this.m_Type==RfObjectType.RFTYPE_IDENTITY?e="IDENTITY":this.m_Type==RfObjectType.RFTYPE_PASSCARD?e="PASSCARD":this.m_Type==RfObjectType.RFTYPE_FOLDER?e="FOLDER":this.m_Type==RfObjectType.RFTYPE_NONE&&(e="NONE"),"NAME: "+this.m_sName+"  TYPE:"+e+"  PROTECTED:"+this.m_bProtected+" bGetData:"+this.m_bRetreiveData+" PATH:"+this.m_sPath+" MODE:"+this.m_Mode},CRfObjectName.prototype.CloneObject=function(){var e=new CRfObjectName;return e.m_sName=this.m_sName,e.m_Type=this.m_Type,e.m_Mode=this.m_Mode,e.m_bProtected=this.m_bProtected,e.m_bRetreiveData=this.m_bRetreiveData,e.m_sPath=this.m_sPath,e},CRfObjectName.prototype.Assign=function(e){this.m_sName=e.m_sName,this.m_Type=e.m_Type,this.m_Mode=e.m_Mode,this.m_bProtected=e.m_bProtected,this.m_bRetreiveData=e.m_bRetreiveData,this.m_sPath=e.m_sPath},CRfObjectName.prototype.ParseFilePathfromXML=function(e){try{this.m_Type=RfObjectType.RFTYPE_NONE,this.m_Mode=RfObjectMode.RF_OBJ_MODE_DEF,this.m_sName="";var t=String(e),i="",n="",r=t.lastIndexOf("\\");r>=0?(i=t.substr(r+1),n=Mid(t,r+1)):n=t;var s=n.lastIndexOf(".");if(s<0)return!1;var a=Mid(n,s,n.length);return n=n.substr(0,s),this.DetectTypeAndMode(n,a)?(this.m_sName=i+n,!0):!1}catch(e){return logStringMessage("ERROR in CRfObjectName::ParseFilePath "+e.toString()),!1}},CRfObjectName.prototype.DetectTypeAndMode=function(e,t){try{var i=t;return 3==(i=i.toLowerCase()).length&&"."!=i[0]&&(i="."+i),".rft"==i?(this.m_Type=RfObjectType.RFTYPE_IDENTITY,this.m_Mode=RfObjectMode.RF_OBJ_MODE_DEF,!0):".rfc"==i?(this.m_Type=RfObjectType.RFTYPE_IDENTITY,this.m_Mode=RfObjectMode.RF_OBJ_MODE_CONTACT,!0):".rfp"==i?(this.m_Type=RfObjectType.RFTYPE_PASSCARD,"-Blocked-"==e.substr(9)||"-Blkd-"==e.substr(6)?this.m_Mode=RfObjectMode.RF_OBJ_MODE_BLOCK_PC_OLD:this.m_Mode=RfObjectMode.RF_OBJ_MODE_DEF,!0):".rfx"==i?(this.m_Type=RfObjectType.RFTYPE_PASSCARD,this.m_Mode=RfObjectMode.RF_OBJ_MODE_BLOCK_PC,!0):".rfb"==i?(this.m_Type=RfObjectType.RFTYPE_PASSCARD,this.m_Mode=RfObjectMode.RF_OBJ_MODE_BOOKMARK,!0):".rfn"==i?(this.m_Type=RfObjectType.RFTYPE_SAFENOTE,this.m_Mode=RfObjectMode.RF_OBJ_MODE_DEF,!0):".rfq"==i&&(this.m_Type=RfObjectType.RFTYPE_PASSCARD,this.m_Mode=RfObjectMode.RF_OBJ_MODE_QUERY,!0)}catch(e){return logStringMessage("ERROR in CRfObjectName::DetectTypeAndMode "+e.toString()),!1}},CRfObjectName.prototype.IsEmpty=function(){return""==this.m_sName},CRfObjectName.prototype.CompareName=function(e,t){var i=(this.m_Mode>>8)-(e.m_Mode>>8);return 0!=i?i:0!=(i=t?this.m_sName==e.m_sName:m_sName.toLowerCase()==e.m_sName.toLowerCase())?i:(255&this.m_Mode)-(255&e.m_Mode)},CRfObjectName.prototype.Compare=function(e){return this.CompareName(e,!1)},CRfObjectName.prototype.Empty=function(){this.m_sName="",this.m_Mode=RfObjectMode.RF_OBJ_MODE_DEF},CRfObjectName.prototype.isEqualToObject=function(e){return this.m_Type==e.m_Type&&(this.m_Mode==e.m_Mode&&e.ConstructNamePathString()==this.ConstructNamePathString())},CRfObjectName.prototype.ConstructNamePathString=function(e,t){try{var i="";i=e&&""!=e?e:this.m_sName;var n="";(n=(n=t&&""!=t?t:this.m_sPath)==RF_ROOT_FOLDER_URL?n:n+RF_ROOT_FOLDER_URL).startsWith("//")&&(n=n.substr(1));var r="";return this.m_Type==RfObjectType.RFTYPE_IDENTITY?r=this.m_Mode==RfObjectMode.RF_OBJ_MODE_DEF?n+i+".rft":n+i+".rfc":this.m_Type==RfObjectType.RFTYPE_PASSCARD?r=this.m_Mode==RfObjectMode.RF_OBJ_MODE_DEF?n+i+".rfp":n+i+".rfb":this.m_Type==RfObjectType.RFTYPE_FOLDER&&(r=n),r}catch(e){return logStringMessage("ERROR in CRfObjectName::ConstructNamePathString "+e.toString()),""}};
//# sourceMappingURL=filler.js.map