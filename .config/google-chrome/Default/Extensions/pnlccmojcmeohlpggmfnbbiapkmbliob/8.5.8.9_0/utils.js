// Copyright (C) 1999-2019 Siber Systems Inc. All Rights Reserved.
var RfapiJS=RfapiJS||{};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=1,n=2,a=3,i=4,s=5,o=6,u=7,l=8,c={enUrlType_Unknown:0,enUrlType_HTTP:1,enUrlType_FTP:2,enUrlType_File:3},h={enUrlSchema_Unknown:0,enUrlSchema_HTTP:1,enUrlSchema_HTTPS:2,enUrlSchema_FTP:3,enUrlSchema_FTPS:4,enUrlSchema_File:5,enUrlSchema_MOZPROXY:6,enUrlSchema_ChromeService:7},f=0,d=3,p=4,g=20,m=21,v={ParseUrl:function(e,t,r){if(e&&"about:blank"!=e.toLowerCase()){var n=0,a=void 0,i=void 0;if((e=e.replace(new RegExp("^mhtml:","i"),"")).length<2||e.search(new RegExp("^/|^[a-z]:","i"))>=0)a=c.enUrlType_File,scheme=h.enUrlSchema_File;else if((n=e.indexOf(":"))>=0){if(!(n+3<=e.length&&"/"==e[n+1]&&"/"==e[n+2]))return;var s=e.substring(0,n);a=function(e){switch(e.toLowerCase()){case"http":case"https":case"moz-proxy":case"chrome":return c.enUrlType_HTTP;case"ftp":case"ftps":return c.enUrlType_FTP;case"file":return c.enUrlType_File;default:return c.enUrlType_Unknown}}(s),i=function(e){switch(e.toLowerCase()){case"http":return h.enUrlSchema_HTTP;case"https":return h.enUrlSchema_HTTPS;case"ftp":return h.enUrlSchema_FTP;case"ftps":return h.enUrlSchema_FTPS;case"file":return h.enUrlSchema_File;case"moz-proxy":return h.enUrlSchema_MOZPROXY;case"chrome":return h.enUrlSchema_ChromeService;default:return h.enUrlSchema_Unknown}}(s),n+=3}else n=0;if(a!=c.enUrlType_HTTP&&a!=c.enUrlType_FTP){var o=e.slice(n);return t&&(o=decodeURI(o)),{type:a,schema:i,object:o}}var u=n;t&&(r?e=decodeURI(e):((n=e.slice(n).search(new RegExp("[;?#]","")))>=0&&(e=decodeURI(e.substr(0,u+n+1))+e.slice(u+n+1)),n=u));var l=void 0,f=void 0,d=e.slice(n).search(new RegExp("[@/;?#]",""));if(d>=0&&"@"==e[n]){var p=e.slice(n,n+d);n=n+d+1;var g=p.search(":");g>=0?(l=p.substr(0,g),f=p.slice(g+1)):l=p}var m=void 0,v=void 0;if((d=e.slice(n).search(new RegExp("[/;?#]")))<0&&(d=e.length),d>=0){sHostPort=e.slice(n,n+d),n+=d;var y=sHostPort.search(":");y>=0?(m=sHostPort.substr(0,y),v=sHostPort.slice(y+1)):m=sHostPort}o=void 0;if(n<e.length&&"/"==e[n]){var S=e.slice(n).search(new RegExp("[;?#]"));S>=0?(o=e.slice(n+1,n+S),n+=d):(o=e.slice(n+1),n=e.length)}var b=void 0;n<e.length&&";"==e[n]&&((d=e.slice(n).search(new RegExp("[?#]")))>=0?(b=e.slice(n+1,n+d),n+=d):(b=e.slice(n+1),n=e.length));var _=void 0;n<e.length&&"?"==e[n]&&((d=e.slice(n).search("#"))>=0?(_=e.slice(n+1,n+d),n+=d):(_=e.slice(n+1),n=e.length));n<e.length&&"#"==e[n]&&(object=e.slice(n+1),n=e.length);var R=w(m=m.toLowerCase())||function(e){if(e.length<2)return!1;if("["==e[0]){if("]"!=e[nLen-1])return!1;e=e.slice(1,nLen-2)}var t=e.match(new RegExp(":","g")),r=t?t.length:0;if(r>7)return!1;for(var n=0;n<r;n++){var a=e.indexOf(":");if(a<0)return!1;if(e.substr(0,a).search(new RegExp("[^0-9a-fA-F]",""))>=0)return!1;e=e.slice(a+1)}return!(e.search(new RegExp("[^0-9a-fA-F]",""))>=0&&!w(e))}(m);return"127.0.0.1"==m&&(m="localhost"),v||a!=c.enUrlType_HTTP&&i!=h.enUrlSchema_Unknown||(v="80"),{type:a,schema:i,username:l,password:f,host:m,isIP:R,port:v,object:o,param:b,query:_,reference:void 0}}function w(e){if(!e)return!1;if(e.search(new RegExp("[^0-9.]",""))>=0)return!1;var t=e.match(new RegExp("\\.","g"));return!(t&&t.length>3)}},GetWin32UrlDomain:function(e){if(!(e.search(new RegExp("^exe://","i"))<0)){for(var t=e.length,r=6;r<t&&" "==e[r];r++);if('"'==e[r]){var n=e.slice(r+1).indexOf('"');if(n<0)return;var a=e.slice(r+1,n-1),i=a.indexOf("/");if(i>=0)var s=a.substr(0,i);else s=a}else{var o=e.slice(r+1).indexOf("/");if(o<0){var u=e.indexOf(" ");if(u<0)s=e.slice(r);else s=e.slice(r,u-1)}else s=e.slice(r,o-1)}s.replace("\\","/");var l=s.lastIndexOf("/");l>=0&&(s=s.slice(l+1));var c=s.lastIndexOf(".");return c>=0&&(s=s.substr(0,c)),s}},DomainFromUrl:function(e,t,r,n,a){if("{Win32Dlg}"==e)return"{Win32Dlg}";if((e=e.toLowerCase()).startsWith("about:")||e.startsWith("javascript:")||e.startsWith("ms-browser-extension://")||e.startsWith("chrome-extension://")||e.startsWith("chrome://")||"http://"===e)return"";if(e.startsWith("exe://"))return t&&r?"exe://"+v.GetWin32UrlDomain(e):v.GetWin32UrlDomain(e);if(!a&&!(a=v.ParseUrl(e,!0,!1)))return"(unparsable)";var i="";i=a.host&&a.schema!=h.enUrlSchema_Unknown?a.host:a.object;var s="";if(a.type==c.enUrlType_File)return t&&r?"file://(file)":"(file)";if(s=a.type==c.enUrlType_FTP?"ftp://":"http://",a.isIP)return t&&r?s+i:i;var o="",u="";(l=i.indexOf("."))>=0&&(i.startsWith("www")||i.startsWith("www2.")||i.startsWith("www3.")||i.startsWith("cgi"))&&(i=i.slice(l+1));var l;if((l=i.lastIndexOf("."))>=0){var f=!1;u="."+(d=i.slice(l+1));var d,p=i.substr(0,l);if(p.length>0){var g=p.lastIndexOf(".");if(g>=0){var m=p.slice(g+1),y={com:["eu","au","br","cn","de","gb","hu","no","ru","sa","se","uk","us","uy","za","amer.csc"],net:["gb","se","uk","nobelbiocare"],org:["eu"],int:["eu"],uk:["ltd","me","plc"],ca:["gc","ab","bc","mb","nb","nf","nl","ns","nt","nu","on","pe","qc","sk","yk"],fr:["tm","asso","nom","prd","presse"],se:["tm","pp","parti","press"],jp:["ad","ed","gr","lg"],tw:["idv","game","ebiz","club"],kr:["pe","re","hs","ms","es","sc","kg","seoul","busan","daegu","incheon","gwangju","daejeon","ulsan","gyeonggi","gangwon","chungbuk","chungnam","jeonbuk","jeonnam","gyeongbuk","gyeongnam","jeju"],ru:["sp","pp","nsc","mhost","caravan","narod","spb","msk","adygeya","bashkiria","ulan-ude","buryatia","dagestan","nalchik","kalmykia","kchr","karelia","ptz","komi","mari-el","joshkar-ola","mari","mordovia","yakutia","vladikavkaz","kazan","tatarstan","tuva","udmurtia","izhevsk","udm","khakassia","grozny","chuvashia","altai","kuban","krasnoyarsk","marine","vladivostok","stavropol","stv","khabarovsk","khv","amur","arkhangelsk","astrakhan","belgorod","bryansk","vladimir","volgograd","tsaritsyn","vologda","voronezh","vrn","cbg","ivanovo","irkutsk","koenig","kaluga","kamchatka","kemerovo","kirov","vyatka","kostroma","kurgan","kursk","lipetsk","magadan","mosreg","murmansk","nnov","nov","nsk","novosibirsk","omsk","orenburg","oryol","penza","perm","pskov","rnd","ryazan","samara","saratov","sakhalin","yuzhno-sakhalinsk","yekaterinburg","e-burg","smolensk","tambov","tver","tomsk","tsk","tom","tula","tyumen","simbirsk","chelyabinsk","chel","chita","yaroslavl","bir","jar","palana","dudinka","surgut","chukotka","yamal","amursk","baikal","cmw","fareast","jamal","kms","k-uralsk","kustanai","kuzbass","magnitka","mytis","nakhodka","nkz","norilsk","snz","oskol","pyatigorsk","rubtsovsk","syzran","tagil","vdonsk","zgrad"],in:["firm","gen","ind","res","ernet"]}[d];if(""!=m&&null!=y&&y.indexOf(m)>=0)u="."+m+"."+d,i=i.substr(0,i.length-u.length),f=!0;else{var S=p.substr(0,g).lastIndexOf(".");if(S>0){var b=p.slice(S+1);y&&y.indexOf(b)>=0&&(u="."+b+"."+d,i=i.substr(0,i.length-u.length),f=!0)}}}}if(!f)u="."+(d=i.slice(l+1)),i=i.substr(0,l),2==d.length&&(l=i.lastIndexOf("."))>=0&&(d=i.slice(l+1),"us"!=u&&"co"!=d&&"ac"!=d&&"go"!=d&&"or"!=d&&"ne"!=d&&"com"!=d&&"edu"!=d&&"gov"!=d&&"gouv"!=d&&"gob"!=d&&"info"!=d&&"int"!=d&&"mil"!=d&&"net"!=d&&"org"!=d||(u="."+d+u,i=i.substr(0,l)));(l=i.lastIndexOf("."))>=0?(o=i.slice(l+1),i=i.substr(l)):(o=i,i="")}else o=i,u="";if(o&&n){var _=o.substr(0,1);o=_.toUpperCase()+o.slice(1)}return t?r?s+o+u:o+u:o},isUrlDomainsMatch:function(e,t){if(!e||!t)return!1;var r=v.ParseUrl(e,!0,!1),n=v.ParseUrl(t,!0,!1);return!(!r||!n)&&(r.host==n.host||v.DomainFromUrl(e,!0,!1,!1)==v.DomainFromUrl(t,!0,!1,!1))},CompareUrls:function(e,t,r){if(e=e.replace(new RegExp("/$","g"),""),t=t.replace(new RegExp("/$","g"),""),e.toLowerCase()==t.toLowerCase())return m;var n=e.search(new RegExp("^exe://"))>=0,a=t.search(new RegExp("^exe://"))>=0;if(n&&a)return v.GetWin32UrlDomain(e).toLowerCase()==v.GetWin32UrlDomain(t).toLowerCase()?p:f;var i=v.ParseUrl(e,!0,!1),s=v.ParseUrl(t,!0,!1);if(!i||!s)return f;if(i.type==c.enUrlType_File&&s.type==c.enUrlType_File&&i.object&&s.object&&i.object.toLowerCase()==s.object.toLowerCase())return m;if(!i.host||!s.host)return f;var o=i.host.toLowerCase()==s.host.toLowerCase();if(o&&i.port==s.port&&i.object==s.object)return g;if(o){var u=p;if(i.port==s.port&&i.object&&s.object){u++;for(var l=Math.min(i.object.length,s.object.length),h=0;h<l&&i.object[h]==s.object[h]&&u<g-1;++h)"/"==i.object[h]&&u++}return u}return v.isUrlDomainsMatch(e,t)?d:f},FileExtToType:function(e){return".rfp"==(e=e.toLowerCase())?r:".rfb"==e?n:".rfq"==e?a:".rfn"==e?u:".rft"==e?s:".rfc"==e?o:".rfx"==e?i:t},FileTypeToExt:function(e){return e==r?".rfp":e==n?".rfb":e==a?".rfq":e==u?".rfn":e==s?".rft":e==o?".rfc":e==i?".rfx":""},BlockCopy:function(e,t,r,n,a){for(var i=t,s=n;i<t+a;i++,s++)r[s]=e[i]},rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&v.rotl(e,8)|4278255360&v.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=v.endian(e[t]);return e},longToSingleByte:function(e){return e%256},SibGenSalt:function(e){new Random(3*int(DateTime.UtcNow.Subtract(new DateTime(1970,1,1))).TotalSeconds).NextBytes(e)},random:function(){var e=window.crypto||window.msCrypto;return e?this.SibGenerateRandomUInt(1e9,e):Math.floor(1e10*Math.random())},randomBytes:function(e){for(var t=window.crypto||window.msCrypto,r=[];e>0;e--)t?r.push(this.SibGenerateRandomUInt(255,t)):r.push(Math.floor(256*Math.random()));return r},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=(255&e[r])<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(t){for(var r=[],n=0;n<t.length;n+=3)for(var a=t[n]<<16|t[n+1]<<8|t[n+2],i=0;i<4;i++)8*n+6*i<=8*t.length?r.push(e.charAt(a>>>6*(3-i)&63)):r.push("=");return r.join("")},base64ToBytes:function(t){t=t.replace(new RegExp("[^A-Z0-9+/]","ig"),"");for(var r=[],n=0,a=0;n<t.length;a=++n%4)0!=a&&r.push((e.indexOf(t.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<2*a|e.indexOf(t.charAt(n))>>>6-2*a);return r},compareSets:function(e,t){if(e.length!==t.length)return!1;for(var r=e.length;r--;)if(!~t.indexOf(e[r])||!~e.indexOf(t[r]))return!1;return!0},IsEqualArrays:function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},CopyObjectDeep:function(e){if(null==e)return e;var t;switch(typeof e){case"object":if(void 0!==e.length){t=[];for(var r=0;r<e.length;r++)t[r]=this.CopyObjectDeep(e[r])}else for(var n in t={},e)t[n]=this.CopyObjectDeep(e[n]);break;case"function":break;default:t=e}return t},filterPartOfStr:function(e,t,r){var n=e.split(r);if(1==n.length)return!1;for(var a=0;a<n.length;a++){if(0==n[a].indexOf(t))return!0}return!1},byteLength:function(e){for(var t=e.length,r=e.length-1;r>=0;r--){var n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t},getDateTime:function(){function e(e){return e<10?"0"+e:e}var t=new Date,r=t.getYear()+1900,n=e(t.getMonth()+1),a=e(t.getDate()),i=e(t.getHours()),s=e(t.getMinutes()),o=e(t.getSeconds()),u=r.toString()+n.toString()+a.toString();return u+="_",u+=i.toString()+s.toString()+o.toString()},generatePassword:function(e,t,r,n,a,i,s,o,u,l){var c=window.crypto||window.msCrypto,h="",f="",d="";e=void 0===e?8:e,e=parseInt(e),t=void 0===t||t,r=void 0===r||r,n=void 0===n||n,o=void 0!==o&&o,u=void 0===u||u,a=void 0!==a&&a,i=void 0===i?"":i;var p=void 0===l?0:parseInt(l),g=1;if(n)if(void 0!==s)(g=parseInt(s))>e?g=e:g<=0&&(g=1);else{g=(g=this.SibGenerateRandomUInt(3,c))||1}if(p&&(p=p>e?e:p,n&&g&&g+p>e&&(1==e?(g=0,p=1):2==e?(g=1,p=1):(g=1,p=e-1))),o)h=u?"23456789ABCDEF":"0123456789ABCDEF";else{if(n){var m=u?"23456789":"0123456789";h+=m;for(var v=m.length,y=0;y<g;y++){var S=this.SibGenerateRandomUInt(v,c);f+=m[S=S==m.length?S-1:S]}}var b=0;if(t){var _=u?"ABCDEFGHJKLMNPQRSTUVWXYZ":"ABCDEFGHIJKLMNOPQRSTUVWXYZ";h+=_;var R=this.SibGenerateRandomUInt(_.length,c);f+=_[R=R==_.length?R-1:R],b++}if(r){var w=u?"abcdefghijkmnopqrstuvwxyz":"abcdefghijklmnopqrstuvwxyz";h+=w;var k=this.SibGenerateRandomUInt(w.length,c);f+=w[k=k==w.length?k-1:k],b++}if(p&&p>b){var x=p-b,E="";t&&(E+=u?"ABCDEFGHJKLMNPQRSTUVWXYZ":"ABCDEFGHIJKLMNOPQRSTUVWXYZ"),r&&(E+=u?"abcdefghijkmnopqrstuvwxyz":"abcdefghijklmnopqrstuvwxyz");for(y=0;y<x;y++){var I=this.SibGenerateRandomUInt(E.length,c);f+=E[I=I==E.length?I-1:I]}}if(a&&i){h+=i;var C=i.length,A=C>1?this.SibGenerateRandomUInt(C,c):0;f+=i[A=A==i.length?A-1:A]}}var P,T=f.length,B=h.length;if(!B&&!T)return d;for(P=0;P<e-T;P++){var U=this.SibGenerateRandomUInt(B,c);d+=h[U=U==h.length?U-1:U]}for(y=0;y<T&&P<e;y++,P++){var J=f[y],D=d.length,L=0==D?0:this.SibGenerateRandomUInt(D+1,c);d=d.slice(0,L)+new String(J)+d.slice(L)}return d},SibGenerateRandomUInt:function(e,t){if(!t)return Math.floor(Math.random()*(e+1));var r,n=new Uint32Array(1);r=(-(e>>>=0)>>>0)%e;do{t.getRandomValues(n)}while(n[0]<r);return n[0]%e},calculatePwdStrength:function(e){var t=0;return""==e?0:(e.match(new RegExp(".*\\d.*\\d.*\\d"))&&(t+=6),e.match(new RegExp("[!,@,#,$,%,^,&,*,?,_,~]"))&&(t+=6),e.match(new RegExp(".*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~]"))&&(t+=8),t+=3*e.length,e.match(new RegExp("[a-z]"))&&(t+=2),e.match(new RegExp("[A-Z]"))&&(t+=5),e.match(new RegExp("(?=.*[a-z])(?=.*[A-Z])"))&&(t+=2),e.match(new RegExp("(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])"))&&(t+=2),e.match(new RegExp("\\d"))&&(t+=4),e.match(new RegExp("(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!,@,#,$,%,^,&,*,?,_,~])"))&&(t+=2),(t*=2)<0?t=0:t>100&&(t=100),t)},insertToSortedArray:function(e,t,r,n,a){return t.splice(this.getInsertIndex(e,t,0==n?b:1==n?S:y,void 0,void 0,r,a)+1,0,e),t},getInsertIndex:function(e,t,r,n,a,i,s){if(0===t.length)return-1;var o=(n=n||0)+(a=a||t.length)>>1,u=r(e,t[o],i,s);if(a-n<=1)return-1==u?o-1:o;switch(u){case-1:return this.getInsertIndex(e,t,r,n,o,i,s);case 0:return o;case 1:return this.getInsertIndex(e,t,r,o,a,i,s)}},GetLittleEndianIntegerFromByteArray:function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},GetLEIntegerFromByteArray:function(e,t,r){var n=e[t+1]?bigInt(e[t+1]):bigInt(0),a=e[t]?bigInt(e[t]):bigInt(0);if(2==r)return n.shiftLeft(8).or(a).value;var i=e[t+3]?bigInt(e[t+3]):bigInt(0),s=e[t+2]?bigInt(e[t+2]):bigInt(0);return i.shiftLeft(24).or(s.shiftLeft(16).or(n.shiftLeft(8).or(a))).value},GetLittleEndianByteArrayFromInteger:function(e){var t=new Array(4);return t[0]=255&e,t[1]=e>>8&255,t[2]=e>>16&255,t[3]=e>>24&255,t},GetLEByteArrayFromInteger:function(e,t){var r=bigInt(e),n=[];return n[0]=r.and(255).value,n[1]=r.shiftRight(8).and(255).value,2==t?n:(n[2]=r.shiftRight(16).and(255).value,n[3]=r.shiftRight(24).and(255).value,n)},SibRSAEncryptLongStr:function(e,t,r){var n=e.in_bytes;if(!n)return r({eErr:6,sErr:"Missed required parameter: input stream"}),!1;var a=n.length,i=e.key_pem;if(!i)return r({eErr:6,sErr:"Missed required parameter:  RSA key"}),!1;var s=e.is_key_private,o=4,u=2,l=4,c=[],h=0;function f(){var e=T(c,h),r=RfapiJS.utils.GetLEByteArrayFromInteger(e,l);RfapiJS.utils.BlockCopy(r,0,c,h,l),h+=l,t(c)}a<=117?function(){var e=new RSAKey,t=RfapiJS.RF_RSA.GetHexFromPEM(i,!s);s?e.setPrivateEx(t.modulus,t.exponent,t.privateexp,t.P,t.Q,t.DP,t.DQ,t.InverseQ):e.setPublic(t.modulus,t.exponent);var a=RfapiJS.utils.hexToBytes(e.encrypt(n,!0)),l=a.length;if(!l)return r({eErr:6,sErr:"RSA Encryption failed"}),!1;RfapiJS.utils.BlockCopy([115,114,115,49],0,c,0,o),h+=o;var d=RfapiJS.utils.GetLEByteArrayFromInteger(l,2);RfapiJS.utils.BlockCopy(d,0,c,h,u),h+=u,RfapiJS.utils.BlockCopy(a,0,c,h,l),h+=l,f()}():function(){var e=RfapiJS.utils.randomBytes(40),t=[];RfapiJS.utils.BlockCopy(e,0,t,0,32);var a=[];RfapiJS.utils.BlockCopy(e,32,a,0,8);var l=RfapiJS.utils.GenerateAESKey(a,1,64,sjcl.codec.bytes.toBits(t)),d={in_bytes:e,key_pem:i,is_key_private:s,do_encrypt:!0};RfapiJS.utils.SibRSAEncDecShort(d,function(e){var t=e.length;if(!t)return r({eErr:6,sErr:"RSA encryption failed"}),!1;RfapiJS.utils.BlockCopy([115,114,115,50],0,c,0,o),h+=o;var a=RfapiJS.utils.GetLEByteArrayFromInteger(t,2);RfapiJS.utils.BlockCopy(a,0,c,h,u),h+=u,RfapiJS.utils.BlockCopy(e,0,c,h,t),h+=t;var i=new Array(32),s=new Array(16);RfapiJS.utils.BlockCopy(l,0,i,0,32),RfapiJS.utils.BlockCopy(l,32,s,0,16);var d=CryptoJS.enc.u8array.parse(i),p=CryptoJS.enc.u8array.parse(s),g={};g.iv=p,g.mode=CryptoJS.mode.CBC,g.padding=CryptoJS.pad.Pkcs7;var m=CryptoJS.algo.AES.createEncryptor(d,g),v=m.process(CryptoJS.enc.u8array.parse(n)),y=m.finalize();y.sigBytes>=0&&(v=v.concat(y));var S=CryptoJS.enc.u8array.stringify(v),b=S.length;RfapiJS.utils.BlockCopy(S,0,c,h,b),h+=b,f()},r)}()},SibRSADecryptLongStr:function(e,t,r){var n=e.in_bytes;if(!n)return r({eErr:6,sErr:"Missed required parameter: input stream"}),!1;var a=e.key_pem;if(!a)return r({eErr:6,sErr:"Missed required parameter:  RSA key"}),!1;var i=e.is_key_private,s=n.length;if(s<10)return r({eErr:6,sErr:"Corrupted data: stream is too small"}),!1;var o=[];if(RfapiJS.utils.BlockCopy(n,0,o,0,4),RfapiJS.utils.IsEqualArrays(o,[115,114,115,49]))!1;else{if(!RfapiJS.utils.IsEqualArrays(o,[115,114,115,50]))return r({eErr:6,sErr:"Unknown data format"}),!1;!0}if(RfapiJS.CRC32(n,s-4)!=RfapiJS.utils.GetLEIntegerFromByteArray(n,s-4,4))return r({eErr:6,sErr:"Data CRC error"}),!1;var u=RfapiJS.utils.GetLEIntegerFromByteArray(n,4,2),l=[];if(RfapiJS.utils.BlockCopy(n,6,l,0,u),u<=0||u>s-10)return r({eErr:6,sErr:"Corrupted data: RSA stream is wrong"}),!1;var c,h=s-(6+u+4),f=[];RfapiJS.utils.BlockCopy(n,6+u,f,0,h),c={in_bytes:l,key_pem:a,is_key_private:i,do_encrypt:!1},RfapiJS.utils.SibRSAEncDecShort(c,function(e){h?function(e){if(40!=e.length)return r({eErr:6,sErr:"unknown data format"}),!1;var n=[];RfapiJS.utils.BlockCopy(e,0,n,0,32);var a=[];RfapiJS.utils.BlockCopy(e,32,a,0,8);var i=RfapiJS.utils.GenerateAESKey(a,1,64,sjcl.codec.bytes.toBits(n)),s=new Array(32),o=new Array(16);RfapiJS.utils.BlockCopy(i,0,s,0,32),RfapiJS.utils.BlockCopy(i,32,o,0,16);var u=CryptoJS.enc.u8array.parse(s),l=CryptoJS.enc.u8array.parse(o),c={};c.iv=l,c.mode=CryptoJS.mode.CBC,c.padding=CryptoJS.pad.Pkcs7;var h=CryptoJS.algo.AES.createDecryptor(u,c),d=h.process(CryptoJS.enc.u8array.parse(f)),p=h.finalize();p.sigBytes>=0&&(d=d.concat(p));var g=CryptoJS.enc.u8array.stringify(d);RfapiJS.UTF8.bytesToString(g),t(g)}(e):(RfapiJS.UTF8.bytesToString(e),t(e))},r)},GenerateAESKey:function(e,t,r,n){var a=sjcl.codec.bytes.toBits(e),i=sjcl.hash.sha256,s=sjcl.misc.pbkdf2(n,a,t,8*r,function(e){var t=new sjcl.misc.hmac(e,i);this.encrypt=function(){return t.encrypt.apply(t,arguments)}});return sjcl.codec.bytes.fromBits(s)},SibRSAEncDecShort:function(e,t,r){var n=new RSAKey,a=RfapiJS.RF_RSA.GetHexFromPEM(e.key_pem,!e.is_key_private);if(e.is_key_private){n.setPrivateEx(a.modulus,a.exponent,a.privateexp,a.P,a.Q,a.DP,a.DQ,a.InverseQ);var i=RfapiJS.utils.bytesToHex(e.in_bytes),s=n.decrypt(i,!0);s?t(s):r({eErr:6,sErr:"Decryption failed"})}else{n.setPublic(a.modulus,a.exponent);var o=n.encrypt(e.in_bytes,!0);o?t(RfapiJS.utils.hexToBytes(o)):r({eErr:6,sErr:"Encryption failed"})}}},y=function(e,t,r){var n=e[r[0]].substring(e[r[0]].lastIndexOf("/")+1),a=e[r[0]];n=n.toLowerCase(),a=a.toLowerCase();var i=t[r[0]].substring(t[r[0]].lastIndexOf("/")+1),s=t[r[0]];var o=function(e,t,r,n){if(r.startsWith("/")&&(r=r.substr(1)),n.startsWith("/")&&(n=n.substr(1)),-1==r.indexOf("/")&&-1!=n.indexOf("/"))return-1;if(-1!=r.indexOf("/")&&-1==n.indexOf("/"))return 1;if(-1==r.indexOf("/")&&-1==n.indexOf("/"))return(e=e.substr(0,e.lastIndexOf(".")))<(t=t.substr(0,t.lastIndexOf(".")))?-1:e>t?1:0;r=r.substr(0,r.lastIndexOf(".")),n=n.substr(0,n.lastIndexOf("."));var a=r.split("/"),i=n.split("/");return a.length<i.length?-1:a.length>i.length?1:e<t?-1:e>t?1:0}(n,i=i.toLowerCase(),a,s=s.toLowerCase());if(null!=o)return o},S=function(e,t,a,i){var l=e[a[0]].substring(e[a[0]].lastIndexOf("/")+1),c=e[a[0]],h=l.substr(l.lastIndexOf(".")),f=RfapiJS.utils.FileExtToType(h);l=l.toLowerCase(),c=c.toLowerCase();var d=t[a[0]].substring(t[a[0]].lastIndexOf("/")+1),p=t[a[0]],g=d.substr(d.lastIndexOf(".")),m=RfapiJS.utils.FileExtToType(g);function v(e,t,r,n,a,s,o){if(e!=o&&t==o)return-1;if(e==o&&t!=o)return 1;if(e==o&&t==o){if(a.startsWith("/")&&(a=a.substr(1)),s.startsWith("/")&&(s=s.substr(1)),-1==a.indexOf("/")&&-1!=s.indexOf("/"))return-1;if(-1!=a.indexOf("/")&&-1==s.indexOf("/"))return 1;if(-1==a.indexOf("/")&&-1==s.indexOf("/")){if(r=r.substr(0,r.lastIndexOf(".")),n=n.substr(0,n.lastIndexOf(".")),!i)return r<n?-1:r>n?1:0;var u=r.indexOf(i),l=n.indexOf(i);if(u&&!l)return 1;if(!u&&l)return-1;if(!u&&!l||u&&l)return r<n?-1:r>n?1:0}if(a=a.substr(0,a.lastIndexOf(".")),s=s.substr(0,s.lastIndexOf(".")),!i)return a<s?-1:a>s?1:0;u=r.indexOf(i),l=n.indexOf(i);if(u&&!l)return 1;if(!u&&l)return-1;if(!u&&!l||u&&l)return a<s?-1:a>s?1:0}}var y=v(m,f,l,d=d.toLowerCase(),c,p=p.toLowerCase(),r);if(null!=y)return y;var S=v(m,f,l,d,c,p,n);if(null!=S)return S;var b=v(m,f,l,d,c,p,u);if(null!=b)return b;var _=v(m,f,l,d,c,p,s);if(null!=_)return _;var R=v(m,f,l,d,c,p,o);return null!=R?R:void 0},b=function(e,t,r){var n=e[r[0]][r[1]].substring(e[r[0]][r[1]].lastIndexOf("/")+1),a=void 0!==e[r[0]][RfapiJS.ITEM_ISFOLDER_PROP]?l:1,i=void 0!==e[r[0]].Shared;n=n.toLowerCase();var s=t[r[0]][r[1]].substring(t[r[0]][r[1]].lastIndexOf("/")+1),o=void 0!==t[r[0]][RfapiJS.ITEM_ISFOLDER_PROP]?l:1,u=void 0!==t[r[0]].Shared;if(s=s.toLowerCase(),o!=l&&a==l)return-1;if(o==l&&a!=l)return 1;if(o==l&&a==l){if(!i&&!u||i&&u)return n<s?-1:n>s?1:0;if(!u&&i)return-1;if(u&&!i)return 1}return o!=l&&a!=l?n<s?-1:n>s?1:0:void 0},_={GenerateKeysWithCheck:function(e){var t="qwerty";function r(){0;var r=new RSAKey;r.generate(parseInt(e),"10001");var n=_.GetPublicKeyPem(r),a=_.GetHexFromPEM(n,!0);r.setPublic(a.modulus,a.exponent);var i=r.encrypt(t),s=_.GetPrivateKeyPem(r),o=_.GetHexFromPEM(s,!1),u=o.modulus,l=o.exponent,c=o.privateexp,h=o.P,f=o.Q,d=o.DP,p=o.DQ,g=o.InverseQ;if(r.setPrivateEx(u,l,c,h,f,d,p,g),r.decrypt(i))return{Public_Pem:n,Private_Pem:s}}for(var n=r();!n;)n=r();return n},GenerateKeysPEM:function(e){var t=new RSAKey;t.generate(parseInt(e),"10001");var r=this.GetPublicKeyPem(t);return{Private_Pem:this.GetPrivateKeyPem(t),Public_Pem:r}},GetPrivateKeyPem:function(e){var t=[];t.push(48);var r=[];this.EncodeIntegerBigEndian(r,[0]);var n=v.hexToBytes(e.n.toString(16));this.EncodeIntegerBigEndian(r,n,e.n.toString(16).length);this.EncodeIntegerBigEndian(r,[1,0,1]);var a=v.hexToBytes(e.d.toString(16));this.EncodeIntegerBigEndian(r,a,e.d.toString(16).length);var i=v.hexToBytes(e.p.toString(16));this.EncodeIntegerBigEndian(r,i,e.p.toString(16).length);var s=v.hexToBytes(e.q.toString(16));this.EncodeIntegerBigEndian(r,s,e.q.toString(16).length);var o=v.hexToBytes(e.dmp1.toString(16));this.EncodeIntegerBigEndian(r,o,e.dmp1.toString(16).length);var u=v.hexToBytes(e.dmq1.toString(16));this.EncodeIntegerBigEndian(r,u,e.dmq1.toString(16).length);var l=v.hexToBytes(e.coeff.toString(16));this.EncodeIntegerBigEndian(r,l,e.coeff.toString(16).length);var c=r.length;this.EncodeLength(t,c);for(var h=0;h<r.length;h++)t.push(r[h]);var f=v.bytesToBase64(t),d="-----BEGIN RSA PRIVATE KEY-----\n";return d+=this.WordWrap(f),d+="\n",d+="-----END RSA PRIVATE KEY-----\n"},WordWrap:function(e,t){if(!e)return e;var r="(.{1,"+(t=t||64)+"})( +|$\n?)|(.{1,"+t+"})";return e.match(RegExp(r,"g")).join("\n")},EncodeLength:function(e,t){if(t<0)throw new DOMException("Length must be non-negative");if(t<128)e.push(t);else{for(var r=t,n=0;r>0;)r>>=8,n++;e.push(128|n);for(var a=n-1;a>=0;a--)e.push(t>>8*a&255)}},DecodeLength:function(e,t){var r=e[t.offset++];if(128==(128&r)){var n=-129&r;r=0;for(var a=0;a<n;a++)r|=e[t.offset++]<<8*(n-a-1)}return r},EncodeIntegerBigEndian:function(e,t,r){e.push(2);for(var n=0,a=0;a<t.length&&0==t[a];a++)n++;if(t.length-n==0)this.EncodeLength(e,1),e.push(0);else{t[n]>127?(this.EncodeLength(e,t.length-n+1),e.push(0)):this.EncodeLength(e,t.length-n);for(a=n;a<t.length;a++)e.push(t[a])}},GetPublicKeyPem:function(e){var t=[];t.push(48);var r=e.n.toString(16),n=v.hexToBytes(r),a=[];this.EncodeIntegerBigEndian(a,n),this.EncodeIntegerBigEndian(a,[1,0,1]);var i=a.length;this.EncodeLength(t,i);for(var s=0;s<a.length;s++)t.push(a[s]);var o=v.bytesToBase64(t),u="-----BEGIN RSA PUBLIC KEY-----\n";return u+=this.WordWrap(o),u+="\n",u+="-----END RSA PUBLIC KEY-----\n"},GetHexFromPEM:function(e,t){if(e.indexOf("-----BEGIN RSA")>=0&&e.indexOf("-----END")>=0){var r=e.substr(30);10==r.charCodeAt(0)&&(r=r.substr(1));var n=r.indexOf("-----END");r=(r=r.substr(0,n)).replace(new RegExp("[\r\n]","g"),"");var a=v.base64ToBytes(r),i=null,s=null,o=null,u=null,l=null,c=null,h=null,f=null,d=null,p=0;do{var g,m=a[p++];if(48==m){var y={offset:p};g=this.DecodeLength(a,y),p=y.offset}else if(2==m){y={offset:p};g=this.DecodeLength(a,y),p=y.offset,17!=g&&33!=g&&65!=g&&129!=g&&257!=g&&513!=g&&1025!=g&&2049!=g||0!=a[p]||(g--,p++);var S=new Array(g);v.BlockCopy(a,p,S,0,g),p+=g,t?null==i?i=S:null==s&&(s=S):null==o?o=S:null==i?i=S:null==s?s=S:null==u?u=S:null==l?l=S:null==c?c=S:null==h?h=S:null==f?f=S:null==d&&(d=S)}else if(3==m){y={offset:p};g=this.DecodeLength(a,y),p=y.offset}else if(4==m){y={offset:p};if(g=this.DecodeLength(a,y),p=y.offset,-1!=g){S=new Array(g);v.BlockCopy(a,p,S,0,g)}p+=g}else if(5==m)g=a[p++],p+=g;else if(6==m){g=a[p++];S=new Array(g);v.BlockCopy(a,p,S,0,g),p+=g}}while(p<a.length);return t?{modulus:v.bytesToHex(i),exponent:v.bytesToHex(s)}:{modulus:v.bytesToHex(i),exponent:v.bytesToHex(s),privateexp:v.bytesToHex(u),P:v.bytesToHex(l),Q:v.bytesToHex(c),DP:v.bytesToHex(h),DQ:v.bytesToHex(f),InverseQ:v.bytesToHex(d)}}return null}},R={stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")},pack:function(e){for(var t=[],r=0,n=e.length;r<n;)t.push((255&e[r++])<<8|255&e[r++]);return String.fromCharCode.apply(null,t)}},w={stringToBytes:function(e){var t=encodeURIComponent(e),r=unescape(t);return R.stringToBytes(r)},bytesToString:function(e){var t=R.bytesToString(e),r=escape(t);return decodeURIComponent(r)}};function k(){this.password="",this.pwdStrength=0,this.duplicateKey="",this.gotoUrl="",this.modTime=0,this.path=""}function x(){this.m_weak=-1,this.m_medium=-1,this.m_good=-1,this.m_excellent=-1,this.m_reused=-1,this.m_duplicates=-1}x.prototype.GetJSONBase64=function(){var e={};e.weak=this.m_weak,e.medium=this.m_medium,e.good=this.m_good,e.excellent=this.m_excellent,e.reused=this.m_reused,e.duplicates=this.m_duplicates,e=JSON.stringify(e);var t=RfapiJS.UTF8.stringToBytes(e);return RfapiJS.utils.bytesToBase64(t)},x.prototype.GetStats=function(){var e={};return e.weak=this.m_weak,e.medium=this.m_medium,e.good=this.m_good,e.excellent=this.m_excellent,e.reused=this.m_reused,e.duplicates=this.m_duplicates,e};var E={m_bAnalyzeGranted:!0,m_bAnalyzeReceived:!1,m_mReused:{},m_mItems:[],m_mDuplicates:{},m_mAll:[],Init:function(e,t){return this.m_mDuplicates={},this.m_mReused={},this.m_mAll=[],this.m_mItems=[],this.m_bAnalyzeGranted=void 0===e||e,this.m_bAnalyzeReceived=void 0!==t&&t,this},GetItems:function(){var e={};for(var t in e.all=this.m_mAll,e.duplicates=[],this.m_mDuplicates){if(this.m_mDuplicates[t]-1){var r={};r.key=t,r.items=[];for(var n=0;n<this.m_mItems.length;n++){var a=this.m_mItems[n];a.duplicateKey==r.key&&(r.items.push(a),r.gotoUrl=a.gotoUrl)}e.duplicates.push(r)}}for(var t in e.reused=[],this.m_mReused)if(this.ArrayIsDuplicatePassword(this.m_mReused[t])){var i={};i.password=t,i.items=this.m_mReused[t],e.reused.push(i)}return e},AddItem:function(e){var t=e.f;if(t&&(!e.received||this.m_bAnalyzeReceived)&&(!e.granted||this.m_bAnalyzeGranted)){for(var r="",n=0;n<t.length;n++){var a=t[n];if(a.t&&2==a.t){var i=a.v;if(i&&"$DefaultValue$"!=(r=i))break}}var s=new k;s.password=r;var o=RfapiJS.SecurityScore.SibGetPasswordStrengthLevel(r);s.pwdStrength=o,s.modTime=e.mod?e.mod:0,s.path=e.path?e.path:"",e.granted&&(s.granted=!0),e.received&&(s.received=!0),e.accountInfo&&(s.accountInfo=e.accountInfo);var u=e.g?e.g:"",l=e.n?e.n:"",c=this.GetMD5Hash(t,u,l);if(s.duplicateKey=c,void 0===this.m_mDuplicates[c]?this.m_mDuplicates[c]=1:this.m_mDuplicates[c]++,s.gotoUrl=u,this.m_mItems.push(s),r)if(this.m_mAll.push(s),void 0===this.m_mReused[r]){var h=[];h.push(s),this.m_mReused[r]=h}else this.m_mReused[r].push(s)}},IsEmptyStorage:function(){var e=0;for(var t in this.m_mReused){e++;break}return!e},GetAverageSafetyLevel:function(){if(this.IsEmptyStorage())return{score:0};var e=0,t=0;for(var r in this.m_mReused){t++;var n=r,a=this.m_mReused[r].length-1,i=RfapiJS.SecurityScore.SibGetPasswordStrengthLevel(n);e+=parseFloat(i/(4*Math.log(Math.exp(1)+a)))}return e/=t,score=parseInt(100*e+.5),0==score&&(score=1),{score:score}},GetMD5Hash:function(e,t,r){for(var n="",a=0;a<e.length;a++)n+=e[a].n,n+=e[a].v;n+=t,n+=r;var i=CryptoJS.MD5(n);return i=i.toString()},ArrayIsDuplicatePassword:function(e){var t=!0;if(e.length<=1)return!1;for(var r=1;r!=e.length;r++){var n=e[r-1],a=e[r];if(!n.gotoUrl||!a.gotoUrl)return!1;if(!RfapiJS.utils.isUrlDomainsMatch(n.gotoUrl,a.gotoUrl)){t=!1;break}}return!t},GetSecurityStats:function(e){e.m_weak=0,e.m_medium=0,e.m_good=0,e.m_excellent=0,e.m_reused=0,e.m_duplicates=0;for(var t=0;t<this.m_mAll.length;t++){switch(this.m_mAll[t].pwdStrength){case 4:e.m_excellent++;break;case 3:e.m_good++;break;case 2:e.m_medium++;break;case 1:case 0:e.m_weak++}}for(var r in this.m_mReused)this.ArrayIsDuplicatePassword(this.m_mReused[r])&&e.m_reused++;for(var r in this.m_mDuplicates){this.m_mDuplicates[r]-1&&e.m_duplicates++}}},I=void 0,C={time_of_recalculation:86400,SecurityScoreLevel:{Weak:0,Medium:1,Good:2,Strong:3},EnPattern:{enDictionary:0,enRepeat:1,enSequence:2,enBrutForce:3},CPatternMatch:function(e,t,r,n,a){this.m_start=void 0===e?-1:e,this.m_end=void 0===t?-1:t,this.m_pattern=void 0===n?3:n,this.m_data=void 0===r?"":r,this.m_rank=void 0===a?0:a,this.m_score=0},GetScoreLevel:function(e){var t=parseInt(e);return isNaN(t)?-1:t<=25?this.SecurityScoreLevel.Weak:25<t&&t<=50?this.SecurityScoreLevel.Medium:50<t&&t<=75?this.SecurityScoreLevel.Good:t>75?this.SecurityScoreLevel.Strong:void 0},NeedToUpdate:function(e){if(!e)return!1;var t=e.oneFile;if(!(t=void 0!==t&&t))return!1;var r=e.securityStats;if(r){var n=RfapiJS.utils.base64ToBytes(r),a=RfapiJS.UTF8.bytesToString(n);r=JSON.parse(a)}if(!r)return!0;var i=r.scoreUpdatedTime;return!i||("undefined"==typeof surnames_ranked?(console.log("could not load pwd-dict.js"),!1):Math.round(new Date/1e3)-i>this.time_of_recalculation)},LoadDictionaries:function(e){"undefined"==typeof surnames_ranked?console.log("could not load pwd-dict.js"):e()},SibGetPasswordStrengthLevel:function(e,t){var r,n=parseInt(this.CalcPasswordStrength(e,t,[])+.5),a=[0,20,40,52,79];for(r=a.length-1;r>0&&!(n>=a[r]);r--);return r},CalcPasswordStrength:function(e,t,r){if(r=r||[],!e)return 0;for(var n=e.length<100?e:e.substr(0,99),a=[],i=-1,s=-1,o=0;o<n.length-1;o++)if(n[o]==n[o+1])-1==i&&(i=o);else if(-1!=i){s=o+1;var u=new this.CPatternMatch(i,s-1,this.Mid(n,i,s-i),this.EnPattern.enRepeat);a.push(u),i=-1,s=-1}if(-1!=i){var l=new this.CPatternMatch(i,n.length-1,this.Mid(n,i,n.length-i),this.EnPattern.enRepeat);a.push(l)}var c=[];for(o=0;o<n.length-1;o++)c.push(n[o].charCodeAt(0)-n[o+1].charCodeAt(0));var h=-1,f=-1;for(o=0;o<c.length-1;++o)if(c[o]==c[o+1])-1==h&&(h=o);else if(-1!=h){f=o+1;var d=new this.CPatternMatch(h,f,this.Mid(n,h,f+1-h),this.EnPattern.enSequence);a.push(d),h=-1,f=-1}if(-1!=h){d=new this.CPatternMatch(h,n.length-1,this.Mid(n,h,n.length-h),this.EnPattern.enSequence);a.push(d)}var p=n,g=p=p.toLowerCase(),m=this.GetPasswordMeterDictionary();for(o=0;o!=n.length;++o)for(var v=o+1;v<=n.length;++v){var y=0,S=m[this.Mid(g,o,v-o)];if(S){y=S;var b=new this.CPatternMatch(o,v-1,this.Mid(n,o,v-o),this.EnPattern.enDictionary,y);a.push(b)}}for(o=0;o!=a.length;++o)a[o].m_score=this.CalcMatchScore(a[o]);var _=0,R=new Array(n.length),w=new Array(n.length);for(o=0;o!=R.length;++o){_+=6.53;for(var k=0;k!=a.length;++k)if(a[k].m_end==o){var x=a[k],E=a[k].m_start>0?R[a[k].m_start-1]:0;a[k].m_score+E<_&&(_=a[k].m_score+E,w[o]=a[k])}R[o]=_}var I=[];for(o=n.length-1;o>0;){if(w[o]){x=w[o];I.unshift(x),o=x.m_start}o--}r.length=0;k=0;for(var C=0;C<I.length;C++){var A;if((x=I[C]).m_start-k>0)(A=new this.CPatternMatch(k,x.m_start-1,this.Mid(n,k,x.m_start-k),this.EnPattern.enBrutForce)).m_score=this.CalcMatchScore(A),r.push(A);r.push(x),k=x.m_end+1}k<n.length&&((A=new this.CPatternMatch(k,n.length-1,this.Mid(n,k,n.length-k),this.EnPattern.enBrutForce)).m_score=this.CalcMatchScore(A),r.push(A));var P=0;for(o=0;o!=r.length;++o)P+=r[o].m_score;return P},CalcMatchScore:function(e){var t=0;switch(e.m_pattern){case this.EnPattern.enDictionary:t=Math.log(e.m_rank)/Math.log(2);break;case this.EnPattern.enRepeat:case this.EnPattern.enSequence:var r=e.m_data[0];n=0;n=this.IsDigit(r)?10:this.IsLetter(r)?26:this.IsSymbol(r)?33:65408,t=Math.log(n*e.m_data.length)/Math.log(2);break;case this.EnPattern.enBrutForce:default:var n=0;n+=this.IsAny(e.m_data,this.IsDigit)?10:0,n+=this.IsAny(e.m_data,this.IsHigher)?26:0,n+=this.IsAny(e.m_data,this.IsLower)?26:0,0==(n+=this.IsAny(e.m_data,this.IsSymbol)?33:0)&&(n=65408),t=Math.log(n)*e.m_data.length/Math.log(2)}return t},GetPasswordMeterDictionary:function(){if(I)return I;I={};var e=[];e.push(surnames_ranked),e.push(male_names_ranked),e.push(female_names_ranked),e.push(english_words_ranked),e.push(passwords_ranked);var t=[];t.push(surnames_ranked.length),t.push(male_names_ranked.length),t.push(female_names_ranked.length),t.push(english_words_ranked.length),t.push(passwords_ranked.length);for(var r=0;r!=e.length;++r)for(var n=0;n!=t[r];++n){var a=n+1,i=e[r][n],s=I[i];s&&(a=s>n+1?n+1:s),I[i]=a}return I},IsLower:function(e){return(e=e.charCodeAt(0))>="a".charCodeAt(0)&&e<="z".charCodeAt(0)},IsHigher:function(e){return(e=e.charCodeAt(0))>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)},IsDigit:function(e){return(e=e.charCodeAt(0))>="0".charCodeAt(0)&&e<="9".charCodeAt(0)},IsLetter:function(e){return(e=e.charCodeAt(0))>="a".charCodeAt(0)&&e<="z".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)},IsSymbol:function(e){return" `!@$%^&*()_+-={}[]:\";',.<>/?\\|#".indexOf(e)>=0},IsAny:function(e,t){for(var r=0;r!=e.length;++r){if(t(e[r]))return!0}return!1},Mid:function(e,t,r){if(t<0||r<0)return"";var n,a=String(e).length;return n=t+r>a?a:t+r,String(e).substring(t,n)}},A={Base64ToString:function(e){var t=window.atob(e),r=Array.prototype.map.call(t,function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""),n="{}";try{n=decodeURIComponent(r)}catch(e){n=this.UTF8DecodeOld(t)}return n},ArrayBuffertoBase64:function(e){for(var t,r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(e),i=a.byteLength,s=i%3,o=i-s,u=0;u<o;u+=3)r+=n[(16515072&(t=a[u]<<16|a[u+1]<<8|a[u+2]))>>18]+n[(258048&t)>>12]+n[(4032&t)>>6]+n[63&t];return 1==s?r+=n[(252&(t=a[o]))>>2]+n[(3&t)<<4]+"==":2==s&&(r+=n[(64512&(t=a[o]<<8|a[o+1]))>>10]+n[(1008&t)>>4]+n[(15&t)<<2]+"="),r},UTF8DecodeOld:function(e){for(var t="",r=0,n=c1=c2=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),r+=3);return t}},P={StringToBytes:function(e,t,r){var n=new Blob([e]),a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){r(e.target.error)},a.readAsArrayBuffer(n)},BytesToString:function(e,t,r){var n=new Blob([e]),a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){r(e.target.error)},a.readAsText(n)}};function T(e,t){var r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n=[0,421212481,842424962,724390851,1684849924,2105013317,1448781702,1329698503,3369699848,3519200073,4210026634,3824474571,2897563404,3048111693,2659397006,2274893007,1254232657,1406739216,2029285587,1643069842,783210325,934667796,479770071,92505238,2182846553,2600511768,2955803355,2838940570,3866582365,4285295644,3561045983,3445231262,2508465314,2359236067,2813478432,3198777185,4058571174,3908292839,3286139684,3670389349,1566420650,1145479147,1869335592,1987116393,959540142,539646703,185010476,303839341,3745920755,3327985586,3983561841,4100678960,3140154359,2721170102,2300350837,2416418868,396344571,243568058,631889529,1018359608,1945336319,1793607870,1103436669,1490954812,4034481925,3915546180,3259968903,3679722694,2484439553,2366552896,2787371139,3208174018,950060301,565965900,177645455,328046286,1556873225,1171730760,1861902987,2011255754,3132841300,2745199637,2290958294,2442530455,3738671184,3352078609,3974232786,4126854035,1919080284,1803150877,1079293406,1498383519,370020952,253043481,607678682,1025720731,1711106983,2095471334,1472923941,1322268772,26324643,411738082,866634785,717028704,2904875439,3024081134,2668790573,2248782444,3376948395,3495106026,4219356713,3798300520,792689142,908347575,487136116,68299317,1263779058,1380486579,2036719216,1618931505,3890672638,4278043327,3587215740,3435896893,2206873338,2593195963,2981909624,2829542713,998479947,580430090,162921161,279890824,1609522511,1190423566,1842954189,1958874764,4082766403,3930137346,3245109441,3631694208,2536953671,2385372678,2768287173,3155920004,1900120602,1750776667,1131931800,1517083097,355290910,204897887,656092572,1040194781,3113746450,2692952403,2343461520,2461357009,3723805974,3304059991,4022511508,4141455061,2919742697,3072101800,2620513899,2234183466,3396041197,3547351212,4166851439,3779471918,1725839073,2143618976,1424512099,1307796770,45282277,464110244,813994343,698327078,3838160568,4259225593,3606301754,3488152955,2158586812,2578602749,2996767038,2877569151,740041904,889656817,506086962,120682355,1215357364,1366020341,2051441462,1667084919,3422213966,3538019855,4190942668,3772220557,2945847882,3062702859,2644537544,2226864521,52649286,439905287,823476164,672009861,1733269570,2119477507,1434057408,1281543041,2167981343,2552493150,3004082077,2853541596,3847487515,4233048410,3613549209,3464057816,1239502615,1358593622,2077699477,1657543892,764250643,882293586,532408465,111204816,1585378284,1197851309,1816695150,1968414767,974272232,587794345,136598634,289367339,2527558116,2411481253,2760973158,3179948583,4073438432,3956313505,3237863010,3655790371,347922877,229101820,646611775,1066513022,1892689081,1774917112,1122387515,1543337850,3697634229,3313392372,3998419255,4148705398,3087642289,2702352368,2319436851,2468674930],a=[0,29518391,59036782,38190681,118073564,114017003,76381362,89069189,236147128,265370511,228034006,206958561,152762724,148411219,178138378,190596925,472294256,501532999,530741022,509615401,456068012,451764635,413917122,426358261,305525448,334993663,296822438,275991697,356276756,352202787,381193850,393929805,944588512,965684439,1003065998,973863097,1061482044,1049003019,1019230802,1023561829,912136024,933002607,903529270,874031361,827834244,815125939,852716522,856752605,611050896,631869351,669987326,640506825,593644876,580921211,551983394,556069653,712553512,733666847,704405574,675154545,762387700,749958851,787859610,792175277,1889177024,1901651959,1931368878,1927033753,2006131996,1985040171,1947726194,1976933189,2122964088,2135668303,2098006038,2093965857,2038461604,2017599123,2047123658,2076625661,1824272048,1836991623,1866005214,1861914857,1807058540,1786244187,1748062722,1777547317,1655668488,1668093247,1630251878,1625932113,1705433044,1684323811,1713505210,1742760333,1222101792,1226154263,1263738702,1251046777,1339974652,1310460363,1281013650,1301863845,1187289752,1191637167,1161842422,1149379777,1103966788,1074747507,1112139306,1133218845,1425107024,1429406311,1467333694,1454888457,1408811148,1379576507,1350309090,1371438805,1524775400,1528845279,1499917702,1487177649,1575719220,1546255107,1584350554,1605185389,3778354048,3774312887,3803303918,3816007129,3862737756,3892238699,3854067506,3833203973,4012263992,4007927823,3970080342,3982554209,3895452388,3924658387,3953866378,3932773565,4245928176,4241609415,4271336606,4283762345,4196012076,4225268251,4187931714,4166823541,4076923208,4072833919,4035198246,4047918865,4094247316,4123732899,4153251322,4132437965,3648544096,3636082519,3673983246,3678331705,3732010428,3753090955,3723829714,3694611429,3614117080,3601426159,3572488374,3576541825,3496125444,3516976691,3555094634,3525581405,3311336976,3298595879,3336186494,3340255305,3260503756,3281337595,3251864226,3222399125,3410866088,3398419871,3368647622,3372945905,3427010420,3448139075,3485520666,3456284973,2444203584,2423127159,2452308526,2481530905,2527477404,2539934891,2502093554,2497740997,2679949304,2659102159,2620920726,2650438049,2562027300,2574714131,2603727690,2599670141,2374579504,2353749767,2383274334,2412743529,2323684844,2336421851,2298759554,2294686645,2207933576,2186809023,2149495014,2178734801,2224278612,2236720739,2266437690,2262135309,2850214048,2820717207,2858812622,2879680249,2934667388,2938704459,2909776914,2897069605,2817622296,2788420399,2759153014,2780249921,2700618180,2704950259,2742877610,2730399645,3049550800,3020298727,3057690558,3078802825,2999835404,3004150075,2974355298,2961925461,3151438440,3121956959,3092510214,3113327665,3168701108,3172786307,3210370778,3197646061],i=[0,3099354981,2852767883,313896942,2405603159,937357362,627793884,2648127673,3316918511,2097696650,1874714724,3607201537,1255587768,4067088605,3772741427,1482887254,1343838111,3903140090,4195393300,1118632049,3749429448,1741137837,1970407491,3452858150,2511175536,756094997,1067759611,2266550430,449832999,2725482306,2965774508,142231497,2687676222,412010587,171665333,2995192016,793786473,2548850444,2237264098,1038456711,1703315409,3711623348,3482275674,1999841343,3940814982,1381529571,1089329165,4166106984,4029413537,1217896388,1512189994,3802027855,2135519222,3354724499,3577784189,1845280792,899665998,2367928107,2677414085,657096608,3137160985,37822588,284462994,2823350519,2601801789,598228824,824021174,2309093331,343330666,2898962447,3195996129,113467524,1587572946,3860600759,4104763481,1276501820,3519211397,1769898208,2076913422,3279374443,3406630818,1941006535,1627703081,3652755532,1148164341,4241751952,3999682686,1457141531,247015245,3053797416,2763059142,470583459,2178658330,963106687,735213713,2473467892,992409347,2207944806,2435792776,697522413,3024379988,217581361,508405983,2800865210,4271038444,1177467017,1419450215,3962007554,1911572667,3377213406,3690561584,1665525589,1799331996,3548628985,3241568279,2039091058,3831314379,1558270126,1314193216,4142438437,2928380019,372764438,75645176,3158189981,568925988,2572515393,2346768303,861712586,3982079547,1441124702,1196457648,4293663189,1648042348,3666298377,3358779879,1888390786,686661332,2421291441,2196002399,978858298,2811169155,523464422,226935048,3040519789,3175145892,100435649,390670639,2952089162,841119475,2325614998,2553003640,546822429,2029308235,3225988654,3539796416,1782671013,4153826844,1328167289,1570739863,3844338162,1298864389,4124540512,3882013070,1608431339,3255406162,2058742071,1744848601,3501990332,2296328682,811816591,584513889,2590678532,129869501,3204563416,2914283062,352848211,494030490,2781751807,3078325777,264757620,2450577869,715964072,941166918,2158327331,3636881013,1618608400,1926213374,3396585883,1470427426,4011365959,4255988137,1158766284,1984818694,3471935843,3695453837,1693991400,4180638033,1100160564,1395044826,3952793279,3019491049,189112716,435162722,2706139399,1016811966,2217162459,2526189877,774831696,643086745,2666061564,2354934034,887166583,2838900430,294275499,54519365,3145957664,3823145334,1532818963,1240029693,4048895640,1820460577,3560857924,3331051178,2117577167,3598663992,1858283101,2088143283,3301633750,1495127663,3785470218,4078182116,1269332353,332098007,2876706482,3116540252,25085497,2628386432,605395429,916469259,2384220526,2254837415,1054503362,745528876,2496903497,151290352,2981684885,2735556987,464596510,1137851976,4218313005,3923506883,1365741990,3434129695,1946996346,1723425172,3724871409];function s(e,t){e=e.xor(t);var s=bigInt(i[e.and(255)]),o=bigInt(a[e.shiftRight(8).and(255)]),u=bigInt(n[e.shiftRight(16).and(255)]),l=bigInt(r[e.shiftRight(24)]);return e=s.xor(o.xor(u.xor(l)))}function o(e,t,r){for(var n=0;n<8;n++){e=s(e,RfapiJS.utils.GetLEIntegerFromByteArray(t,r,4)),r+=4}return e}for(var u=bigInt(4294967295),l=0;t>=32;)u=o(u,e,l),l+=32,t-=32;for(;t>=4;){u=s(u,RfapiJS.utils.GetLEIntegerFromByteArray(e,l,4)),l+=4,t-=4}if(t)do{var c=u.shiftRight(8),h=u.xor(e[l]).and(255);u=bigInt(r[h]).xor(c),l++}while(--t);return 4294967295-u.value}RfapiJS.utils=v,RfapiJS.CRC32=T,RfapiJS.UTF8=w,RfapiJS.Binary=R,RfapiJS.Base64=A,RfapiJS.RF_RSA=_,RfapiJS.SecurityScore=C,RfapiJS.StringConverter=P,RfapiJS.RfPasswordAudit=E,RfapiJS.CSecurityStats=x}).apply(RfapiJS);
//# sourceMappingURL=utils.js.map