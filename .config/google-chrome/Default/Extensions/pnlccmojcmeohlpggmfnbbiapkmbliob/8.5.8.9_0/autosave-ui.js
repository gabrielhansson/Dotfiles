// Copyright (C) 1999-2019 Siber Systems Inc. All Rights Reserved.
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{21:function(e,n,t){e.exports=t.p+"autosave-ui.html"},29:function(e,n,t){"use strict";t.r(n);t(21);var o=t(8),i=t(1),l=(t(5),t(6)),a=t(2),c=t(0);function r(e,n){const t=e,r=n;let s=!1,u=!1,f=!1,m="",v=!1,g=!1,p=!1,_=null,b={},h={},w={},k=null,L=null,S=null,C=null;return{Init:function(e,n){d("save-question-text").textContent=t.LocalizeString("SaveDlg_SaveLoginQuestion_Text"),d("select-name-title").textContent=t.LocalizeString("SaveDlg_Name_Text"),d("select-folder-title").textContent=t.LocalizeString("SaveDlg_Folder_Text"),d("create-folder-button").value=t.LocalizeString("SaveDlg_NewFolder_Text"),d("new-folder-cancel-button").setAttribute("title",t.LocalizeString("Cmd_Cancel_Flat")),d("post-save-message").textContent=t.LocalizeString("SaveDlg_FinalMessage_LoginSaved_Text2"),d("save-button").value=t.LocalizeString("Cmd_SaveForms_Flat"),d("cancel-button").value=t.LocalizeString("Cmd_Cancel_Flat"),d("close-button").value=t.LocalizeString("Cmd_Close_Flat"),d("block-confirmation-title").textContent=t.LocalizeString("CreateBlockingPass_Title"),d("block-confirmation-message").textContent=t.LocalizeString("CreateBlockingPass__WebExt_Confirm"),d("block-autosave-link").textContent=t.LocalizeString("SaveDlg_NeverForThisSite_Text"),d("unblock-autosave-button").value=t.LocalizeString("SaveDlg_Unblock_Key"),d("enable-autosave-button").value=t.LocalizeString("SaveDlg_Enable_Key"),d("never-again-block-label").textContent=t.LocalizeString("CheckedRunMB_CheckButton"),d("never-again-unblock-label").textContent=t.LocalizeString("CheckedRunMB_CheckButton"),d("block-confirmation-yes-button").value=t.LocalizeString("Install_Yes"),d("block-confirmation-no-button").value=t.LocalizeString("Install_No"),d("unblock-confirmation-title").textContent=t.LocalizeString("DeleteBlockingPass_Title"),d("file-name-container").addEventListener("mousedown",ee),d("file-name-arrow-button").addEventListener("mousedown",ne),d("file-name-edit").addEventListener("keypress",te),d("file-name-edit").addEventListener("blur",oe),d("file-name-edit").addEventListener("input",ie),d("show-folder-button").addEventListener("click",Y),d("folder-name-container").addEventListener("mousedown",le),d("folder-name-arrow-button").addEventListener("mousedown",ae),d("folder-name-edit").addEventListener("blur",ce),d("folder-tree").addEventListener("mousedown",re),d("create-folder-button").addEventListener("mousedown",de),d("new-folder-name-edit").addEventListener("keypress",se),d("new-folder-name-edit").addEventListener("input",ue),d("new-folder-ok-button").addEventListener("mousedown",fe),d("new-folder-cancel-button").addEventListener("mousedown",me),d("save-button").addEventListener("click",$),d("cancel-button").addEventListener("click",X),d("close-button").addEventListener("click",Z),d("block-autosave-link").addEventListener("click",ve),d("unblock-autosave-button").addEventListener("click",ge),d("enable-autosave-button").addEventListener("click",pe),d("block-confirmation-no-button").addEventListener("click",_e),d("block-confirmation-yes-button").addEventListener("click",be),d("unblock-confirmation-no-button").addEventListener("click",he),d("unblock-confirmation-yes-button").addEventListener("click",we),t.onNotificationFromBackgroundScript.Add(y),t.CallBackgroundScript({name:"AutoSaveDialogInit"},function(o){!function e(n,o,c){if(n.notLoggedIn)C=function(n,o){t.CallBackgroundScript({name:"AutoSaveDialogInit"},function(t){e(t,n,o)},function(e){I(e.description,"init-error"),x(!1),K(n,o)})},H("not-logged-in-error-view"),x(!1),K(o,c);else{const e=void 0!==n.suggestedNames?n.suggestedNames:[],v=void 0!==n.itemsToReplace?n.itemsToReplace:[],g=void 0!==n.folderTreePaths?n.folderTreePaths:[],p=void 0!==n.selectedItemToReplace?n.selectedItemToReplace:"";if(f=void 0!==n.forcedSave&&n.forcedSave,m=void 0!==n.domainUrl?n.domainUrl:"",function(e,n){O("suggestions_section",t.LocalizeString("SaveDlg_New_Login_Selector"));for(let n=0;n<e.length;n++){const t=e[n];h[t]=N(t,t,null,"suggestions_section")}if(n.length>0){O("replace_section",t.LocalizeString("SaveDlg_Existing_Passcards").replace(new RegExp("&","g"),""));for(let e=0;e<n.length;e++){const t=n[e];w[t]=N(t,Object(l.e)(t),"login24.png","replace_section")}}}(e,v),p)G(p);else{const n=e.length>0?e[0]:v.length>0?v[0]:"";n&&G(n)}!function(e){(S=function(){let e=null,n="",t={GetRootElement:function(){null===e&&l();return e.m_element},AddFolder:function(n){null===e&&l();if(!n)return;const t=n.split("/");let i="",c=e;for(let e=0;e<t.length;e++){const n=t[e];if(!n)continue;const l=i+"/"+n;n in c.m_children||(c.m_children[n]=o(l,n),1===Object(a.g)(c.m_children)&&(c.m_element.classList.remove("tree-node-leaf"),c.m_expanded?c.m_element.classList.add("tree-node-expand-open"):c.m_element.classList.add("tree-node-expand-closed")),null===c.m_children_container&&(c.m_children_container=document.createElement("ul"),c.m_children_container.classList.add("tree-node-container"),c.m_element.appendChild(c.m_children_container)),c.m_children_container.appendChild(c.m_children[n].m_element)),c=c.m_children[n],i=l}},SelectFolder:function(t){const o=i(t);if(!o)return;const l=i(n);l&&l.m_header_element.classList.remove("dropdown-name-selected");o.m_header_element.classList.add("dropdown-name-selected"),function(n){if(!n)return void c(!0,"");const t=n.split("/");let o="",i=e;for(let e=0;e<t.length;e++){const n=t[e];if(n){if(!(n in i.m_children))return;i=i.m_children[n],c(!0,o=o+"/"+n)}}}(t),n=t},GetSelectedFolder:function(){return n},GetSelectedFolderNode:function(){const t=i(n);if(!t)return e.m_element;return t.m_element},GetLastExistingSubpath:function(n){if(!n)return"";const t=n.split("/");let o="",i=e;for(let e=0;e<t.length;e++){const n=t[e];if(n){if(!(n in i.m_children))return o;i=i.m_children[n],o=o+"/"+n}}return n},onFolderExpanded:null,onFolderCollapsed:null,onFolderSelected:null};return t;function o(e,n){const o=document.createElement("div");o.classList.add("tree-node-expand"),o.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();const t=i(e);c(!t.m_expanded,e)},!1);const l=document.createElement("div");l.classList.add("tree-node-content"),l.textContent=n,l.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),t.onFolderSelected&&t.onFolderSelected(e)},!1);const a=document.createElement("div");a.classList.add("tree-node-header"),a.appendChild(o),a.appendChild(l);const r=document.createElement("li");return r.classList.add("tree-node","tree-node-leaf"),r.appendChild(a),{m_element:r,m_header_element:a,m_expanded:!1,m_children_container:null,m_children:{}}}function i(n){const t=n.split("/");let o=e;for(let e=0;e<t.length;e++){const n=t[e];if(n){if(!(n in o.m_children))return null;o=o.m_children[n]}}return o}function l(){e=o("","Home"),c(!0,"")}function c(e,n){const o=i(n);o&&(e?(o.m_element.classList.add("tree-node-expand-open"),o.m_element.classList.remove("tree-node-expand-closed"),o.m_expanded=!0,t.onFolderExpanded&&t.onFolderExpanded(n)):(o.m_element.classList.remove("tree-node-expand-open"),o.m_element.classList.add("tree-node-expand-closed"),o.m_expanded=!1,t.onFolderCollapsed&&t.onFolderCollapsed(n)))}}()).onFolderExpanded=function(){K(i.e,i.i)},S.onFolderCollapsed=function(){K(i.e,i.i)},S.onFolderSelected=function(e){U(!1),P(e),K(i.e,i.i)};for(let n=0;n<e.length;n++)S.AddFolder(e[n].path);d("folder-tree").appendChild(S.GetRootElement())}(g),r.Get({autosave_enabled:!0,autosave_disabled_on_urls:[],autosave_dialog_selected_folder:"",autosave_dialog_show_folders:!1},function(e){s=!e.autosave_enabled,u=e.autosave_disabled_on_urls.indexOf(m)>=0;const n=e.autosave_dialog_show_folders,t=e.autosave_dialog_selected_folder;P(t,i.e,i.i),E(n),A(),H("main-view"),K(o,c)},function(e){s=!1,u=!1,P(""),E(!1),A(),H("main-view"),K(o,c)})}}(o,function(){x(!1),Object(c.c)(e,n)},n)},function(e){I(e.description,"init-error"),x(!1),K(function(){Object(c.d)(e,n)},n)})}};function y(e){switch(e.name){case"UserLoggedIn":if(C){const e=C;C=null,e(function(){H("main-view"),K(i.e,i.i)},i.i)}else H("main-view"),K(i.e,i.i);return;case"UserLoggedOff":return H("not-logged-in-error-view"),void K(i.e,i.i);default:return}}function x(e){d("page-mask").style.display=e?"block":"none",d("progress-indicator").style.display=e?"block":"none"}function E(e){d("select-folder-section").style.display=e?"table-row":"none",d("show-folder-img").src=e?"autosave_show_folder_open.ico":"autosave_show_folder.ico",p=e}function F(e){d("create-folder-section").style.display=e?"table-row":"none"}function I(e,n){d("error-message").textContent=e,d("error-section").style.display="block",_=n,n&&(b[n]=e)}function D(){d("error-message").textContent="",d("error-section").style.display="none"}function B(e){if(e.length>0)for(let n=0;n<e.length;n++)e[n]in b&&delete b[e[n]];if(Object(a.h)(b))return void D();if(_ in b)return;const n=Object.keys(b)[0];I(b[n],n)}function z(e){d("warning-message").textContent=e,d("warning-section").style.display="block"}function N(e,n,t,o){const i=document.createElement("div");if(t){const e=document.createElement("img");e.className="dropdown-name-icon",e.src=t,i.appendChild(e)}return i.textContent+=n,i.addEventListener("mousedown",function(){G(e),d("file-name-edit").focus()},!0),i.className="dropdown-name",d(o).appendChild(i),i}function O(e,n){const t=document.createElement("div");t.id=e,t.className="dropdown-section";const o=document.createElement("div");o.className="dropdown-section-name",o.textContent=n,o.addEventListener("mousedown",function(e){d("file-name-edit").focus(),e.preventDefault(),e.stopPropagation()},!0),t.appendChild(o),d("file-name-dropdown").appendChild(t)}function T(){var e;k&&((e=k)in h?(d("suggestions_section").removeChild(h[e]),delete h[e]):e in w&&(d("replace_section").removeChild(w[e]),delete w[e]),k=null)}function G(e){let n=null;if(e in h)n=h[e];else{if(!(e in w))return;n=w[e]}const t=e;if(t.indexOf("/")>=0){const e=Object(l.g)(t),n=Object(l.i)(t);d("file-name-edit").value=Object(l.e)(e),P(n,i.e,i.i)}else d("file-name-edit").value=Object(l.e)(t);const o=d("file-name-select").getElementsByClassName("dropdown-name-selected");for(let e=0;e<o.length;e++)o[e].classList.remove("dropdown-name-selected");n.classList.add("dropdown-name-selected")}function R(){k&&G(k)}function j(e){d("file-name-arrow-image").className=e?"name-arrow-opened":"name-arrow-closed",d("file-name-container").className=e?"name-container-opened":"name-container-closed",d("file-name-dropdown").style.display=e?"block":"none",e&&d("file-name-edit").focus(),v=e}function P(e,n,o){L=null,S.SelectFolder(e),d("folder-name-edit").value=e?Object(l.e)(e):"Home",t.CallBackgroundScript({name:"AutoSaveGetFolderContent",path:e},function(e){L=e,V(n,o)},o)}function U(e){if(d("folder-name-arrow-image").className=e?"name-arrow-opened":"name-arrow-closed",d("folder-name-container").className=e?"name-container-opened":"name-container-closed",d("folder-name-dropdown").style.display=e?"block":"none",g=e,e){d("folder-name-edit").focus();const e=S.GetSelectedFolderNode(),n=d("folder-tree").getBoundingClientRect();d("folder-tree").scrollTop=e.offsetTop-n.height/2}}function A(){s?(d("enable-autosave-button").style.display="inline-block",d("block-autosave-link").style.display="none",d("unblock-autosave-button").style.display="none"):(d("enable-autosave-button").style.display="none",u?(d("unblock-autosave-button").style.display="inline-block",d("block-autosave-link").style.display="none"):(d("unblock-autosave-button").style.display="none",d("block-autosave-link").style.display=f?"none":"inline-block"))}function M(e,n){const i=d("file-name-edit").value,a=W(i);if(!a)return I("Login name '"+i+"' cannot be empty and it cannot contain characters \\ / : * ? \" < > |","invalid-filename-error"),void K(e,n);const c=S.GetSelectedFolder()+"/"+a+Object(l.f)(l.n);x(),t.CallBackgroundScript({name:"AutoSaveDialogSave",path:c,newItem:c in w},function(){D(),H("post-save-view"),x(!1),K(function(){r.Set({autosave_dialog_selected_folder:S.GetSelectedFolder()},e,n)},n)},function(t){t.code===o.c?(C=M,D(),H("not-logged-in-error-view")):I(t.description,"save-error"),K(e,n)})}function H(e){const n=d("dialog").getElementsByClassName("view");for(let t=0;t<n.length;t++){const o=n[t];o.id===e?(o.style.display="block",d("dialog").style.width=window.getComputedStyle(o).getPropertyValue("width")):o.style.display="none"}}function J(e,n,l){B(["create-folder-error","invalid-foldername-error"]);const a=S.GetLastExistingSubpath(e);if(F(!1),a===e)return P(e,i.e,i.i),void K(n,l);x(!0),K(function(){t.CallBackgroundScript({name:"AutoSaveDialogCreateFolder",path:e},function(){S.AddFolder(e),P(e),x(!1),K(n,l)},function(t){x(!1),t.code===o.c?(H("not-logged-in-error-view"),C=function(n,t){J(e,n,t)}):I(t.description,"create-folder-error"),K(n,l)})},l)}function K(e,n){if(v){const o=d("dialog").getBoundingClientRect(),i=d("file-name-dropdown").getBoundingClientRect(),l=Math.max(o.height,i.bottom);t.UpdateInpageUI({width:o.width,height:l},e,n)}else if(g){const o=d("dialog").getBoundingClientRect(),i=d("folder-name-dropdown").getBoundingClientRect(),l=Math.max(o.height,i.bottom);t.UpdateInpageUI({width:o.width,height:l},e,n)}else{const o=d("dialog").getBoundingClientRect();t.UpdateInpageUI({width:o.width,height:o.height},e,n)}}function W(e){if(e&&!e.startsWith(".")&&!/[\\\/:*?"<>|\r\n\t]/i.test(e))return e.replace(new RegExp("^\\s+","i"),"").replace(new RegExp("[.\\s]+$","i"),"")}function q(e,n){r.Get({autosave_disabled_on_urls:[]},function(o){const i={},l=o.autosave_disabled_on_urls;l.indexOf(m)<0&&(l.push(m),i.autosave_disabled_on_urls=l),d("never-again-block-checkbox").checked&&(i.autosave_dialog_show_block_confirmation=!1),r.Set(i,function(){t.CloseInpageUI(e,n)},function(t){I(t,"block-unblock-error"),K(e,n)})},function(t){I(t,"block-unblock-error"),K(e,n)})}function Q(e,n){r.Get({autosave_disabled_on_urls:[]},function(t){const o={},i=t.autosave_disabled_on_urls,l=i.indexOf(m);l>=0&&(i.splice(l,1),o.autosave_disabled_on_urls=i),d("never-again-unblock-checkbox").checked&&(o.autosave_dialog_show_unblock_confirmation=!1),r.Set(o,function(){u=!1,A(),H("main-view"),K(e,n)},function(t){I(t,"block-unblock-error"),K(e,n)})},function(t){I(t,"block-unblock-error"),K(e,n)})}function V(e,n){d("warning-message").textContent="",d("warning-section").style.display="none";const t=d("file-name-edit").value,o=W(t);if(!o)return T(),I("Login name '"+t+"' cannot be empty and it cannot contain characters \\ / : * ? \" < > |","invalid-filename-error"),void K(e,n);if(B(["invalid-filename-error","save-error"]),o in h)return T(),G(o),void K(e,n);const i=S.GetSelectedFolder()+"/"+o+Object(l.f)(l.n);if(i in w)return z("This Login info will replace an existing Login: '"+o+"'"),T(),G(i),void K(e,n);if(L){const t=i.toLowerCase();for(let i=0;i<L.length;i++){if(t===L[i].toLowerCase())return z("This Login info will replace an existing Login: '"+o+"'"),R(),void K(e,n)}}T(),function(e){e in h||(h[e]=N(e,e,null,"suggestions_section"),k=e)}(o),R(),K(e,n)}function Y(){F(!1),E(!p),K(i.e,i.i),r.Set({autosave_dialog_show_folders:p},i.e,i.i)}function $(){M(i.e,i.i)}function X(){t.CloseInpageUI(i.e,i.i)}function Z(){t.CloseInpageUI(i.e,i.i)}function ee(e){v||(e.preventDefault(),e.stopPropagation(),j(!0),K(i.e,i.i))}function ne(e){e.preventDefault(),e.stopPropagation(),j(!v),K(i.e,i.i)}function te(e){"Enter"===e.key&&(d("save-button").focus(),M(i.e,i.i))}function oe(){j(!1),K(i.e,i.i)}function ie(){V(i.e,i.i)}function le(e){e.preventDefault(),e.stopPropagation(),U(!g),K(i.e,i.i)}function ae(e){e.preventDefault(),e.stopPropagation(),U(!g),K(i.e,i.i)}function ce(){U(!1),K(i.e,i.i)}function re(e){e.preventDefault(),e.stopPropagation()}function de(){d("new-folder-name-edit").value="New Folder",F(!0),setTimeout(function(){d("new-folder-name-edit").focus()},100),K(i.e,i.i)}function se(e){if("Enter"===e.key){const e=W(d("new-folder-name-edit").value);if(!e)return I("Folder name '"+d("new-folder-name-edit").value+"' cannot be empty and it cannot contain characters \\ / : * ? \" < > |","invalid-foldername-error"),void K(i.e,i.i);J(S.GetSelectedFolder()+"/"+e,function(){F(!1),K(i.e,i.i)},i.i)}}function ue(){const e=d("new-folder-name-edit").value;if(!W(e))return I("Folder name '"+e+"' cannot be empty and it cannot contain characters \\ / : * ? \" < > |","invalid-foldername-error"),void K(i.e,i.i);B(["invalid-foldername-error","save-error"]),K(i.e,i.i)}function fe(){const e=W(d("new-folder-name-edit").value);if(!e)return I("Folder name '"+d("new-folder-name-edit").value+"' cannot be empty and it cannot contain characters \\ / : * ? \" < > |","invalid-foldername-error"),void K(i.e,i.i);J(S.GetSelectedFolder()+"/"+e,function(){F(!1),K(i.e,i.i)},i.i)}function me(){B(["create-folder-error","invalid-foldername-error"]),F(!1),K(i.e,i.i)}function ve(){r.Get({autosave_dialog_show_block_confirmation:!0},function(e){e.autosave_dialog_show_block_confirmation?(H("block-confirmation-view"),K(i.e,i.i)):q(i.e,i.i)},function(e){H("block-confirmation-view"),K(i.e,i.i)})}function ge(){r.Get({autosave_dialog_show_unblock_confirmation:!0},function(e){e.autosave_dialog_show_unblock_confirmation?(H("unblock-confirmation-view"),K(i.e,i.i)):Q(i.e,i.i)},function(e){H("unblock-confirmation-view"),K(i.e,i.i)})}function pe(){r.Set({autosave_enabled:!0},function(){s=!1,A(),K(i.e,i.i)},function(e){e.code===o.c?(C=pe,H("not-logged-in-error-view"),K(i.e,i.i)):(I(e.description,"block-unblock-error"),K(i.e,i.i))})}function _e(){H("main-view"),K(i.e,i.i)}function be(){q(i.e,i.i)}function he(){H("main-view"),K(i.e,i.i)}function we(){Q(i.e,i.i)}}function d(e){return document.getElementById(e)}var s=t(15),u=t(11);const f=Object(s.a)();f.Init(function(){const e=Object(u.a)();r(f,e).Init(i.e,i.i)},i.i)}},[[29,0,1]]]);
//# sourceMappingURL=autosave-ui.js.map